/*!
 * A web media player that implements W3C MSE and MediaElement v4.1.7 (1)
 *
 * Copyright 2020 - 2021 Bilibili, Inc.
 * Released in Wed Nov 03 2021 11:58:11 GMT+0800 (GMT+08:00)
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WasmPlayer=t():e.WasmPlayer=t()}(self,(function(){return function(){var e={757:function(e,t,r){e.exports=r(666)},999:function(e,t,r){"use strict";r.d(t,{default:function(){return gn}});var n,i,a,o,s,u,c,l=!1,f="4.1.7",h="https://pre-s1.hdslb.com/bfs/static/bwphevc/libwpengn-4.1.7.wasm";function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function v(e,t,r){return(v=m()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_(i,r.prototype),i}).apply(null,arguments)}function b(e){var t="function"==typeof Map?new Map:void 0;return(b=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return v(e,arguments,p(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_(n,e)})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function k(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?E(e):t}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function R(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}!function(e){e.CLOSED="closed",e.OPEN="open",e.ENDED="ended"}(n||(n={})),function(e){e.NETWORK="network",e.DECODE="decode"}(i||(i={})),function(e){e[e.NETWORK_EMPTY=0]="NETWORK_EMPTY",e[e.NETWORK_IDLE=1]="NETWORK_IDLE",e[e.NETWORK_LOADING=2]="NETWORK_LOADING",e[e.NETWORK_NO_SOURCE=3]="NETWORK_NO_SOURCE"}(a||(a={})),function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(o||(o={})),function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(s||(s={})),function(e){e.SEGMENTS="segments",e.SEQUENCE="sequence"}(u||(u={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.MIX="mix"}(c||(c={}));var x=window.EventTarget||function e(){y(this,e)};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var D=function(e){A(r,e);var t=P(r);function r(){var e;return y(this,r),T(E(e=t.call(this)),"onaddsourcebuffer",void 0),T(E(e),"onremovesourcebuffer",void 0),T(E(e),"sourceBuffers",void 0),e.sourceBuffers=[],k(e,new Proxy(E(e),{get:function(e,t,r){return Number.isNaN(Number(t))?"function"==typeof e[t]?e[t].bind(e):Reflect.get(e,t,r):e.sourceBuffers[t]}}))}return w(r,[{key:"insert",value:function(e,t){this.sourceBuffers.splice(t,0,e)}},{key:"remove",value:function(e){this.sourceBuffers.splice(e,1)}},{key:"push",value:function(e){this.sourceBuffers.push(e)}},{key:"pop",value:function(){return this.sourceBuffers.pop()}},{key:"indexOf",value:function(e){return this.sourceBuffers.indexOf(e)}},{key:"length",get:function(){return this.sourceBuffers.length}}]),r}(x),F=r(757),M=r.n(F);function O(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function I(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){O(a,n,i,o,s,"next",e)}function s(e){O(a,n,i,o,s,"throw",e)}o(void 0)}))}}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var C=function(e){A(r,e);var t=N(r);function r(e,n){var i;return y(this,r),(i=t.call(this,e)).name=n,i.message=e,i.stack=(new Error).stack,i}return r}(b(Error)),U=function(e){A(r,e);var t=N(r);function r(){return y(this,r),t.call(this,"The operation is not supported.","NotSupportedError")}return r}(C),L=function(e){A(r,e);var t=N(r);function r(){return y(this,r),t.call(this,"The object is in an invalid state.","InvalidStateError")}return r}(C),B=function(e){A(r,e);var t=N(r);function r(){return y(this,r),t.call(this,"The index is not in the allowed range.","IndexSizeError")}return r}(C),W=new WeakMap,G=new WeakMap,V=new WeakMap,H=function(){function e(){var t=this;y(this,e),W.set(this,{writable:!0,value:void 0}),G.set(this,{writable:!0,value:function(e,r){var n=S(t,W)[e],i=S(t,W)[r];return n.start<=i.start&&i.start<=n.end&&n.end<=i.end?(n.end=i.end,S(t,W).splice(r,1),!0):i.start<=n.start&&n.start<=i.end&&i.end<=n.end?(n.start=i.start,S(t,W).splice(r,1),!0):i.start<=n.start&&n.start<=i.end&&n.end<=i.end?(S(t,W).splice(e,1),!0):n.start<=i.start&&i.start<=n.end&&i.end<=n.end&&(S(t,W).splice(r,1),!0)}}),V.set(this,{writable:!0,value:function(e){if(!(null!==e&&!Number.isNaN(e)&&e%1==0))throw new Error("index argument is not an integer");if(e>=S(t,W).length||e<0)throw new B}}),R(this,W,[])}return w(e,[{key:"get",value:function(e){return S(this,V).call(this,e),S(this,W)[e]}},{key:"start",value:function(e){return S(this,V).call(this,e),S(this,W)[e].start}},{key:"end",value:function(e){return S(this,V).call(this,e),S(this,W)[e].end}},{key:"add",value:function(e,t){var r=0;for(r=0;r<S(this,W).length&&!(e>S(this,W)[r].start);r++);for(S(this,W).splice(r,0,{start:e,end:t}),r=0;r<S(this,W).length-1;r++)S(this,G).call(this,r,r+1)&&r--}},{key:"remove",value:function(e,t){for(var r=0;r<S(this,W).length;r++)if(e<=S(this,W)[r].start&&t>=S(this,W)[r].end)S(this,W).splice(r,1),r--;else{if(e>S(this,W)[r].start&&t<S(this,W)[r].end){S(this,W).splice(r+1,0,{start:t,end:S(this,W)[r].end}),S(this,W)[r].end=e;break}e>S(this,W)[r].start&&e<S(this,W)[r].end?S(this,W)[r].end=e:t>S(this,W)[r].start&&t<S(this,W)[r].end&&(S(this,W)[r].start=t)}}},{key:"addRange",value:function(e){return S(this,W).push(e)}},{key:"clear",value:function(){S(this,W).length=0}},{key:"container",value:function(e){for(var t=0;t<S(this,W).length;t++){var r=S(this,W)[t];if(e>=r.start&&e<=r.end)return!0}return!1}},{key:"length",get:function(){return S(this,W).length}}]),e}();function Y(e,t){return e.start<=t.start&&t.start<=e.end&&e.end<=t.end?{start:t.start,end:e.end}:t.start<=e.start&&e.start<=t.end&&t.end<=e.end?{start:e.start,end:t.end}:t.start<=e.start&&e.start<=t.end&&e.end<=t.end?{start:e.start,end:e.end}:e.start<=t.start&&t.start<=e.end&&t.end<=e.end?{start:t.start,end:t.end}:null}function j(e,t){for(var r=new H,n=0;n<e.length;n++)for(var i=e.get(n),a=0;a<t.length;a++){var o=t.get(a);if(o.start>=i.start&&o.start<i.end||o.start<=i.start&&o.end>i.start){var s=Y(i,o);s&&r.addRange(s)}if(o.start>i.end)break}return r}var z=function e(){y(this,e)};T(z,"MIN_DECODE_BUFFER_TIME",4),T(z,"MAX_DECODE_BUFFER_TIME",8);var K=z;function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var X=function(e){A(r,e);var t=J(r);function r(){return y(this,r),t.apply(this,arguments)}return r}(function(e){A(r,e);var t=q(r);function r(){var e;return y(this,r),T(E(e=t.call(this)),"tracks",void 0),e.tracks=[],k(e,new Proxy(E(e),{get:function(e,t,r){return Number.isNaN(Number(t))?"function"==typeof e[t]?e[t].bind(e):Reflect.get(e,t,r):e.tracks[t]}}))}return w(r,[{key:"getTrackById",value:function(e){for(var t=0;t<this.tracks.length;t++)if(this.tracks[t].id===e)return this.tracks[t];return null}},{key:"length",get:function(){return this.tracks.length}}]),r}(x));function Q(e,t){Promise.resolve().then((function(){e.dispatchEvent(new Event(t))}))}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee=function(){var e={};return"undefined"!=typeof window&&(e=window),"undefined"!=typeof self&&(e=self),e};var te,re,ne="1"===(null===(te=ee().localStorage)||void 0===te?void 0:te.getItem("_bwphevc_debug_"))||l;!function(e){e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(re||(re={}));var ie=function(){function e(){y(this,e)}return w(e,[{key:"proxyLog",value:function(t,r){var n;ne&&(n=console)[t].apply(n,["[".concat(+new Date-e.startTime,"]")].concat($(r)))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(re.INFO,t)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(re.TRACE,t)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(re.DEBUG,t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(re.WARN,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(re.ERROR,t)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e,e.startTime=+new Date),e.instance}}]),e}();T(ie,"instance",void 0),T(ie,"startTime",void 0);var ae=ie;function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var se=function(e){A(r,e);var t=oe(r);function r(){var e;return y(this,r),T(E(e=t.call(this)),"trackId",void 0),T(E(e),"ldt",void 0),T(E(e),"lfd",void 0),T(E(e),"het",void 0),T(E(e),"nrapFlag",void 0),T(E(e),"trackRanges",void 0),T(E(e),"_appendMode",void 0),T(E(e),"TAG","[BwpTrackBuffer]"),T(E(e),"logger",void 0),T(E(e),"initSegmentBuffer",void 0),T(E(e),"mediaSegmentBuffer",void 0),T(E(e),"mediaSegmentBufferCount",void 0),e.nrapFlag=!0,e.trackRanges=new H,e.initSegmentBuffer=[],e.mediaSegmentBuffer={},e.mediaSegmentBufferCount=0,e._appendMode=u.SEGMENTS,e.logger=ae.getInstance(),e}return w(r,[{key:"appendInitSegment",value:function(e){for(var t=this.initSegmentBuffer,r=0;r<t.length;r++){var n=t[r];if((1===n.volume&&0===n.width&&0===n.height||0===n.volume&&n.width===e.width&&n.height===e.height)&&n.buffer.byteLength===e.buffer.byteLength)return this.logger.warn(this.TAG,"append init segment is exists, it is index is:",r),r}return this.initSegmentBuffer.push(e)-1}},{key:"appendMediaSegment",value:function(e){var t=this.mediaSegmentBuffer,r=e.sequenceNumber;if(this._appendMode===u.SEQUENCE)r=this.mediaSegmentBufferCount;else{var n=t[r];n&&(this.remove(n.fpts,n.lpts),this.logger.warn(this.TAG,"append media segment is exists, remove old segment"))}t[r]=e;var i=t[r-1],a=t[r+1],o=e.fpts,s=e.lpts;return i&&(o=i.lpts),a&&(s=a.fpts),this.trackRanges.add(o,s),this.mediaSegmentBufferCount+=1,r}},{key:"remove",value:function(e,t){for(var r=0,n=e,i=t,a=this.mediaSegmentBuffer,o=Object.keys(a),s=0;s<o.length;s++){var u=parseInt(o[s],10),c=a[u],l=c.fpts,f=c.lpts;if(e>=l&&e<f){var h=a[u-1];n=h?h.lpts:l}if(t>l&&t<=f){var d=a[u+1];i=d?d.fpts:f}f<e||l>t||(delete a[u],r+=1)}return this.trackRanges.remove(n,i),this.mediaSegmentBufferCount=Object.keys(a).length,r>0}},{key:"getInitSegment",value:function(e){return this.initSegmentBuffer[e]}},{key:"getMediaSegment",value:function(e){return this.mediaSegmentBuffer[e]}},{key:"getMediaSegmentTimeRange",value:function(e){var t=this.mediaSegmentBuffer[e];return t?{start:t.fpts,end:t.lpts}:{start:NaN,end:NaN}}},{key:"isLastSegment",value:function(e){var t=Object.keys(this.mediaSegmentBuffer);return parseInt(t.pop()||"-1",10)===e}},{key:"getCurrentSegmentIndex",value:function(e){for(var t=Object.keys(this.mediaSegmentBuffer),r=0;r<t.length;r++){var n=this.mediaSegmentBuffer[t[r]];if(e>=n.fpts&&e<=n.lpts)return parseInt(t[r],10);if(e>n.lpts){var i=this.mediaSegmentBuffer[t[r+1]];if(i&&e<i.fpts)return parseInt(t[r],10)}}return-1}},{key:"clear",value:function(){this.initSegmentBuffer=[],this.mediaSegmentBuffer={},this.mediaSegmentBufferCount=0}},{key:"appendMode",get:function(){return this.appendMode},set:function(e){this._appendMode=e}}]),r}(x),ue=function e(){y(this,e)};T(ue,"LOAD_START","loadstart"),T(ue,"PROGRESS","progress"),T(ue,"SUSPEND","suspend"),T(ue,"ABORT","abort"),T(ue,"ERROR","error"),T(ue,"EMPTIED","emptied"),T(ue,"STALLED","stalled"),T(ue,"LOADED_METADATA","loadedmetadata"),T(ue,"LOADED_DATA","loadeddata"),T(ue,"CANPLAY","canplay"),T(ue,"CANPLAY_THROUGH","canplaythrough"),T(ue,"PLAYING","playing"),T(ue,"WAITING","waiting"),T(ue,"SEEKING","seeking"),T(ue,"SEEKED","seeked"),T(ue,"ENDED","ended"),T(ue,"DURATION_CHANGE","durationchange"),T(ue,"TIME_UPDATE","timeupdate"),T(ue,"PLAY","play"),T(ue,"PAUSE","pause"),T(ue,"RATE_CHANGE","ratechange"),T(ue,"RESIZE","resize"),T(ue,"VOLUME_CHANGE","volumechange"),T(ue,"CHANGE","change"),T(ue,"ADD_TRACK","addtrack"),T(ue,"REMOVE_TRACK","removetrack"),T(ue,"CUE_CHANGE","cuechange"),T(ue,"ENTER_PICTURE_IN_PICTURE","enterpictureinpicture"),T(ue,"LEAVE_PICTURE_IN_PICTURE","leavepictureinpicture"),T(ue,"PERFORMANCE","performance");var ce=ue,le=r(715),fe=function(){function e(t){if(y(this,e),T(this,"offset",void 0),T(this,"type",void 0),T(this,"size",void 0),T(this,"boxes",void 0),T(this,"isComplete",void 0),T(this,"timescale",void 0),T(this,"earliest_presentation_time",void 0),T(this,"first_offset",void 0),T(this,"references",void 0),T(this,"id",void 0),T(this,"version",void 0),T(this,"value",void 0),T(this,"scheme_id_uri",void 0),T(this,"presentation_time_delta",void 0),T(this,"event_duration",void 0),T(this,"message_data",void 0),T(this,"sequence_number",void 0),T(this,"entry_count",void 0),T(this,"entries",void 0),T(this,"base_data_offset",void 0),T(this,"sample_description_index",void 0),T(this,"default_sample_duration",void 0),T(this,"default_sample_size",void 0),T(this,"default_sample_flags",void 0),T(this,"flags",void 0),T(this,"baseMediaDecodeTime",void 0),T(this,"sample_count",void 0),T(this,"first_sample_flags",void 0),T(this,"data_offset",void 0),T(this,"samples",void 0),T(this,"fragment_duration",void 0),T(this,"track_id",void 0),T(this,"width",void 0),T(this,"height",void 0),T(this,"volume",void 0),T(this,"samplerate",void 0),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var r=0;r<t.boxes.length;r++)this.boxes.push(new e(t.boxes[r]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var n=0;n<t.references.length;n++){var i={reference_type:t.references[n].reference_type,referenced_size:t.references[n].referenced_size,subsegment_duration:t.references[n].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.track_id=t.track_ID,this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"trex":this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}break;case"mehd":this.fragment_duration=t.fragment_duration;break;case"tkhd":this.track_id=t.track_ID,this.flags=t.flags,this.width=t.width,this.height=t.height,this.volume=t.volume;break;case"stsd":if(t.entries){var u=t.entries[0];"mp4a"===u.type&&(this.samplerate=u.samplerate)}}}return w(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t];return null}},{key:"getChildBoxes",value:function(e){for(var t=[],r=0;r<this.boxes.length;r++)this.boxes[r].type===e&&t.push(this.boxes[r]);return t}}]),e}(),he=function(){function e(){y(this,e),T(this,"parsedIsoFile",void 0)}return w(e,[{key:"getBox",value:function(e){return e&&this.parsedIsoFile&&this.parsedIsoFile.boxes&&0!==this.parsedIsoFile.boxes.length&&"function"==typeof this.parsedIsoFile.fetch?this.convertToDashIsoBox(this.parsedIsoFile.fetch(e)):null}},{key:"getBoxes",value:function(e){var t=[];if(!e||!this.parsedIsoFile||"function"!=typeof this.parsedIsoFile.fetchAll)return t;for(var r,n=this.parsedIsoFile.fetchAll(e),i=0,a=n.length;i<a;i++)(r=this.convertToDashIsoBox(n[i]))&&t.push(r);return t}},{key:"setData",value:function(e){this.parsedIsoFile=e}},{key:"getData",value:function(){return this.parsedIsoFile}},{key:"getLastBox",value:function(){if(!this.parsedIsoFile||!this.parsedIsoFile.boxes||!this.parsedIsoFile.boxes.length)return null;var e=this.parsedIsoFile.boxes[this.parsedIsoFile.boxes.length-1].type,t=this.getBoxes(e);return t.length>0?t[t.length-1]:null}},{key:"convertToDashIsoBox",value:function(e){if(!e)return null;var t=new fe(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}}]),e}(),de=function e(t,r,n){y(this,e),T(this,"lastCompletedOffset",void 0),T(this,"found",void 0),T(this,"size",void 0),this.lastCompletedOffset=t,this.found=r,this.size=n},pe=function(){function e(){y(this,e)}return w(e,[{key:"parse",value:function(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=le.yY(e),r=new he;return r.setData(t),r}},{key:"findLastTopIsoBoxCompleted",value:function(e,t,r){if(void 0===r&&(r=0),!t||r+8>=t.byteLength)return new de(0,!1);for(var n,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;r<i.byteLength;){var o=this.parseUint32(i,r),s=this.parseIsoBoxType(i,r+4);if(0===o)break;r+o<=i.byteLength&&(e.indexOf(s)>=0?n=new de(r,!0,o):a=r+o),r+=o}return n||new de(a,!1)}},{key:"getFirstBoxType",value:function(e){return e&&e.boxes&&e.boxes.length?e.boxes[0].type:null}},{key:"getSamplesInfo",value:function(e,t,r,n){var i;if(t)i=t;else if(i=this.parse(e),!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};if(!i)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var a,o,s,u,c,l,f=i.getBoxes("moof"),h=i.getBoxes("mfhd"),d=[],p=NaN,_=i.getBoxes("moof").length,m=h[h.length-1].sequence_number;o=0;for(var v=-1,b=-1,y=0;y<f.length;y++)for(var g=f[y],w=g.getChildBoxes("traf"),E=0;E<w.length;E++){var A=[],k=w[E],T=k.getChildBox("tfhd"),S=k.getChildBox("tfdt");u=S.baseMediaDecodeTime;for(var R=k.getChildBoxes("trun"),x=k.getChildBoxes("subs"),P=0;P<R.length;P++){var D=R[P];o=D.sample_count,l=(T.base_data_offset||0)+(D.data_offset||0);for(var F=0;F<o;F++){a=void 0!==(c=D.samples[F]).sample_duration?c.sample_duration:T.default_sample_duration||r,s=void 0!==c.sample_size?c.sample_size:T.default_sample_size||n;var M={dts:u,pts:u+(void 0!==c.sample_composition_time_offset?c.sample_composition_time_offset:0),duration:a,offset:g.offset+l,size:s,subSizes:[s]};if(x)for(var O=0;O<x.length;O++){var I=x[O];if(v<I.entry_count-1&&F>b&&(v++,b+=I.entries[v].sample_delta),F==b){M.subSizes=[];for(var N=I.entries[v],C=0;C<N.subsample_count;C++)M.subSizes.push(N.subsamples[C].subsample_size)}}A.push(M),l+=s,u+=a}}p=u-S.baseMediaDecodeTime,A.length>0&&(d[E]?d[E]=d[E].concat(A):d[E]=A)}return{sampleList:d,lastSequenceNumber:m,totalDuration:p,numSequences:_}}},{key:"getMediaTimescaleFromMoov",value:function(e){var t=this.parse(e),r=t?t.getBox("mdhd"):void 0;return r?r.timescale:NaN}},{key:"parseUint32",value:function(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}},{key:"parseIsoBoxType",value:function(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}},{key:"findInitRange",value:function(e){var t,r,n=null,i=this.parse(e);if(!i)return n;var a=i.getBox("ftyp"),o=i.getBox("moov");return o&&o.isComplete&&(t=a?a.offset:o.offset,r=o.offset+o.size-1,n="".concat(t,"-").concat(r)),n}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();T(pe,"instance",void 0);var _e=pe;function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var ve=new WeakMap,be=new WeakMap,ye=new WeakMap,ge=new WeakMap,we=new WeakMap,Ee=new WeakMap,Ae=new WeakMap,ke=new WeakMap,Te=new WeakMap,Se=new WeakMap,Re=new WeakMap,xe=new WeakMap,Pe=new WeakMap,De=new WeakMap,Fe=new WeakMap,Me=new WeakMap,Oe=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,Ce=new WeakMap,Ue=new WeakMap,Le=new WeakMap,Be=new WeakMap,We=new WeakMap,Ge=new WeakMap,Ve=new WeakMap,He=new WeakMap,Ye=new WeakMap,je=new WeakMap,ze=new WeakMap,Ke=new WeakMap,qe=new WeakMap,Je=new WeakMap,Xe=new WeakMap,Qe=new WeakMap,Ze=new WeakMap,$e=new WeakMap,et=new WeakMap,tt=new WeakMap,rt=new WeakMap,nt=function(e){A(r,e);var t=me(r);function r(e,n,i,a){var s,u,l;return y(this,r),s=t.call(this),ve.set(E(s),{writable:!0,value:void 0}),be.set(E(s),{writable:!0,value:"[BwpSourceBuffer]"}),ye.set(E(s),{writable:!0,value:void 0}),T(E(s),"updating",void 0),ge.set(E(s),{writable:!0,value:void 0}),we.set(E(s),{writable:!0,value:void 0}),T(E(s),"textTracks",void 0),Ee.set(E(s),{writable:!0,value:void 0}),Ae.set(E(s),{writable:!0,value:void 0}),T(E(s),"onupdatestart",void 0),T(E(s),"onupdate",void 0),T(E(s),"onupdateend",void 0),T(E(s),"onerror",void 0),T(E(s),"onabort",void 0),ke.set(E(s),{writable:!0,value:void 0}),Te.set(E(s),{writable:!0,value:void 0}),Se.set(E(s),{writable:!0,value:void 0}),Re.set(E(s),{writable:!0,value:void 0}),xe.set(E(s),{writable:!0,value:void 0}),T(E(s),"generateTimestampsFlag",void 0),Pe.set(E(s),{writable:!0,value:void 0}),T(E(s),"mediaType",void 0),De.set(E(s),{writable:!0,value:void 0}),Fe.set(E(s),{writable:!0,value:void 0}),Me.set(E(s),{writable:!0,value:void 0}),Oe.set(E(s),{writable:!0,value:void 0}),Ie.set(E(s),{writable:!0,value:void 0}),Ne.set(E(s),{writable:!0,value:void 0}),Ce.set(E(s),{writable:!0,value:void 0}),Ue.set(E(s),{writable:!0,value:void 0}),Le.set(E(s),{writable:!0,value:void 0}),Be.set(E(s),{writable:!0,value:void 0}),We.set(E(s),{writable:!0,value:void 0}),Ge.set(E(s),{writable:!0,value:.1}),Ve.set(E(s),{writable:!0,value:function(){if(S(E(s),rt).call(E(s)),null!==S(E(s),Fe).error)throw new L;if(S(E(s),Me).call(E(s)),S(E(s),Re))throw new Error("QuotaExceededError")}}),He.set(E(s),{writable:!0,value:(u=I(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,S(E(s),Ye).call(E(s)),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 8:R(E(s),Ie,null),s.updating=!1,Q(E(s),"update"),Q(E(s),"updateend");case 12:case"end":return e.stop()}}),e,null,[[0,4]])}))),function(){return u.apply(this,arguments)})}),Ye.set(E(s),{writable:!0,value:function(){if(null!==S(E(s),ke)){if("WAITING_FOR_SEGMENT"===S(E(s),xe)){var e;S(E(s),je).call(E(s),S(E(s),ke));var t=S(E(s),Oe).getFirstBoxType(null===(e=S(E(s),Ie))||void 0===e?void 0:e.getData());"ftyp"===t&&R(E(s),xe,"PARSING_INIT_SEGMENT"),"moof"===t&&R(E(s),xe,"PARSING_MEDIA_SEGMENT"),S(E(s),Ye).call(E(s))}if("PARSING_INIT_SEGMENT"===S(E(s),xe)&&(S(E(s),ze).call(E(s)),R(E(s),ke,null),R(E(s),Ie,null),R(E(s),xe,"WAITING_FOR_SEGMENT"),S(E(s),Ye).call(E(s))),"PARSING_MEDIA_SEGMENT"===S(E(s),xe)){if(!S(E(s),Pe))return console.error("[BwpSourceBuffer] InitalizationSegment must append before MediaSegment!"),void S(E(s),Je).call(E(s));S(E(s),Ke).call(E(s)),R(E(s),ke,null),R(E(s),Ie,null),R(E(s),xe,"WAITING_FOR_SEGMENT"),S(E(s),Ye).call(E(s))}}}}),je.set(E(s),{writable:!0,value:function(e){try{R(E(s),Ie,S(E(s),Oe).parse(e))}catch(e){console.error(e)}}}),ze.set(E(s),{writable:!0,value:function(){var e,t,r,n;if(!S(E(s),ke))throw new Error("Cannot get input buffer!");var i=null===(e=S(E(s),Ie))||void 0===e?void 0:e.getBox("mehd");Number.isNaN(S(E(s),De).duration)&&(i&&i.fragment_duration?S(E(s),qe).call(E(s),i.fragment_duration/1e3):S(E(s),qe).call(E(s),Number.POSITIVE_INFINITY));var a=null===(t=S(E(s),Ie))||void 0===t?void 0:t.getBox("trak"),u=a.getChildBox("tkhd");if(S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] appendBuffer initSegment, track_id: ").concat(u.track_id)),!a)return S(E(s),Je).call(E(s)),void console.error("[BwpSourceBuffer] append error cannot get trak!");if(s.mediaType===c.AUDIO||s.mediaType===c.MIX){var l,f=null===(l=S(E(s),Ie))||void 0===l?void 0:l.getBoxes("stsd");if(!f)throw new Error("Cannot get audio sample rate!");var h=s.mediaType===c.MIX&&f.length>1?1:0;R(E(s),Ce,f[h].samplerate),S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] get audio sample rate ").concat(S(E(s),Ce)))}if(S(E(s),Pe)){S(E(s),ve).warn(S(E(s),be),"[".concat(s.mediaType,"] firstinit is true, received new init segment."));var d=S(E(s),et).call(E(s),u.track_id);if(!d)throw new Error("Firstinit is true, but cantnot get already push init segment!");S(E(s),Be)[u.track_id]=d.appendInitSegment({buffer:S(E(s),ke),width:u.width,height:u.height,volume:u.volume})}var p=!1;if(!S(E(s),Pe)){p=!0;var _=new se;_.trackId=u.track_id,S(E(s),Be)[u.track_id]=_.appendInitSegment({buffer:S(E(s),ke),width:u.width,height:u.height,volume:u.volume}),S(E(s),Se).push(_),p&&(S(E(s),De).activeSourceBuffers.push(E(s)),S(E(s),De).activeSourceBuffers.dispatchEvent(new Event("addsourcebuffer"))),R(E(s),Pe,!0)}if(S(E(s),Fe).readyState===o.HAVE_NOTHING){S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] init segment loop: BwpElement is HAVE_NOTHING"));for(var m=!0,v=S(E(s),De).sourceBuffers,b=0;b<v.length;b++)v[b].firstinit||(m=!1,S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] init segment loop: another is not init")));m&&(S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] init segment loop: have meta")),S(E(s),Fe).readyState=o.HAVE_METADATA)}var y=null===(r=S(E(s),Ie))||void 0===r?void 0:r.getBox("mdhd");R(E(s),Ne,y.timescale);var g=null===(n=S(E(s),Ie))||void 0===n?void 0:n.getBox("trex");R(E(s),Ue,g.default_sample_duration),R(E(s),Le,g.default_sample_size),p&&S(E(s),Fe).readyState>=o.HAVE_CURRENT_DATA&&(S(E(s),Fe).readyState=o.HAVE_METADATA)}}),Ke.set(E(s),{writable:!0,value:function(){var e,t;if(!S(E(s),ke))throw new Error("Cannot get input buffer!");var r=S(E(s),Oe).getSamplesInfo(S(E(s),ke),S(E(s),Ie),S(E(s),Ue),S(E(s),Le)).sampleList[0];if(!r||0===r.length)throw new Error("[BwpSourceBuffer] parsed sample list is empty!");if(!S(E(s),Ne))throw new Error("[BwpSourceBuffer] timescale is undefined!");var n=(null===(e=S(E(s),Ie))||void 0===e?void 0:e.getBox("tfhd")).track_id,i=S(E(s),et).call(E(s),n);if(!i)throw new Error("[BwpSourceBuffer] cannot get trackBuffer!");var a=r[r.length-1],u=r[0].dts/S(E(s),Ne),c=r[0].pts/S(E(s),Ne),l=a.pts/S(E(s),Ne);0===u&&(c=0),l>S(E(s),Ae)&&(l=S(E(s),Ae));var f=S(E(s),Fe),h=(null===(t=S(E(s),Ie))||void 0===t?void 0:t.getBox("mfhd")).sequence_number;i.ldt=a.dts,i.lfd=a.duration,i.appendMediaSegment({sequenceNumber:h,initSegmentIndex:S(E(s),Be)[n],buffer:S(E(s),ke),fpts:c,lpts:l});var d=f.currentTime,p=f.buffered;S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] appendBuffer mediaSegment, fpts: ").concat(c.toFixed(5),", lpts: ").concat(l.toFixed(5))),p.container(d)&&(f.readyState===o.HAVE_METADATA&&(f.readyState=o.HAVE_CURRENT_DATA),f.readyState===o.HAVE_CURRENT_DATA&&p.end(0)>d&&(f.readyState=o.HAVE_FUTURE_DATA),f.readyState===o.HAVE_FUTURE_DATA&&p.end(0)-p.start(0)>=S(E(s),Ge)&&(f.readyState=o.HAVE_ENOUGH_DATA)),f.readyState>=o.HAVE_METADATA&&Q(f,ce.PROGRESS)}}),qe.set(E(s),{writable:!0,value:function(e){}}),Je.set(E(s),{writable:!0,value:function(){S(E(s),Xe).call(E(s)),s.updating=!1,Q(E(s),"error"),Q(E(s),"updateend"),S(E(s),De).endOfStream("decode")}}),Xe.set(E(s),{writable:!0,value:function(){S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] call resetParseState()")),S(E(s),xe),S(E(s),Qe).call(E(s)),R(E(s),ke,null),R(E(s),Ie,null),R(E(s),xe,"WAITING_FOR_SEGMENT")}}),Qe.set(E(s),{writable:!0,value:function(){for(var e=0;e<S(E(s),Se).length;e++){var t=S(E(s),Se)[e];t.ldt=void 0,t.lfd=void 0,t.het=void 0,t.nrapFlag=!0}}}),Ze.set(E(s),{writable:!0,value:(l=I(M().mark((function e(t,r){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.updating=!0,e.next=3,s.dispatchEvent(new Event("updatestart"));case 3:S(E(s),ve).log(S(E(s),be),"[".concat(s.mediaType,"] call removeBuffer, start: ").concat(t,", end: ").concat(r)),S(E(s),$e).call(E(s),t,r),s.updating=!1,Q(E(s),"update"),Q(E(s),"updateend");case 8:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})}),$e.set(E(s),{writable:!0,value:function(e,t){for(var r=0;r<S(E(s),Se).length;r++){var n=S(E(s),Se)[r],i=n.trackId;n.trackRanges;if(void 0===i)throw new Error("Error track, cantnot get track id");var a=n.remove(e,t);S(E(s),Qe).call(E(s));var u=S(E(s),Fe);S(E(s),De).activeSourceBuffers.indexOf(E(s))&&(u.currentTime>=e&&u.currentTime<t&&u.readyState>o.HAVE_METADATA&&(u.readyState=o.HAVE_METADATA),a&&u.readyState>=o.HAVE_METADATA&&Q(u,ce.PROGRESS))}S(E(s),Re)&&R(E(s),Re,!1)}}),et.set(E(s),{writable:!0,value:function(e){for(var t=0;t<S(E(s),Se).length;t++){var r=S(E(s),Se)[t];if(e===r.trackId)return r}return null}}),tt.set(E(s),{writable:!0,value:function(){return-1===S(E(s),De).sourceBuffers.indexOf(E(s))}}),rt.set(E(s),{writable:!0,value:function(){if(S(E(s),tt).call(E(s)))throw new L;if(s.updating)throw new Error("This SourceBuffer is still processing an 'appendBuffer' or 'remove' operation.")}}),R(E(s),ve,ae.getInstance()),s.mediaType=e,R(E(s),Fe,n),R(E(s),De,i),R(E(s),Me,a),s.updating=!1,R(E(s),ge,new H),R(E(s),we,0),s.textTracks=new X,R(E(s),Ae,1/0),R(E(s),Ee,0),R(E(s),ke,null),R(E(s),Te,0),R(E(s),Re,!1),R(E(s),Se,[]),R(E(s),Pe,!1),R(E(s),xe,"WAITING_FOR_SEGMENT"),R(E(s),Be,{}),R(E(s),We,{}),R(E(s),Oe,_e.getInstance()),S(E(s),ve).log(S(E(s),be),"SOURCE BUFFER CREATE"),s}return w(r,[{key:"appendBuffer",value:function(e){if(S(this,Ve).call(this),S(this,ke)){var t=new Uint8Array(S(this,ke)),r=new Uint8Array(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),R(this,ke,n.buffer)}else R(this,ke,e);this.updating=!0,this.dispatchEvent(new Event("updatestart")),S(this,He).call(this)}},{key:"abort",value:function(){if(S(this,tt).call(this))throw new Error("This SourceBuffer has been removed from the parent media source.");if(S(this,De).readyState!==n.OPEN)throw new L;this.updating&&(S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] Call abort when this.updating is true.")),this.updating=!1,Q(this,"abort"),Q(this,"updateend")),S(this,Xe).call(this),this.appendWindowStart=0,this.appendWindowEnd=Number.POSITIVE_INFINITY}},{key:"remove",value:function(e,t){S(this,rt).call(this),S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] remove buffer: ").concat(e,", ").concat(t));var r=S(this,De).duration;if(Number.isNaN(r))throw new TypeError("MediaSource duration cannot NaN");if(e<0||e>r)throw new TypeError("Start must be valid.");if(t<=e||Number.isNaN(t))throw new TypeError("end must be valid.");S(this,Me).call(this),S(this,Ze).call(this,e,t)}},{key:"__seek__",value:function(e){for(var t=0;t<S(this,Se).length;t++){var r=S(this,Se)[t],n=r.trackId,i=S(this,We)[n];if(i){var a=r.getCurrentSegmentIndex(e);S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] seek to ").concat(e,", target segment index: ").concat(a)),S(this,We)[n]=-1!==a?{index:a-1,fpts:-1,lpts:-1,initSegmentIndex:i.initSegmentIndex}:{index:-1,fpts:-1,lpts:-1,initSegmentIndex:i.initSegmentIndex}}}}},{key:"__getNextCachedSegments__",value:function(e,t){var r=[],i=!1;if(t)return{buffer:r,isEndOfStream:i,sampleRate:S(this,Ce)};for(var a=0;a<S(this,Se).length;a++){var o=S(this,Se)[a],s=o.trackId;if(void 0===s)throw new Error("Error track, cannot get trackID");var u=S(this,We)[s];if(!u||u.lpts-e<K.MIN_DECODE_BUFFER_TIME){var c=-1;if(u&&-1!==u.index)c=u.index+1;else{var l=o.getCurrentSegmentIndex(e);l&&(c=l)}var f=o.getMediaSegment(c);if(f){if(u||(u={},S(this,We)[s]=u),!u||u.initSegmentIndex!==f.initSegmentIndex){var h,d=null===(h=o.getInitSegment(f.initSegmentIndex))||void 0===h?void 0:h.buffer;if(!d)throw new Error("Cannot get init segment buffer.");r.push({data:d,isInitSegment:!0}),u.initSegmentIndex=f.initSegmentIndex}r.push({data:f.buffer,isInitSegment:!1}),u.index=c,u.fpts=f.fpts,u.lpts=f.lpts,S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] get cache segment, fpts: ").concat(f.fpts,", lpts: ").concat(f.lpts)),S(this,De).readyState===n.ENDED&&o.isLastSegment(c)&&(i=!0)}}}return{buffer:r,isEndOfStream:i,sampleRate:S(this,Ce)}}},{key:"__isEndOfStream__",value:function(){for(var e=0;e<S(this,Se).length;e++){var t,r=S(this,Se)[e],n=r.trackId;if(void 0!==n&&r.isLastSegment(null===(t=S(this,We)[n])||void 0===t?void 0:t.index))return!0}return!1}},{key:"mode",get:function(){return S(this,ye)},set:function(e){if(e===u.SEQUENCE)throw new Error("Mode sequence is not implemented!");if(S(this,rt).call(this),this.generateTimestampsFlag&&"segments"===e)throw new TypeError("GenerateTimestampsFlag is true, not support segments mode");if(S(this,Me).call(this),"PARSING_MEDIA_SEGMENT"===S(this,xe))throw new L;S(this,De).readyState&&S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] MediaSource is working fine!, readyState:"),S(this,De).readyState.toString()),R(this,ye,e)}},{key:"buffered",get:function(){if(S(this,tt).call(this))return R(this,ge,new H),S(this,ge);for(var e=0,t=S(this,Se).length,r=0;r<t;r++){var i=S(this,Se)[r].trackRanges;if(i.length>0){var a=i.end(i.length-1);a>e&&(e=a)}}if(0===e)return S(this,ge).length>0&&S(this,ge).clear(),S(this,ge);var o=new H;o.add(0,e);for(var s=0;s<t;s++){var u=S(this,Se)[s].trackRanges;o=j(o,u);var c=u.length;if(c>0){var l=u.end(c-1);S(this,De).readyState===n.ENDED&&(e=l)}}return R(this,ge,o),S(this,ge)}},{key:"timestampOffset",get:function(){return S(this,we)},set:function(e){if(S(this,rt).call(this),S(this,Me).call(this),"PARSING_MEDIA_SEGMENT"===S(this,xe))throw new L;R(this,we,e)}},{key:"appendWindowStart",get:function(){return S(this,Ee)},set:function(e){if(S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] set appendWindowStart: ").concat(e)),S(this,rt).call(this),e<0||e>=S(this,Ae))throw new TypeError("AppendWindowStart cannot greater than or equal End.");R(this,Ee,e)}},{key:"appendWindowEnd",get:function(){return S(this,Ae)},set:function(e){if(S(this,ve).log(S(this,be),"[".concat(this.mediaType,"] set appendWindowEnd: ").concat(e)),S(this,rt).call(this),Number.isNaN(e))throw new TypeError;if(e<=S(this,Ee))throw new TypeError("AppendWindowEnd cannot less then or equal Start.");R(this,Ae,e)}},{key:"firstinit",get:function(){return S(this,Pe)}}]),r}(x);function it(e,t){it=function(e,t){return new a(e,void 0,t)};var r=b(RegExp),n=RegExp.prototype,i=new WeakMap;function a(e,t,n){var a=r.call(this,e,t);return i.set(a,n||i.get(e)),a}function o(e,t){var r=i.get(t);return Object.keys(r).reduce((function(t,n){return t[n]=e[r[n]],t}),Object.create(null))}return A(a,r),a.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=o(t,this)),t},a.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var r=i.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+r[t]})))}if("function"==typeof t){var a=this;return n[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==d(e[e.length-1])&&e.push(o(e,a)),t.apply(this,e)}))}return n[Symbol.replace].call(this,e,t)},it.apply(this,arguments)}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var ot=new WeakMap,st=new WeakMap,ut=new WeakMap,ct=new WeakMap,lt=new WeakMap,ft=new WeakMap,ht=new WeakMap,dt=new WeakMap,pt=new WeakMap,_t=new WeakMap,mt=new WeakMap,vt=new WeakMap,bt=new WeakMap,yt=function(e){A(r,e);var t=at(r);function r(){var e;return y(this,r),e=t.call(this),ot.set(E(e),{writable:!0,value:void 0}),st.set(E(e),{writable:!0,value:"[BwpMediaSource]"}),T(E(e),"sourceBuffers",void 0),T(E(e),"activeSourceBuffers",void 0),ut.set(E(e),{writable:!0,value:void 0}),ct.set(E(e),{writable:!0,value:void 0}),T(E(e),"onsourceopen",void 0),T(E(e),"onsourceended",void 0),T(E(e),"onsourceclose",void 0),lt.set(E(e),{writable:!0,value:void 0}),ft.set(E(e),{writable:!0,value:void 0}),ht.set(E(e),{writable:!0,value:void 0}),dt.set(E(e),{writable:!0,value:function(t){if(S(E(e),ct)!==t){for(var r=NaN,n=0;n<e.sourceBuffers.length;n++){var i=e.sourceBuffers[n].buffered;if(i.length>0){var a=i.end(i.length-1);a>-1&&(!r||a>r)&&(r=a)}}if(r&&t<r)throw new Error("InvalidStateError, duration must be valid");R(E(e),ct,t),S(E(e),ft).duration=t}}}),pt.set(E(e),{writable:!0,value:function(t){if(R(E(e),ut,n.ENDED),Q(E(e),"sourceended"),S(E(e),ot).warn(S(E(e),st),"source ended"),!t){for(var r=0,i=0;i<e.sourceBuffers.length;i++){var a=e.sourceBuffers[i].buffered;if(a.length>0){var o=a.end(a.length-1);o>r&&(r=o)}}S(E(e),dt).call(E(e),r)}}}),T(E(e),"createObjectURL",(function(){window.__bwp__||(window.__bwp__={});var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r="blob:".concat(window.location.origin,"/").concat(t);return window.__bwp__[r]=E(e),r})),_t.set(E(e),{writable:!0,value:function(){S(E(e),ut)===n.ENDED&&(R(E(e),ut,n.OPEN),Q(E(e),"sourceopen"),S(E(e),ot).log(S(E(e),st),"source open"))}}),mt.set(E(e),{writable:!0,value:function(){document.removeEventListener("visibilitychange",S(E(e),vt)),R(E(e),ut,n.OPEN),Q(E(e),"sourceopen"),S(E(e),ot).log(S(E(e),st),"source open")}}),vt.set(E(e),{writable:!0,value:function(){S(E(e),bt).call(E(e))&&(window.__bwp_document_has_showed__||(window.__bwp_document_has_showed__=!0),S(E(e),ht)&&(R(E(e),ht,!1),S(E(e),ot).warn(S(E(e),st),"visibility change trigger sourceopen"),setTimeout((function(){S(E(e),mt).call(E(e))}),0)))}}),bt.set(E(e),{writable:!0,value:function(){return"visible"===document.visibilityState}}),R(E(e),ot,ae.getInstance()),e.sourceBuffers=new D,e.activeSourceBuffers=new D,R(E(e),ut,n.CLOSED),R(E(e),ct,NaN),R(E(e),lt,!0),R(E(e),ht,!1),void 0===window.__bwp_document_has_showed__&&(window.__bwp_document_has_showed__=S(E(e),bt).call(E(e))),window.__bwp_document_has_showed__||document.addEventListener("visibilitychange",S(E(e),vt)),S(E(e),ot).log(S(E(e),st),"MediaSource CREATE, readyState is: ".concat(S(E(e),ut))),e}return w(r,[{key:"addSourceBuffer",value:function(e){if(!e||!e.trim())throw new TypeError("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided is empty");var t=e.match(it(/(video|audio)\/mp4;.*?codecs="(hev|mp4a|hvc).*?(,(mp4a).*?|)"(;width="(.*?)";height="(.*?)"|)/,{mediaType:1,codec:2,codec2:4,width:6,height:7})),r=null==t?void 0:t.groups;if(!t||!r)throw new DOMException("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided ('".concat(e,"') is unsupported."));var i,a=r.mediaType,o=r.codec,s=r.codec2;if(!a||!o)throw new DOMException("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided ('".concat(e,"') is unsupported."));if("video"===a&&R(this,lt,"hev"===o||"hvc"===o),S(this,ot).log(S(this,st),"ready to add SourceBuffer: ".concat(e,", isHEVC: ").concat(S(this,lt),", readyState: ").concat(this.readyState)),!S(this,lt))throw new Error("H.264 not implemented");if(S(this,ut)!==n.OPEN)throw new Error("InvalidStateError, BwpMediaSource ready state not open!");i="audio"===a?c.AUDIO:"mp4a"===s?c.MIX:c.VIDEO;var u=new nt(i,S(this,ft),this,S(this,_t));return this.sourceBuffers.push(u),u.generateTimestampsFlag=!1,u.mode="segments",this.sourceBuffers.dispatchEvent(new Event("addsourcebuffer")),u}},{key:"removeSourceBuffer",value:function(e){if(S(this,ot).log(S(this,st),"remove SourceBuffer: ".concat(e)),-1===this.sourceBuffers.indexOf(e))throw new Error("SourceBuffer not in SourceBuffers");e.updating&&(e.abort(),Q(e,"abort"),Q(e,"updateend"));var t=this.activeSourceBuffers.indexOf(e);-1!==t&&(this.activeSourceBuffers.remove(t),Q(this.activeSourceBuffers,"removesourcebuffer")),this.sourceBuffers.remove(this.sourceBuffers.indexOf(e))}},{key:"endOfStream",value:function(e){if(S(this,ot).log(S(this,st),"endOfStream, isHEVC: ".concat(S(this,lt),", error: ").concat(e)),S(this,ut)!==n.OPEN)throw new DOMException("Failed to execute 'endOfStream' on 'MediaSource': The MediaSource's readyState is not 'open'.");for(var t=0;t<this.sourceBuffers.length;t++)if(this.sourceBuffers[t].updating)throw new Error("InvalidStateError, some BwoSourceBuffer is updating");S(this,pt).call(this,e),S(this,ft).__endOfStream__()}},{key:"__attach__",value:function(e){R(this,ft,e),window.__bwp_document_has_showed__?(R(this,ht,!1),S(this,mt).call(this)):R(this,ht,!0)}},{key:"__deatch__",value:function(){R(this,ut,n.CLOSED),R(this,ct,NaN);for(var e=this.activeSourceBuffers.length;e>0;e--)this.activeSourceBuffers.remove(e-1);this.activeSourceBuffers.dispatchEvent(new Event("removesourcebuffer"));for(var t=this.sourceBuffers.length;t>0;t--)this.sourceBuffers.remove(t-1);this.sourceBuffers.dispatchEvent(new Event("removesourcebuffer")),Q(this,"sourceclose"),S(this,ot).warn(S(this,st),"source close")}},{key:"readyState",get:function(){return S(this,ut)}},{key:"duration",get:function(){return S(this,ut)===n.CLOSED?NaN:S(this,ct)},set:function(e){if(!e||e<0)throw new TypeError("Failed to set the 'duration' property on 'BwpMediaSource': The duration provided (".concat(e,") is less than the minimum bound (0)."));if(S(this,ut)!==n.OPEN)throw new DOMException("Failed to set the 'duration' property on 'BwpMediaSource': The BwpMediaSource's readyState is not 'open'.");S(this,dt).call(this,e)}}],[{key:"isTypeSupported",value:function(e){if(0===e.length)return!1;var t=e.match(it(/(video|audio)\/mp4;.*?codecs="(hev|mp4a|hvc).*?(,(mp4a).*?|)"(;width="(.*?)";height="(.*?)"|)/,{mediaType:1,codec:2,codec2:4,width:6,height:7})),r=null==t?void 0:t.groups;if(t&&r){var n=r.mediaType,i=r.codec,a=parseInt(r.width,10),o=parseInt(r.height,10);if(!n||!i)return!1;if("video"===n&&("hev"===i||"hvc"===i))return!(a>=3840&&o>1080);if("audio"===n&&"mp4a"===i)return!0}return!1}}]),r}(x),gt=function e(){y(this,e)};T(gt,"WASM_PLAYER_ERROR",7e3),T(gt,"CORE_PLAYER_LOAD_ERROR",7001),T(gt,"CORE_PLAYER_MODULE_LOAD_TIMEOUT",7002),T(gt,"CORE_PLAYER_EXCEPTION",7003),T(gt,"WASM_MEMORY_MALLOC_ERROR",7004),T(gt,"CORE_PLAYER_ADD_FUNCTION_ERROR",7005),T(gt,"AUDIO_RENDER_ERROR",7007),T(gt,"AUDIO_CHANNELS_NOT_SUPPORT",7008),T(gt,"TRIGGER_CANPLAY_ERROR",7009),T(gt,"OUT_OF_SYNC",7013);var wt=gt,Et=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]);function At(){try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(Et)}catch(e){return!1}}function kt(){var e,t,r=document.createElement("canvas"),n="",i="";try{(e=r.getContext("webgl")||r.getContext("webgl2")||r.getContext("experimental-webgl"))&&(t=e.getExtension("WEBGL_debug_renderer_info"))&&(n=e.getParameter(t.UNMASKED_VENDOR_WEBGL),i=e.getParameter(t.UNMASKED_RENDERER_WEBGL))}catch(e){return null}return{vendor:n,renderer:i}}var Tt="name",St="version";function Rt(e,t){for(var r,n,i,a,o,s={},u=0;u<t.length;u+=2){r=t[u],i=t[u+1];for(var c=0;c<r.length;c++)if(o=r[c].exec(e)){for(var l=0;l<i.length;l++)a=o[l+1],"object"===d(n=i[l])&&n.length>0?2===n.length?s[n[0]]=n[1]:console.error("[Browser] [rgxMapper] not support arg count!"):s[n]=a||void 0;return s}}return s}var xt=function(){var e,t,r="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:null,n="other",i="other",a="0";if(null!==r){n=function(e){var t=Rt(e,[[/microsoft (windows) (vista|xp)/i],"",[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[/ ]?([\d.\w ]*)/i,/(windows)[/ ]?([ntce\d. ]+\w)(?!.+xbox)/i],[Tt],[/(win(?=3|9|n)|win 9x )([nt\d.]+)/i],"Windows",[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[Tt,"iOS"]],[/(mac os x) ?([\w. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[Tt,"Mac OS"]]]).name;return{Windows:!0,"Mac OS":!0}[t]?t:"other"}(r);var o=function(e){var t=Rt(e,[[/edg(?:e|ios|a)?\/([\w.]+)/i],[St,[Tt,"Edge"]],[/\bopr\/([\w.]+)/i],[St,[Tt,"Opera"]],[/(kindle)\/([\w.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[/ ]?([\w.]*)/i,/(avant |iemobile|slim)(?:browser)?[/ ]?([\w.]*)/i,/(ba?idubrowser)[/ ]?([\w.]+)/i,/(?:ms|\()(ie) ([\w.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w.]+)/i,/(weibo)__([\d.]+)/i],[Tt,St],[/(?:\buc? ?browser|(?:juc.+)ucweb)[/ ]?([\w.]+)/i],[St,[Tt,"UCBrowser"]],[/\bqbcore\/([\w.]+)/i],[St,[Tt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w.]+)/i],[St,[Tt,"WeChat"]],[/konqueror\/([\w.]+)/i],[St,[Tt,"Konqueror"]],[/trident.+rv[: ]([\w.]{1,9})\b.+like gecko/i],[St,[Tt,"IE"]],[/yabrowser\/([\w.]+)/i],[St,[Tt,"Yandex"]],[/(avast|avg)\/([\w.]+)/i],[[Tt,"Avast/AVG Secure Browser"],St],[/coc_coc\w+\/([\w.]+)/i],[St,[Tt,"Coc Coc"]],[/dolfin\/([\w.]+)/i],[St,[Tt,"Dolphin"]],[/slbrowser\/([\w.]+)/i],[St,[Tt,"Lenovo"]],[/115browser\/([\w.]+)/i],[St,[Tt,"115 Browser"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[Tt,"360 Browser"]],[/(comodo_dragon)\/([\w.]+)/i],[[Tt,"Comodo Dragon"],St],[/(electron)\/([\w.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[/ ]?([\w.]+)/i],[Tt,St],[/(metasr)[/ ]?([\w.]+)/i,/(lbbrowser)/i],[Tt],[/headlesschrome(?:\/([\w.]+)| )/i],[St,[Tt,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w.]+)/i],[[Tt,"Chrome WebView"],St],[/(chrome)\/v?([\w.]+)/i],[[Tt,"Chrome"],St]]);return{browser:{Chrome:!0,Edge:!0}[t.name]?t.name:"other",version:t.version||"0"}}(r);i=o.browser,a=o.version}return{ua:r||"",os:n,browser:i,version:a,gpuInfo:kt(),hardwareConcurrency:window.navigator.hardwareConcurrency||0,isPThreadSupported:At(),isSupportHEVC:(null===(e=window.MediaSource)||void 0===e||null===(t=e.isTypeSupported)||void 0===t?void 0:t.call(e,'video/mp4; codecs="hev1.1.6.L120.90"'))||!1}};function Pt(e,t,r){return Dt.apply(this,arguments)}function Dt(){return(Dt=I(M().mark((function e(t,r,n){var i,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{credentials:"same-origin"});case 2:if((i=e.sent).ok){e.next=5;break}throw new Error("failed to load wasm file from network");case 5:return e.next=7,i.arrayBuffer();case 7:return a=e.sent,e.next=10,t.put(r,a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ft=function(){function e(t,r){y(this,e),T(this,"dbName",void 0),T(this,"storeName",void 0),T(this,"dbPromise",void 0),this.dbName=t,this.storeName=r,this.initDB()}var t,r,n,i,a;return w(e,[{key:"initDB",value:function(e){var t=this;if(!ee().indexedDB)throw new Error("Not support indexedDB!");var r=indexedDB.open(this.dbName,e);this.dbPromise=new Promise((function(e,n){r.onsuccess=function(){e(r.result)},r.onupgradeneeded=function(){r.result.objectStoreNames.contains(t.storeName)||r.result.createObjectStore(t.storeName)},r.onerror=function(e){n(e)}}))}},{key:"getObjectStore",value:(a=I(M().mark((function e(t){var r,n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbPromise;case 2:return r=e.sent,n=r.transaction(this.storeName,t),e.abrupt("return",n.objectStore(this.storeName));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"get",value:(i=I(M().mark((function e(t){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readonly");case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,n){var i=r.get(t);i.onsuccess=function(){e(i.result)},i.onerror=n})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"put",value:(n=I(M().mark((function e(t,r){var n;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,i){var a=n.put(r,t);a.onsuccess=function(){e(a.result)},a.onerror=i})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"delete",value:(r=I(M().mark((function e(t){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return r=e.sent,e.abrupt("return",r.delete(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"clear",value:(t=I(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return t=e.sent,e.abrupt("return",t.clear());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"isSupported",value:function(){return!!ee().indexedDB}}]),e}(),Mt={BROWSER_LIST:{Chrome:{min:80,blackList:[]},Edge:{min:80,blackList:[]}},OS_LIST:{Windows:!0,"Mac OS":!0},BASE_CPU_CORE_NUMBER:4},Ot="[Browser]",It=ae.getInstance(),Nt={},Ct=!1,Ut=null,Lt=navigator.userAgent,Bt="bwphevc_supported";function Wt(e){var t=JSON.stringify({version:f,ua:Lt,supported:e,supportInfo:Nt,cached:Ct,date:+new Date});localStorage.setItem(Bt,t)}function Gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;setTimeout((function(){Pt(new Ft("bwphevc","lib"),"libwpengn.wasm",h).then((function(){It.log(Ot,"Cache done!"),Ct=!0,Wt(!0),e(!0)})).catch((function(){e(!1)}))}),t)}var Vt,Ht=function(){if(null!==Ut)return Ut&&Ct;Ut=!1;var e=JSON.parse(localStorage.getItem(Bt)||"null"),t=(null==e?void 0:e.version)===f,r=!(e&&t&&e.ua===Lt),n=window.navigator.hardwareConcurrency>=6?6e3:9e3;return r?(Ct=Boolean(e&&e.cached&&t),setTimeout((function(){var e,t,r,n,i,a,o,s,u,c=(e=+new Date,t=xt(),r=Mt.BROWSER_LIST[t.browser],n=!!Mt.OS_LIST[t.os]&&!!r&&parseFloat("".concat(t.version))>=r.min,i=!!t.gpuInfo,a=t.hardwareConcurrency>=Mt.BASE_CPU_CORE_NUMBER,o=t.isPThreadSupported,s=t.isSupportHEVC,u=!(!(o&&a&&i&&n)||s&&"Edge"!==t.browser),It.warn(Ot,"supportedChecker end spent: ".concat(+new Date-e,"ms, pass: ").concat(u)),{pass:u,supportInfo:{browser:n,browserHEVC:s,cpu:a,gpu:i,gpuInfo:t.gpuInfo,pthread:o,hardwareConcurrency:t.hardwareConcurrency}});Nt=c.supportInfo,Wt(Ut=c.pass),Ut&&!Ct&&Gt((function(){}))}),n)):null!=e&&e.supported?(Ut=!0,null!=e&&e.cached?(It.log(Ot,"SUPPORT! Already cached!"),Ct=!0):(It.log(Ot,"SUPPORT! But not cache done!"),Nt=e.supportInfo,Ct=!1,Gt((function(){}),n))):It.log(Ot,"Not SUPPORT!"),Boolean(Ut&&Ct)},Yt=function e(){var t;y(this,e),T(this,"fps",void 0),T(this,"creationTime",void 0),T(this,"totalVideoFrames",void 0),T(this,"droppedVideoFrames",void 0),this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.creationTime=+new Date-(null===(t=window.performance)||void 0===t?void 0:t.timing.navigationStart)||0};!function(e){e.CANPLAY="canplay"}(Vt||(Vt={}));var jt=Event;"function"!=typeof Event&&(jt=function e(){y(this,e)});var zt=jt;function Kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var qt=function(e){A(r,e);var t=Kt(r);function r(e,n,i){var a;return y(this,r),T(E(a=t.call(this,ce.PERFORMANCE,i)),"errorCode",void 0),T(E(a),"describe",void 0),a.errorCode=e,a.describe=n,a}return r}(zt),Jt=r(286);function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var Qt=function(e){A(n,e);var t,r=Xt(n);function n(e,t){var i;return y(this,n),T(E(i=r.call(this)),"logger",void 0),T(E(i),"TAG","[AudioWorkletRender]"),T(E(i),"DEFAULT_VOLUME",1),T(E(i),"audioCtx",void 0),T(E(i),"gainNode",void 0),T(E(i),"audioBuffer",void 0),T(E(i),"audioprocessCallback",void 0),T(E(i),"errorCallback",void 0),T(E(i),"bwpProcessorUrl",void 0),T(E(i),"bwpProcessorNode",void 0),T(E(i),"_volume",void 0),T(E(i),"playState",void 0),T(E(i),"seeking",void 0),T(E(i),"seekFlag",void 0),T(E(i),"onmessage",(function(e){var t=e.data;if(t&&i.audioCtx){var r=t.message,n=t.options;if("TIME_UPDATE"===r){var a=n.currentTime,o=n.bufferTime,s=n.timeStamp;void 0===a||void 0===o||i.seeking||i.audioprocessCallback&&i.audioprocessCallback(a,o,s)}else"SEEKED"===r?(null==n?void 0:n.seekFlag)===i.seekFlag&&(i.seeking=!1):"ERROR"===r&&i.errorCallback&&i.errorCallback(wt.AUDIO_RENDER_ERROR,(null==n?void 0:n.detail)||"BwpProcessor unknow error")}})),T(E(i),"setAutoResume",(function(){for(var e=["keydown","mousedown","touchstart"],t=0;t<e.length;t++)document.addEventListener(e[t],(function(){i.resume()}),{once:!0})})),i.logger=ae.getInstance(),i.audioCtx=null,i.gainNode=null,i.audioBuffer=[],i._volume=i.DEFAULT_VOLUME,i.playState=!1,i.seeking=!1,i.audioprocessCallback=e,i.errorCallback=t,i}return w(n,[{key:"play",value:function(){this.playState=!0,this.postSimpleMessage("PLAY")}},{key:"pause",value:function(){this.playState=!1,this.postSimpleMessage("PAUSE")}},{key:"seek",value:function(){var e;this.seeking=!0,this.seekFlag=+new Date,null===(e=this.bwpProcessorNode)||void 0===e||e.port.postMessage({message:"SEEK",seekFlag:this.seekFlag})}},{key:"canPlay",value:function(){return!(!this.audioCtx||"suspended"===this.audioCtx.state)}},{key:"isPlaying",value:function(){return this.playState}},{key:"fillBuffer",value:function(e){var t;null===(t=this.bwpProcessorNode)||void 0===t||t.port.postMessage({message:"APPEND_BUFFER",buffer:e},[e.data])}},{key:"flushBuffer",value:function(){this.postSimpleMessage("FLUSH")}},{key:"init",value:(t=I(M().mark((function e(t){var r,n,i,a=this;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.log(this.TAG,"init audio worklet render with sampleRate: ".concat(t)),r=+new Date,this.audioCtx&&this.destroy(!0),e.prev=3,this.bwpProcessorUrl=URL.createObjectURL(new Blob([Jt],{type:"application/javascript"})),this.audioCtx=new(window.AudioContext||window.webkitAudioContext)({sampleRate:t}),i=this.audioCtx,this.gainNode=i.createGain(),this.gainNode.gain.value=this._volume,e.next=11,null==i||null===(n=i.audioWorklet)||void 0===n?void 0:n.addModule(this.bwpProcessorUrl);case 11:if(i&&this.gainNode){e.next=13;break}return e.abrupt("return");case 13:this.bwpProcessorNode=new window.AudioWorkletNode(i,"bwp-processor",{channelCount:2,numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[2]}),this.bwpProcessorNode.port.onmessage=this.onmessage,this.bwpProcessorNode.port.start(),this.bwpProcessorNode.connect(this.gainNode),this.gainNode.connect(i.destination),URL.revokeObjectURL(this.bwpProcessorUrl),this.logger.warn(this.TAG,"init AudioWorkletNode done, ".concat(+new Date-r," ms")),setTimeout((function(){a.triggerCanplay()})),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),this.errorCallback&&this.errorCallback(wt.AUDIO_RENDER_ERROR,(null===e.t0||void 0===e.t0?void 0:e.t0.message)||"BwpProcessor init error");case 26:this.setAutoResume();case 27:case"end":return e.stop()}}),e,this,[[3,23]])}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{null!==this.audioCtx&&(this.gainNode&&this.bwpProcessorNode&&(this.flushBuffer(),this.bwpProcessorNode.port.onmessage=null,this.bwpProcessorNode.port.close(),this.bwpProcessorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.audioCtx.destination)),this.audioCtx.close()),this.audioCtx=null,this.gainNode=null,e||(this.audioprocessCallback=null,this.errorCallback=null),this.audioBuffer.length=0,this.playState=!1,this._volume=1,this.seeking=!1,this.seekFlag=0}catch(e){}}},{key:"postSimpleMessage",value:function(e){var t;null===(t=this.bwpProcessorNode)||void 0===t||t.port.postMessage({message:e})}},{key:"resume",value:function(){var e=this;this.audioCtx&&"suspended"===this.audioCtx.state&&this.audioCtx.resume().then((function(){e.triggerCanplay(),e.playState&&e.logger.warn(e.TAG,"Audio is resumed")}))}},{key:"triggerCanplay",value:function(){this.canPlay()&&(this.logger.warn(this.TAG,"audio render [canplay]"),Q(this,Vt.CANPLAY))}},{key:"volume",get:function(){return this._volume},set:function(e){this.gainNode&&(this.gainNode.gain.value=e,this._volume=e)}},{key:"sampleRate",get:function(){var e;return(null===(e=this.audioCtx)||void 0===e?void 0:e.sampleRate)||0}}]),n}(x),Zt=function e(){y(this,e)};T(Zt,"INIT","init"),T(Zt,"RELOAD","reload"),T(Zt,"DESTROY","destroy"),T(Zt,"AUDIO_RENDER_INIT_DONE","audio_render_init_done"),T(Zt,"PLAY","play"),T(Zt,"PAUSE","pause"),T(Zt,"SEEK","seek"),T(Zt,"PLAYBACK_RATE","playback_rate"),T(Zt,"PLAYBACK_QUALITY","playback_quality"),T(Zt,"GET_PLAYBACK_QUALITY","get_playback_quality"),T(Zt,"RESIZE","resize"),T(Zt,"FIRST_FRAME","first_frame"),T(Zt,"SEEKED","seeked"),T(Zt,"BUFFER_FLUSHED","buffer_flushed"),T(Zt,"PLAY_END","play_end"),T(Zt,"SET_AUDIO_TIME","set_audio_time"),T(Zt,"SET_DECODE_MODE","set_decode_mode"),T(Zt,"SET_APPEND_WINDOW","set_append_window"),T(Zt,"SET_PIP_MODE","set_pip_mode"),T(Zt,"END_OF_STREAM","end_of_stream"),T(Zt,"RESET_OUTOFSYNC_FRAME_COUNT","reset_outofsync_frame_count"),T(Zt,"REDRAW_LAST_FRAME","redraw_last_frame"),T(Zt,"OPENED","opened"),T(Zt,"TIMEUPDATE","timeupdate"),T(Zt,"FILL_BUFFER","fill_buffer"),T(Zt,"RENDER_AUDIO","render_audio"),T(Zt,"FALLBACK","fallback"),T(Zt,"LOG","log"),T(Zt,"ERROR","error"),T(Zt,"PERFORMANCE","performance");var $t=Zt;function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var tr,rr,nr=function(e){A(r,e);var t=er(r);function r(e,n,i){var a;return y(this,r),T(E(a=t.call(this,ce.ERROR,i)),"errorCode",void 0),T(E(a),"describe",void 0),a.errorCode=e,a.describe=n,console.error("WasmPlayer error, errorCode: ".concat(e,", describe: ").concat(n)),a}return r}(zt),ir=r(477),ar=r.n(ir);function or(){return ar()('/*!\n * A web media player that implements W3C MSE and MediaElement v4.1.7 (1)\n *\n * Copyright 2020 - 2021 Bilibili, Inc.\n * Released in Wed Nov 03 2021 11:58:11 GMT+0800 (GMT+08:00)\n */!function(){var e={157:function(e){"use strict";e.exports=\'\\nvar WasmPlayerModuleFactory = (function() {\\n  var _scriptDir = typeof document !== \\\'undefined\\\' && document.currentScript ? document.currentScript.src : undefined;\\n  \\n  return (\\nfunction(WasmPlayerModuleFactory) {\\n  WasmPlayerModuleFactory = WasmPlayerModuleFactory || {};\\n\\n\\nfunction d(){g.buffer!=l&&n(g.buffer);return aa}function r(){g.buffer!=l&&n(g.buffer);return ba}function t(){g.buffer!=l&&n(g.buffer);return ca}function u(){g.buffer!=l&&n(g.buffer);return da}function ea(){g.buffer!=l&&n(g.buffer);return fa}var y;y||(y=typeof WasmPlayerModuleFactory !== \\\'undefined\\\' ? WasmPlayerModuleFactory : {});var ha,ia;y.ready=new Promise(function(a,b){ha=a;ia=b});var A={},B;for(B in y)y.hasOwnProperty(B)&&(A[B]=y[B]);var ja="./this.program";function ka(a,b){throw b;}\\nvar la="object"===typeof window,C="function"===typeof importScripts,ma="object"===typeof process&&"object"===typeof process.Jb&&"string"===typeof process.Jb.node,D=y.ENVIRONMENT_IS_PTHREAD||!1,E="";function na(a){return y.locateFile?y.locateFile(a,E):E+a}var oa;\\nif(la||C)C?E=self.location.href:"undefined"!==typeof document&&document.currentScript&&(E=document.currentScript.src),_scriptDir&&(E=_scriptDir),0!==E.indexOf("blob:")?E=E.substr(0,E.lastIndexOf("/")+1):E="",C&&(oa=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)});var pa=y.print||console.log.bind(console),F=y.printErr||console.warn.bind(console);for(B in A)A.hasOwnProperty(B)&&(y[B]=A[B]);A=null;\\ny.thisProgram&&(ja=y.thisProgram);y.quit&&(ka=y.quit);var qa,ra=[],G,H;y.wasmBinary&&(H=y.wasmBinary);var noExitRuntime=y.noExitRuntime||!0;"object"!==typeof WebAssembly&&I("no native wasm support detected");var g,sa,J=!1,K;function ta(a){a||I("Assertion failed: undefined")}function ua(a){var b=new TextDecoder(a);this.decode=function(c){c.buffer instanceof SharedArrayBuffer&&(c=new Uint8Array(c));return b.decode.call(b,c)}}var va="undefined"!==typeof TextDecoder?new ua("utf8"):void 0;\\nfunction wa(a,b,c){b>>>=0;var e=b+c;for(c=b;a[c>>>0]&&!(c>=e);)++c;if(16<c-b&&a.subarray&&va)return va.decode(a.subarray(b>>>0,c>>>0));for(e="";b<c;){var h=a[b++>>>0];if(h&128){var k=a[b++>>>0]&63;if(192==(h&224))e+=String.fromCharCode((h&31)<<6|k);else{var m=a[b++>>>0]&63;h=224==(h&240)?(h&15)<<12|k<<6|m:(h&7)<<18|k<<12|m<<6|a[b++>>>0]&63;65536>h?e+=String.fromCharCode(h):(h-=65536,e+=String.fromCharCode(55296|h>>10,56320|h&1023))}}else e+=String.fromCharCode(h)}return e}\\nfunction L(a){return(a>>>=0)?wa(r(),a,void 0):""}function xa(a,b,c,e){c>>>=0;if(0<e){e=c+e-1;for(var h=0;h<a.length;++h){var k=a.charCodeAt(h);if(55296<=k&&57343>=k){var m=a.charCodeAt(++h);k=65536+((k&1023)<<10)|m&1023}if(127>=k){if(c>=e)break;b[c++>>>0]=k}else{if(2047>=k){if(c+1>=e)break;b[c++>>>0]=192|k>>6}else{if(65535>=k){if(c+2>=e)break;b[c++>>>0]=224|k>>12}else{if(c+3>=e)break;b[c++>>>0]=240|k>>18;b[c++>>>0]=128|k>>12&63}b[c++>>>0]=128|k>>6&63}b[c++>>>0]=128|k&63}}b[c>>>0]=0}}\\nfunction ya(a){for(var b=0,c=0;c<a.length;++c){var e=a.charCodeAt(c);55296<=e&&57343>=e&&(e=65536+((e&1023)<<10)|a.charCodeAt(++c)&1023);127>=e?++b:b=2047>=e?b+2:65535>=e?b+3:b+4}return b}"undefined"!==typeof TextDecoder&&new ua("utf-16le");function za(a){var b=ya(a)+1,c=N(b);c&&xa(a,d(),c,b);return c}function Aa(a,b){d().set(a,b>>>0)}var l,aa,ba,ca,da,fa;D&&(l=y.buffer);\\nfunction n(a){l=a;y.HEAP8=aa=new Int8Array(a);y.HEAP16=new Int16Array(a);y.HEAP32=ca=new Int32Array(a);y.HEAPU8=ba=new Uint8Array(a);y.HEAPU16=new Uint16Array(a);y.HEAPU32=da=new Uint32Array(a);y.HEAPF32=new Float32Array(a);y.HEAPF64=fa=new Float64Array(a)}var Ba=y.INITIAL_MEMORY||167772160;\\nif(D)g=y.wasmMemory,l=y.buffer;else if(y.wasmMemory)g=y.wasmMemory;else if(g=new WebAssembly.Memory({initial:Ba/65536,maximum:65536,shared:!0}),!(g.buffer instanceof SharedArrayBuffer))throw F("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),ma&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),\\nError("bad memory");g&&(l=g.buffer);Ba=l.byteLength;n(l);var O,Ca=[],Da=[],Ea=[],Fa=[],Ga=0;function Ha(){return noExitRuntime||0<Ga}function Ia(){var a=y.preRun.shift();Ca.unshift(a)}var P=0,Ja=null,Q=null;y.preloadedImages={};y.preloadedAudios={};function I(a){if(y.onAbort)y.onAbort(a);ta(!D);F(a);J=!0;K=1;a=new WebAssembly.RuntimeError("abort("+a+"). Build with -s ASSERTIONS=1 for more info.");ia(a);throw a;}function Ka(){return R.startsWith("data:application/octet-stream;base64,")}var La=0;\\nfunction Ma(a){return function(){if(J)throw"program has already aborted!";try{return a.apply(null,arguments)}catch(b){if(J||1<La||"longjmp"===b)throw b;I("unhandled exception: "+[b,b.stack])}}}function Na(){var a=O.get,b={};O.get=function(c){var e=a.call(O,c),h=b[c];h&&h.cb===e||(h=b[c]={cb:e,Kb:Ma(e)});return h.Kb}}var R;R="libwpengn.wasm";Ka()||(R=na(R));\\nfunction Oa(){var a=R;try{if(a==R&&H)return new Uint8Array(H);if(oa)return oa(a);throw"both async and sync fetching of the wasm failed";}catch(b){I(b)}}function Pa(){return H||!la&&!C||"function"!==typeof fetch?Promise.resolve().then(function(){return Oa()}):fetch(R,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at \\\'"+R+"\\\'";return a.arrayBuffer()}).catch(function(){return Oa()})}var Qa={101808:function(){throw"Canceled!";}};\\nfunction S(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b(y);else{var c=b.cb;"number"===typeof c?void 0===b.Ma?O.get(c)():O.get(c)(b.Ma):c(void 0===b.Ma?null:b.Ma)}}}function Ra(a,b){if(0>=a||a>d().length||a&1||0>b)return-28;if(0==b)return 0;2147483647<=b&&(b=Infinity);var c=Atomics.load(t(),T>>2),e=0;if(c==a&&Atomics.compareExchange(t(),T>>2,c,0)==c&&(--b,e=1,0>=b))return 1;a=Atomics.notify(t(),a>>2,b);if(0<=a)return a+e;throw"Atomics.notify returned an unexpected value "+a;}\\ny._emscripten_futex_wake=Ra;function Sa(a){if(D)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!a)throw"Internal Error! Null pthread_ptr in cleanupThread!";var b=U.Fa[a];b&&(t()[a+12>>2>>>0]=0,U.Ta(b.worker))}\\nvar U={Ia:[],Ha:[],bb:[],Sb:function(){},pb:function(){for(var a=N(228),b=0;57>b;++b)u()[a/4+b>>>0]=0;t()[a+12>>2>>>0]=a;b=a+152;t()[b>>2>>>0]=b;var c=N(512);for(b=0;128>b;++b)u()[c/4+b>>>0]=0;Atomics.store(u(),a+100>>2,c);Atomics.store(u(),a+40>>2,a);Ta(a,!C,1);Ua(a)},qb:function(){U.receiveObjectTransfer=U.tb;U.threadInit=U.Db;U.threadCancel=U.Cb;U.threadExit=U.ib;U.setExitStatus=U.vb},Fa:{},ab:[],gb:function(){for(;0<U.ab.length;)U.ab.pop()();Va()},hb:function(a,b){Atomics.store(u(),a+56>>2,1);\\nAtomics.store(u(),a+60>>2,0);U.gb();Atomics.store(u(),a+4>>2,b);Atomics.store(u(),a+0>>2,1);Ra(a+0,2147483647);Ta(0,0,0)},vb:function(a){K=a},ib:function(a){var b=V();b&&(U.hb(b,a),D&&postMessage({cmd:"exit"}))},Cb:function(){U.hb(V(),-1);postMessage({cmd:"cancelDone"})},$a:function(){for(var a in U.Fa){var b=U.Fa[a];b&&b.worker&&U.Ta(b.worker)}U.Fa={};for(a=0;a<U.Ia.length;++a){var c=U.Ia[a];c.terminate()}U.Ia=[];for(a=0;a<U.Ha.length;++a)c=U.Ha[a],b=c.Ea,U.Za(b),c.terminate();U.Ha=[]},Za:function(a){if(a){if(a.Ga){var b=\\nt()[a.Ga+100>>2>>>0];t()[a.Ga+100>>2>>>0]=0;Wa(b);Wa(a.Ga)}a.Ga=0;a.Ya&&a.Ja&&Wa(a.Ja);a.Ja=0;a.worker&&(a.worker.Ea=null)}},Ta:function(a){U.ub(function(){delete U.Fa[a.Ea.Ga];U.Ia.push(a);U.Ha.splice(U.Ha.indexOf(a),1);U.Za(a.Ea);a.Ea=void 0})},ub:function(a){t()[Xa>>>2]=0;try{a()}finally{t()[Xa>>>2]=1}},tb:function(){},Db:function(){for(var a in U.bb)U.bb[a]()},rb:function(a,b){a.onmessage=function(c){var e=c.data,h=e.cmd;a.Ea&&(U.lb=a.Ea.Ga);if(e.targetThread&&e.targetThread!=V()){var k=U.Fa[e.Wb];\\nk?k.worker.postMessage(c.data,e.transferList):F(\\\'Internal error! Worker sent a message "\\\'+h+\\\'" to target pthread \\\'+e.targetThread+", but that thread no longer exists!")}else if("processQueuedMainThreadWork"===h)Ya();else if("spawnThread"===h)Za(c.data);else if("cleanupThread"===h)Sa(e.thread);else if("killThread"===h){c=e.thread;if(D)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!c)throw"Internal Error! Null pthread_ptr in killThread!";t()[c+12>>2>>>\\n0]=0;e=U.Fa[c];delete U.Fa[c];e.worker.terminate();U.Za(e);U.Ha.splice(U.Ha.indexOf(e.worker),1);e.worker.Ea=void 0}else if("cancelThread"===h){c=e.thread;if(D)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!c)throw"Internal Error! Null pthread_ptr in cancelThread!";U.Fa[c].worker.postMessage({cmd:"cancel"})}else if("loaded"===h)a.loaded=!0,b&&b(a),a.Oa&&(a.Oa(),delete a.Oa);else if("print"===h)pa("Thread "+e.threadId+": "+e.text);else if("printErr"===\\nh)F("Thread "+e.threadId+": "+e.text);else if("alert"===h)alert("Thread "+e.threadId+": "+e.text);else if("exit"===h)a.Ea&&Atomics.load(u(),a.Ea.Ga+64>>2)&&U.Ta(a);else if("exitProcess"===h)try{$a(e.returnCode)}catch(m){if(m instanceof W)return;throw m;}else"cancelDone"===h?U.Ta(a):"objectTransfer"!==h&&("setimmediate"===c.data.target?a.postMessage(c.data):F("worker sent an unknown command "+h));U.lb=void 0};a.onerror=function(c){F("pthread sent an error! "+c.filename+":"+c.lineno+": "+c.message)};\\na.postMessage({cmd:"load",urlOrBlob:y.mainScriptUrlOrBlob||_scriptDir,wasmMemory:g,wasmModule:sa})},jb:function(){var a=na("libwpengn.worker.js");U.Ia.push(new Worker(a))},nb:function(){0==U.Ia.length&&(U.jb(),U.rb(U.Ia[0]));return U.Ia.pop()},Lb:function(a){for(a=performance.now()+a;performance.now()<a;);}};y.establishStackSpace=function(a,b){ab(a,b);bb(a)};y.invokeEntryPoint=function(a,b){return O.get(a)(b)};var cb;cb=D?function(){return performance.now()-y.__performance_now_clock_drift}:function(){return performance.now()};\\nfunction db(a){this.Na=a-16;this.Ab=function(b){t()[this.Na+4>>2>>>0]=b};this.xb=function(b){t()[this.Na+8>>2>>>0]=b};this.yb=function(){t()[this.Na>>2>>>0]=0};this.wb=function(){var b=0;d()[this.Na+12>>0>>>0]=b};this.zb=function(){var b=0;d()[this.Na+13>>0>>>0]=b};this.ob=function(b,c){this.Ab(b);this.xb(c);this.yb();this.wb();this.zb()}}var eb=0;\\nfunction X(){function a(m){return(m=m.toTimeString().match(/\\\\(([A-Za-z ]+)\\\\)$/))?m[1]:"GMT"}if(D)return Y(2,1);if(!X.kb){X.kb=!0;var b=(new Date).getFullYear(),c=new Date(b,0,1),e=new Date(b,6,1);b=c.getTimezoneOffset();var h=e.getTimezoneOffset(),k=Math.max(b,h);t()[fb()>>2>>>0]=60*k;t()[gb()>>2>>>0]=Number(b!=h);c=a(c);e=a(e);c=za(c);e=za(e);h<b?(t()[Z()>>2>>>0]=c,t()[Z()+4>>2>>>0]=e):(t()[Z()>>2>>>0]=e,t()[Z()+4>>2>>>0]=c)}}\\nfunction Za(a){if(D)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var b=U.nb();if(!b)return 6;if(void 0!==b.Ea)throw"Internal error!";if(!a.Sa)throw"Internal error, no pthread ptr!";U.Ha.push(b);for(var c=N(512),e=0;128>e;++e)t()[c+4*e>>2>>>0]=0;var h=a.Ja+a.Ka;e=U.Fa[a.Sa]={worker:b,Ja:a.Ja,Ka:a.Ka,Ya:a.Ya,Ga:a.Sa};var k=e.Ga>>2;Atomics.store(u(),k+16,a.detached);Atomics.store(u(),k+25,c);Atomics.store(u(),k+10,e.Ga);Atomics.store(u(),k+20,a.Ka);Atomics.store(u(),\\nk+19,h);Atomics.store(u(),k+26,a.Ka);Atomics.store(u(),k+28,h);Atomics.store(u(),k+29,a.detached);c=hb()+40;Atomics.store(u(),k+43,c);b.Ea=e;var m={cmd:"run",start_routine:a.Bb,arg:a.Ma,threadInfoStruct:a.Sa,stackBase:a.Ja,stackSize:a.Ka};b.Oa=function(){m.time=performance.now();b.postMessage(m,a.Ib)};b.loaded&&(b.Oa(),delete b.Oa);return 0}\\nfunction ib(a,b,c){if(0>=a||a>d().length||a&1)return-28;if(la){if(Atomics.load(t(),a>>2)!=b)return-6;var e=performance.now();c=e+c;for(Atomics.exchange(t(),T>>2,a);;){e=performance.now();if(e>c)return Atomics.exchange(t(),T>>2,0),-73;e=Atomics.exchange(t(),T>>2,0);if(0==e)break;Ya();if(Atomics.load(t(),a>>2)!=b)return-6;Atomics.exchange(t(),T>>2,a)}return 0}a=Atomics.wait(t(),a>>2,b,c);if("timed-out"===a)return-73;if("not-equal"===a)return-6;if("ok"===a)return 0;throw"Atomics.wait returned an unexpected value "+\\na;}function jb(){C||(qa||(qa={}),qa["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]||(qa["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]=1,F("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")))}\\nfunction kb(a,b){if(!a)return F("pthread_join attempted on a null thread pointer!"),71;if(D&&V()==a)return F("PThread "+a+" is attempting to join to itself!"),16;if(!D&&lb()==a)return F("Main thread "+a+" is attempting to join to itself!"),16;if(t()[a+12>>2>>>0]!==a)return F("pthread_join attempted on thread "+a+", which does not point to a valid thread, or does not exist anymore!"),71;if(Atomics.load(u(),a+64>>2))return F("Attempted to join thread "+a+", which was already detached!"),28;for(jb();;){var c=\\nAtomics.load(u(),a+0>>2);if(1==c)return c=Atomics.load(u(),a+4>>2),b&&(t()[b>>2>>>0]=c),Atomics.store(u(),a+64>>2,1),D?postMessage({cmd:"cleanupThread",thread:a}):Sa(a),0;mb();D||Ya();ib(a+0,c,D?100:1)}}var nb=[null,[],[]],ob={};function pb(a,b,c){return D?Y(3,1,a,b,c):0}function qb(a,b,c){return D?Y(4,1,a,b,c):0}function rb(a,b,c){if(D)return Y(5,1,a,b,c)}function sb(){if(D)return Y(6,1);I()}var tb=[];\\nfunction Y(a,b){for(var c=arguments.length-2,e=ub(),h=vb(8*c),k=h>>3,m=0;m<c;m++){var p=arguments[2+m];ea()[k+m>>>0]=p}c=wb(a,c,h,b);bb(e);return c}var xb=[],yb=[0,"undefined"!==typeof document?document:0,"undefined"!==typeof window?window:0];function zb(a){a=2<a?L(a):a;return yb[a]||("undefined"!==typeof document?document.querySelector(a):void 0)}\\nfunction Ab(a,b,c){var e=zb(a);if(!e)return-4;e.Ra&&(t()[e.Ra>>2>>>0]=b,t()[e.Ra+4>>2>>>0]=c);if(e.fb||!e.Nb)e.fb&&(e=e.fb),a=!1,e.Qa&&e.Qa.Xa&&(a=e.Qa.Xa.getParameter(2978),a=0===a[0]&&0===a[1]&&a[2]===e.width&&a[3]===e.height),e.width=b,e.height=c,a&&e.Qa.Xa.viewport(0,0,b,c);else{if(e.Ra){e=t()[e.Ra+8>>2>>>0];a=a?L(a):"";var h=ub(),k=vb(12),m=0;if(a){m=ya(a)+1;var p=N(m);xa(a,r(),p,m);m=p}t()[k>>2>>>0]=m;t()[k+4>>2>>>0]=b;t()[k+8>>2>>>0]=c;Bb(0,e,657457152,0,m,k);bb(h);return 1}return-4}return 0}\\nfunction Cb(a,b,c){return D?Y(7,1,a,b,c):Ab(a,b,c)}function Db(a){if(!J){try{a()}catch(b){if(b instanceof W)return;if("unwind"!==b)throw b&&"object"===typeof b&&b.stack&&F("exception thrown: "+[b,b.stack]),b;}if(D&&!Ha())try{D?Eb(K):$a(K)}catch(b){if(!(b instanceof W))throw b;}}}function Fb(a,b){a.eb||(a.eb=a.getContext,a.getContext=function(e,h){h=a.eb(e,h);return"webgl"==e==h instanceof WebGLRenderingContext?h:null});var c=a.getContext("webgl",b);return c?Gb(c,b):0}\\nfunction Gb(a,b){var c=N(8);t()[c+4>>2>>>0]=V();b={Rb:c,attributes:b,version:b.sb,Xa:a};a.canvas&&(a.canvas.Qa=b);return c}var Hb=["default","low-power","high-performance"],Ib={};\\nfunction Mb(){if(!Nb){var a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:ja||"./this.program"},b;for(b in Ib)void 0===Ib[b]?delete a[b]:a[b]=Ib[b];var c=[];for(b in a)c.push(b+"="+a[b]);Nb=c}return Nb}var Nb;\\nfunction Ob(a,b){if(D)return Y(8,1,a,b);var c=0;Mb().forEach(function(e,h){var k=b+c;h=t()[a+4*h>>2>>>0]=k;for(k=0;k<e.length;++k)d()[h++>>0>>>0]=e.charCodeAt(k);d()[h>>0>>>0]=0;c+=e.length+1});return 0}function Pb(a,b){if(D)return Y(9,1,a,b);var c=Mb();t()[a>>2>>>0]=c.length;var e=0;c.forEach(function(h){e+=h.length+1});t()[b>>2>>>0]=e;return 0}function Qb(a){return D?Y(10,1,a):0}function Rb(a,b,c,e){if(D)return Y(11,1,a,b,c,e);a=ob.Qb(a);b=ob.Ob(a,b,c);t()[e>>2>>>0]=b;return 0}\\nfunction Sb(a,b,c,e,h){if(D)return Y(12,1,a,b,c,e,h)}function Tb(a,b,c,e){if(D)return Y(13,1,a,b,c,e);for(var h=0,k=0;k<c;k++){for(var m=t()[b+8*k>>2>>>0],p=t()[b+(8*k+4)>>2>>>0],w=0;w<p;w++){var x=r()[m+w>>>0],z=nb[a];0===x||10===x?((1===a?pa:F)(wa(z,0)),z.length=0):z.push(x)}h+=p}t()[e>>2>>>0]=h;return 0}function Ub(a){return 0===a%4&&(0!==a%100||0===a%400)}function Vb(a,b){for(var c=0,e=0;e<=b;c+=a[e++]);return c}\\nvar Wb=[31,29,31,30,31,30,31,31,30,31,30,31],Xb=[31,28,31,30,31,30,31,31,30,31,30,31];function Yb(a,b){for(a=new Date(a.getTime());0<b;){var c=a.getMonth(),e=(Ub(a.getFullYear())?Wb:Xb)[c];if(b>e-a.getDate())b-=e-a.getDate()+1,a.setDate(1),11>c?a.setMonth(c+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+1));else{a.setDate(a.getDate()+b);break}}return a}\\nfunction Zb(a,b,c,e){function h(f,q,v){for(f="number"===typeof f?f.toString():f||"";f.length<q;)f=v[0]+f;return f}function k(f,q){return h(f,q,"0")}function m(f,q){function v(Jb){return 0>Jb?-1:0<Jb?1:0}var M;0===(M=v(f.getFullYear()-q.getFullYear()))&&0===(M=v(f.getMonth()-q.getMonth()))&&(M=v(f.getDate()-q.getDate()));return M}function p(f){switch(f.getDay()){case 0:return new Date(f.getFullYear()-1,11,29);case 1:return f;case 2:return new Date(f.getFullYear(),0,3);case 3:return new Date(f.getFullYear(),\\n0,2);case 4:return new Date(f.getFullYear(),0,1);case 5:return new Date(f.getFullYear()-1,11,31);case 6:return new Date(f.getFullYear()-1,11,30)}}function w(f){f=Yb(new Date(f.Da+1900,0,1),f.Wa);var q=new Date(f.getFullYear()+1,0,4),v=p(new Date(f.getFullYear(),0,4));q=p(q);return 0>=m(v,f)?0>=m(q,f)?f.getFullYear()+1:f.getFullYear():f.getFullYear()-1}var x=t()[e+40>>2>>>0];e={Gb:t()[e>>2>>>0],Fb:t()[e+4>>2>>>0],Ua:t()[e+8>>2>>>0],Pa:t()[e+12>>2>>>0],La:t()[e+16>>2>>>0],Da:t()[e+20>>2>>>0],Va:t()[e+\\n24>>2>>>0],Wa:t()[e+28>>2>>>0],Xb:t()[e+32>>2>>>0],Eb:t()[e+36>>2>>>0],Hb:x?L(x):""};c=L(c);x={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var z in x)c=c.replace(new RegExp(z,\\n"g"),x[z]);var Kb="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Lb="January February March April May June July August September October November December".split(" ");x={"%a":function(f){return Kb[f.Va].substring(0,3)},"%A":function(f){return Kb[f.Va]},"%b":function(f){return Lb[f.La].substring(0,3)},"%B":function(f){return Lb[f.La]},"%C":function(f){return k((f.Da+1900)/100|0,2)},"%d":function(f){return k(f.Pa,2)},"%e":function(f){return h(f.Pa,2," ")},"%g":function(f){return w(f).toString().substring(2)},\\n"%G":function(f){return w(f)},"%H":function(f){return k(f.Ua,2)},"%I":function(f){f=f.Ua;0==f?f=12:12<f&&(f-=12);return k(f,2)},"%j":function(f){return k(f.Pa+Vb(Ub(f.Da+1900)?Wb:Xb,f.La-1),3)},"%m":function(f){return k(f.La+1,2)},"%M":function(f){return k(f.Fb,2)},"%n":function(){return"\\\\n"},"%p":function(f){return 0<=f.Ua&&12>f.Ua?"AM":"PM"},"%S":function(f){return k(f.Gb,2)},"%t":function(){return"\\\\t"},"%u":function(f){return f.Va||7},"%U":function(f){var q=new Date(f.Da+1900,0,1),v=0===q.getDay()?\\nq:Yb(q,7-q.getDay());f=new Date(f.Da+1900,f.La,f.Pa);return 0>m(v,f)?k(Math.ceil((31-v.getDate()+(Vb(Ub(f.getFullYear())?Wb:Xb,f.getMonth()-1)-31)+f.getDate())/7),2):0===m(v,q)?"01":"00"},"%V":function(f){var q=new Date(f.Da+1901,0,4),v=p(new Date(f.Da+1900,0,4));q=p(q);var M=Yb(new Date(f.Da+1900,0,1),f.Wa);return 0>m(M,v)?"53":0>=m(q,M)?"01":k(Math.ceil((v.getFullYear()<f.Da+1900?f.Wa+32-v.getDate():f.Wa+1-v.getDate())/7),2)},"%w":function(f){return f.Va},"%W":function(f){var q=new Date(f.Da,0,\\n1),v=1===q.getDay()?q:Yb(q,0===q.getDay()?1:7-q.getDay()+1);f=new Date(f.Da+1900,f.La,f.Pa);return 0>m(v,f)?k(Math.ceil((31-v.getDate()+(Vb(Ub(f.getFullYear())?Wb:Xb,f.getMonth()-1)-31)+f.getDate())/7),2):0===m(v,q)?"01":"00"},"%y":function(f){return(f.Da+1900).toString().substring(2)},"%Y":function(f){return f.Da+1900},"%z":function(f){f=f.Eb;var q=0<=f;f=Math.abs(f)/60;return(q?"+":"-")+String("0000"+(f/60*100+f%60)).slice(-4)},"%Z":function(f){return f.Hb},"%%":function(){return"%"}};for(z in x)c.includes(z)&&\\n(c=c.replace(new RegExp(z,"g"),x[z](e)));z=$b(c);if(z.length>b)return 0;Aa(z,a);return z.length-1}var ac=[null,function(a,b){if(D)return Y(1,1,a,b)},X,pb,qb,rb,sb,Cb,Ob,Pb,Qb,Rb,Sb,Tb];function $b(a){var b=Array(ya(a)+1);xa(a,b,0,b.length);return b}\\nvar ec={e:function(a,b,c,e){I("Assertion failed: "+L(a)+", at: "+[b?L(b):"unknown filename",c,e?L(e):"unknown function"])},b:function(a){return N(a+16)+16},i:function(a,b){U.ab.push(function(){O.get(a)(b)})},c:function(a,b,c){(new db(a)).ob(b,c);eb++;throw a;},v:function(a,b){X();a=new Date(1E3*t()[a>>2>>>0]);t()[b>>2>>>0]=a.getSeconds();t()[b+4>>2>>>0]=a.getMinutes();t()[b+8>>2>>>0]=a.getHours();t()[b+12>>2>>>0]=a.getDate();t()[b+16>>2>>>0]=a.getMonth();t()[b+20>>2>>>0]=a.getFullYear()-1900;t()[b+\\n24>>2>>>0]=a.getDay();var c=new Date(a.getFullYear(),0,1),e=(a.getTime()-c.getTime())/864E5|0;t()[b+28>>2>>>0]=e;t()[b+36>>2>>>0]=-(60*a.getTimezoneOffset());e=(new Date(a.getFullYear(),6,1)).getTimezoneOffset();c=c.getTimezoneOffset();a=(e!=c&&a.getTimezoneOffset()==Math.min(c,e))|0;t()[b+32>>2>>>0]=a;a=t()[Z()+(a?4:0)>>2>>>0];t()[b+40>>2>>>0]=a;return b},E:function(a,b,c,e){if("undefined"===typeof SharedArrayBuffer)return F("Current environment does not support SharedArrayBuffer, pthreads are not available!"),\\n6;if(!a)return F("pthread_create called with a null thread pointer!"),28;var h=[];if(D&&0===h.length)return bc(687865856,a,b,c,e);var k=0,m=0;if(b&&-1!=b){var p=t()[b>>2>>>0];p+=81920;k=t()[b+8>>2>>>0];m=0!==t()[b+12>>2>>>0]}else p=2097152;(b=0==k)?k=cc(16,p):(k-=p,ta(0<k));for(var w=N(228),x=0;57>x;++x)u()[(w>>2)+x>>>0]=0;t()[a>>2>>>0]=w;t()[w+12>>2>>>0]=w;a=w+152;t()[a>>2>>>0]=a;c={Ja:k,Ka:p,Ya:b,detached:m,Bb:c,Sa:w,Ma:e,Ib:h};return D?(c.Mb="spawnThread",postMessage(c,h),0):Za(c)},C:function(a){return a?\\nt()[a+12>>2>>>0]!==a?(F("pthread_detach attempted on thread "+a+", which does not point to a valid thread, or does not exist anymore!"),71):Atomics.compareExchange(u(),a+64>>2,0,2)?28:0:(F("pthread_detach attempted on a null thread pointer!"),71)},B:function(a){D?U.ib(a):(U.gb(),$a(a));throw"unwind";},D:function(a,b){return kb(a,b)},k:pb,y:qb,z:rb,L:function(a,b){if(a==b)postMessage({cmd:"processQueuedMainThreadWork"});else if(D)postMessage({targetThread:a,cmd:"processThreadQueue"});else{a=(a=U.Fa[a])&&\\na.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1},j:sb,N:function(a,b){if(0===a)a=Date.now();else if(1===a||4===a)a=cb();else return t()[dc()>>2>>>0]=28,-1;t()[b>>2>>>0]=a/1E3|0;t()[b+4>>2>>>0]=a%1E3*1E6|0;return 0},o:function(a,b,c){tb.length=0;var e;for(c>>=2;e=r()[b++>>>0];)(e=105>e)&&c&1&&c++,tb.push(e?ea()[c++>>>1]:t()[c>>>0]),++c;return Qa[a].apply(null,tb)},w:jb,h:function(){},f:ib,g:Ra,d:cb,q:function(a,b,c){r().copyWithin(a>>>0,b>>>0,b+c>>>0)},I:function(a,b,c){xb.length=\\nb;c>>=3;for(var e=0;e<b;e++)xb[e]=ea()[c+e>>>0];return(0>a?Qa[-a-1]:ac[a]).apply(null,xb)},r:function(a){var b=r().length;a>>>=0;if(a<=b||4294901760<a)return!1;for(var c=1;4>=c;c*=2){var e=b*(1+.2/c);e=Math.min(e,a+100663296);e=Math.max(a,e);0<e%65536&&(e+=65536-e%65536);a:{try{g.grow(Math.min(4294901760,e)-l.byteLength+65535>>>16);n(g.buffer);var h=1;break a}catch(k){}h=void 0}if(h)return!0}return!1},J:function(a,b,c){return zb(a)?Ab(a,b,c):Cb(a,b,c)},n:function(){},H:function(a,b,c){Ga+=1;return setTimeout(function(){--Ga;\\nDb(function(){O.get(a)(c)})},b)},K:function(a,b){b>>=2;var c=t()[b+6>>>0];b={alpha:!!t()[b>>>0],depth:!!t()[b+1>>>0],stencil:!!t()[b+2>>>0],antialias:!!t()[b+3>>>0],premultipliedAlpha:!!t()[b+4>>>0],preserveDrawingBuffer:!!t()[b+5>>>0],powerPreference:Hb[c],failIfMajorPerformanceCaveat:!!t()[b+7>>>0],sb:t()[b+8>>>0],Tb:t()[b+9>>>0],Pb:t()[b+10>>>0],mb:t()[b+11>>>0],Ub:t()[b+12>>>0],Vb:t()[b+13>>>0]};a=zb(a);return!a||b.mb?0:Fb(a,b)},t:Ob,u:Pb,m:Qb,A:Rb,p:Sb,l:Tb,M:function(a){var b=Date.now();t()[a>>\\n2>>>0]=b/1E3|0;t()[a+4>>2>>>0]=b%1E3*1E3|0;return 0},G:function(){U.pb()},a:g||y.wasmMemory,x:function(a){X();var b=new Date(t()[a+20>>2>>>0]+1900,t()[a+16>>2>>>0],t()[a+12>>2>>>0],t()[a+8>>2>>>0],t()[a+4>>2>>>0],t()[a>>2>>>0],0),c=t()[a+32>>2>>>0],e=b.getTimezoneOffset(),h=new Date(b.getFullYear(),0,1),k=(new Date(b.getFullYear(),6,1)).getTimezoneOffset(),m=h.getTimezoneOffset(),p=Math.min(m,k);0>c?t()[a+32>>2>>>0]=Number(k!=m&&p==e):0<c!=(p==e)&&(k=Math.max(m,k),b.setTime(b.getTime()+6E4*((0<c?\\np:k)-e)));t()[a+24>>2>>>0]=b.getDay();c=(b.getTime()-h.getTime())/864E5|0;t()[a+28>>2>>>0]=c;t()[a>>2>>>0]=b.getSeconds();t()[a+4>>2>>>0]=b.getMinutes();t()[a+8>>2>>>0]=b.getHours();t()[a+12>>2>>>0]=b.getDate();t()[a+16>>2>>>0]=b.getMonth();return b.getTime()/1E3|0},s:function(a,b,c,e){return Zb(a,b,c,e)},F:function(a){var b=Date.now()/1E3|0;a&&(t()[a>>2>>>0]=b);return b}};\\n(function(){function a(h,k){h=h.exports;var m={},p;for(p in h){var w=h[p];m[p]="function"===typeof w?Ma(w):w}y.asm=m;O=y.asm.da;Da.unshift(y.asm.O);Na();U.bb.push(y.asm.ia);sa=k;D||(P--,y.monitorRunDependencies&&y.monitorRunDependencies(P),0==P&&(null!==Ja&&(clearInterval(Ja),Ja=null),Q&&(k=Q,Q=null,k())))}function b(h){a(h.instance,h.module)}function c(h){return Pa().then(function(k){return WebAssembly.instantiate(k,e)}).then(h,function(k){F("failed to asynchronously prepare wasm: "+k);I(k)})}var e=\\n{a:ec};D||(P++,y.monitorRunDependencies&&y.monitorRunDependencies(P));if(y.instantiateWasm)try{return y.instantiateWasm(e,a)}catch(h){return F("Module.instantiateWasm callback failed with error: "+h),!1}(function(){return H||"function"!==typeof WebAssembly.instantiateStreaming||Ka()||"function"!==typeof fetch?c(b):fetch(R,{credentials:"same-origin"}).then(function(h){return WebAssembly.instantiateStreaming(h,e).then(b,function(k){F("wasm streaming compile failed: "+k);F("falling back to ArrayBuffer instantiation");\\nreturn c(b)})})})().catch(ia);return{}})();y.___wasm_call_ctors=function(){return(y.___wasm_call_ctors=y.asm.O).apply(null,arguments)};y._bwpInit=function(){return(y._bwpInit=y.asm.P).apply(null,arguments)};y._bwpUninit=function(){return(y._bwpUninit=y.asm.Q).apply(null,arguments)};y._bwpOpen=function(){return(y._bwpOpen=y.asm.R).apply(null,arguments)};y._bwpMainProc=function(){return(y._bwpMainProc=y.asm.S).apply(null,arguments)};\\ny._bwpFillBuff=function(){return(y._bwpFillBuff=y.asm.T).apply(null,arguments)};y._bwpSetAudio=function(){return(y._bwpSetAudio=y.asm.U).apply(null,arguments)};y._bwpSeek=function(){return(y._bwpSeek=y.asm.V).apply(null,arguments)};y._bwpRange=function(){return(y._bwpRange=y.asm.W).apply(null,arguments)};y._bwpPlay=function(){return(y._bwpPlay=y.asm.X).apply(null,arguments)};y._bwpPause=function(){return(y._bwpPause=y.asm.Y).apply(null,arguments)};\\ny._bwpSpeed=function(){return(y._bwpSpeed=y.asm.Z).apply(null,arguments)};y._bwpFlush=function(){return(y._bwpFlush=y.asm._).apply(null,arguments)};y._bwpGetTime=function(){return(y._bwpGetTime=y.asm.$).apply(null,arguments)};y._bwpQuality=function(){return(y._bwpQuality=y.asm.aa).apply(null,arguments)};y._bwpEnableVideo=function(){return(y._bwpEnableVideo=y.asm.ba).apply(null,arguments)};y._main=function(){return(y._main=y.asm.ca).apply(null,arguments)};\\nvar N=y._malloc=function(){return(N=y._malloc=y.asm.ea).apply(null,arguments)},Wa=y._free=function(){return(Wa=y._free=y.asm.fa).apply(null,arguments)},V=y._pthread_self=function(){return(V=y._pthread_self=y.asm.ga).apply(null,arguments)},dc=y.___errno_location=function(){return(dc=y.___errno_location=y.asm.ha).apply(null,arguments)};y._emscripten_tls_init=function(){return(y._emscripten_tls_init=y.asm.ia).apply(null,arguments)};\\ny._emscripten_current_thread_process_queued_calls=function(){return(y._emscripten_current_thread_process_queued_calls=y.asm.ja).apply(null,arguments)};\\nvar Ua=y._emscripten_register_main_browser_thread_id=function(){return(Ua=y._emscripten_register_main_browser_thread_id=y.asm.ka).apply(null,arguments)},lb=y._emscripten_main_browser_thread_id=function(){return(lb=y._emscripten_main_browser_thread_id=y.asm.la).apply(null,arguments)},bc=y._emscripten_sync_run_in_main_thread_4=function(){return(bc=y._emscripten_sync_run_in_main_thread_4=y.asm.ma).apply(null,arguments)},Ya=y._emscripten_main_thread_process_queued_calls=function(){return(Ya=y._emscripten_main_thread_process_queued_calls=\\ny.asm.na).apply(null,arguments)},wb=y._emscripten_run_in_main_runtime_thread_js=function(){return(wb=y._emscripten_run_in_main_runtime_thread_js=y.asm.oa).apply(null,arguments)},Bb=y.__emscripten_call_on_thread=function(){return(Bb=y.__emscripten_call_on_thread=y.asm.pa).apply(null,arguments)},mb=y._pthread_testcancel=function(){return(mb=y._pthread_testcancel=y.asm.qa).apply(null,arguments)},Eb=y._pthread_exit=function(){return(Eb=y._pthread_exit=y.asm.ra).apply(null,arguments)},Ta=y.__emscripten_thread_init=\\nfunction(){return(Ta=y.__emscripten_thread_init=y.asm.sa).apply(null,arguments)},hb=y._emscripten_get_global_libc=function(){return(hb=y._emscripten_get_global_libc=y.asm.ta).apply(null,arguments)},Va=y.___pthread_tsd_run_dtors=function(){return(Va=y.___pthread_tsd_run_dtors=y.asm.ua).apply(null,arguments)},Z=y.__get_tzname=function(){return(Z=y.__get_tzname=y.asm.va).apply(null,arguments)},gb=y.__get_daylight=function(){return(gb=y.__get_daylight=y.asm.wa).apply(null,arguments)},fb=y.__get_timezone=\\nfunction(){return(fb=y.__get_timezone=y.asm.xa).apply(null,arguments)},ub=y.stackSave=function(){return(ub=y.stackSave=y.asm.ya).apply(null,arguments)},bb=y.stackRestore=function(){return(bb=y.stackRestore=y.asm.za).apply(null,arguments)},vb=y.stackAlloc=function(){return(vb=y.stackAlloc=y.asm.Aa).apply(null,arguments)},ab=y._emscripten_stack_set_limits=function(){return(ab=y._emscripten_stack_set_limits=y.asm.Ba).apply(null,arguments)},cc=y._memalign=function(){return(cc=y._memalign=y.asm.Ca).apply(null,\\narguments)},Xa=y.__emscripten_allow_main_runtime_queued_calls=101652,T=y.__emscripten_main_thread_futex=141860;\\ny.addFunction=function(a,b){if(!G){G=new WeakMap;for(var c=0;c<O.length;c++){var e=O.get(c);e&&G.set(e,c)}}if(G.has(a))a=G.get(a);else{if(ra.length)c=ra.pop();else{try{O.grow(1)}catch(p){if(!(p instanceof RangeError))throw p;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.";}c=O.length-1}try{O.set(c,a)}catch(p){if(!(p instanceof TypeError))throw p;if("function"===typeof WebAssembly.Function){var h={i:"i32",j:"i64",f:"f32",d:"f64"},k={parameters:[],results:"v"==b[0]?[]:[h[b[0]]]};for(e=1;e<\\nb.length;++e)k.parameters.push(h[b[e]]);b=new WebAssembly.Function(k,a)}else{h=[1,0,1,96];k=b.slice(0,1);b=b.slice(1);var m={i:127,j:126,f:125,d:124};h.push(b.length);for(e=0;e<b.length;++e)h.push(m[b[e]]);"v"==k?h.push(0):h=h.concat([1,m[k]]);h[1]=h.length-2;b=new Uint8Array([0,97,115,109,1,0,0,0].concat(h,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0]));b=new WebAssembly.Module(b);b=(new WebAssembly.Instance(b,{e:{f:a}})).exports.f}O.set(c,b)}G.set(a,c);a=c}return a};y.keepRuntimeAlive=Ha;y.PThread=U;\\ny.PThread=U;y.wasmMemory=g;y.ExitStatus=W;var fc;function W(a){this.name="ExitStatus";this.message="Program terminated with exit("+a+")";this.status=a}Q=function gc(){fc||hc();fc||(Q=gc)};\\nfunction hc(){function a(){if(!fc&&(fc=!0,y.calledRun=!0,!J)){D||S(Da);D||S(Ea);ha(y);if(y.onRuntimeInitialized)y.onRuntimeInitialized();if(ic){var b=y._main;try{La+=2;var c=b(0,0);$a(c,!0)}catch(e){e instanceof W||"unwind"==e||((b=e)&&"object"===typeof e&&e.stack&&(b=[e,e.stack]),F("exception thrown: "+b),ka(1,e))}finally{La-=2}}if(!D){if(y.postRun)for("function"==typeof y.postRun&&(y.postRun=[y.postRun]);y.postRun.length;)b=y.postRun.shift(),Fa.unshift(b);S(Fa)}}}if(!(0<P))if(D)ha(y),D||S(Da),postMessage({cmd:"loaded"});\\nelse{if(!D){if(y.preRun)for("function"==typeof y.preRun&&(y.preRun=[y.preRun]);y.preRun.length;)Ia();S(Ca)}0<P||(y.setStatus?(y.setStatus("Running..."),setTimeout(function(){setTimeout(function(){y.setStatus("")},1);a()},1)):a())}}y.run=hc;function $a(a,b){K=a;if(!b&&D)throw postMessage({cmd:"exitProcess",returnCode:a}),new W(a);Ha()||U.$a();K=a;if(!Ha()){U.$a();if(y.onExit)y.onExit(a);J=!0}ka(a,new W(a))}if(y.preInit)for("function"==typeof y.preInit&&(y.preInit=[y.preInit]);0<y.preInit.length;)y.preInit.pop()();\\nvar ic=!0;y.noInitialRun&&(ic=!1);D&&(noExitRuntime=!1,U.qb());hc();y.terminateAllThreads=U.$a;\\n\\n\\n  return WasmPlayerModuleFactory.ready\\n}\\n);\\n})();\\nif (typeof exports === \\\'object\\\' && typeof module === \\\'object\\\')\\n  module.exports = WasmPlayerModuleFactory;\\nelse if (typeof define === \\\'function\\\' && define[\\\'amd\\\'])\\n  define([], function() { return WasmPlayerModuleFactory; });\\nelse if (typeof exports === \\\'object\\\')\\n  exports["WasmPlayerModuleFactory"] = WasmPlayerModuleFactory;\\n\'},501:function(e){"use strict";e.exports=\'"use strict";var Module={};function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=function(info,receiveInstance){var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};function moduleLoaded(){}self.onmessage=function(e){try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmPlayerModuleFactory(Module).then(function(instance){Module=instance;moduleLoaded()})}else if(e.data.cmd==="objectTransfer"){Module["PThread"].receiveObjectTransfer(e.data)}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,/*isMainBrowserThread=*/0,/*isMainRuntimeThread=*/0);var max=e.data.stackBase;var top=e.data.stackBase+e.data.stackSize;Module["establishStackSpace"](top,max);Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInit();try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(Module["keepRuntimeAlive"]()){Module["PThread"].setExitStatus(result)}else{Module["PThread"].threadExit(result)}}catch(ex){if(ex==="Canceled!"){Module["PThread"].threadCancel()}else if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["PThread"].threadExit(ex.status)}}else{Module["PThread"].threadExit(-2);throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["PThread"].threadCancel()}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);throw ex}};\\n\'},757:function(e,t,r){e.exports=r(666)},666:function(e){var t=function(e){"use strict";var t,r=Object.prototype,a=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var n=t&&t.prototype instanceof p?t:p,i=Object.create(n.prototype),o=new O(a||[]);return i._invoke=function(e,t,r){var a=f;return function(n,i){if(a===d)throw new Error("Generator is already running");if(a===b){if("throw"===n)throw i;return M()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var s=R(o,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=b,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=d;var u=l(e,t,r);if("normal"===u.type){if(a=r.done?b:h,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=b,r.method="throw",r.arg=u.arg)}}}(e,r,o),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",h="suspendedYield",d="executing",b="completed",m={};function p(){}function y(){}function _(){}var g={};g[i]=function(){return this};var v=Object.getPrototypeOf,w=v&&v(v(x([])));w&&w!==r&&a.call(w,i)&&(g=w);var E=_.prototype=p.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(n,i,o,s){var u=l(e[n],e,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&a.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(f).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var n;this._invoke=function(e,a){function i(){return new t((function(t,n){r(e,a,t,n)}))}return n=n?n.then(i,i):i()}}function R(e,r){var a=e.iterator[r.method];if(a===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,R(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a \'throw\' method")}return m}var n=l(a,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,m;var i=n.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function x(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:M}}function M(){return{value:t,done:!0}}return y.prototype=E.constructor=_,_.constructor=y,y.displayName=u(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},A(T.prototype),T.prototype[o]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new T(c(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(E),u(E,s,"Generator"),E[i]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},e.values=x,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;k(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:x(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}},t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=function t(){e(this,t)};t(a,"INIT","init"),t(a,"RELOAD","reload"),t(a,"DESTROY","destroy"),t(a,"AUDIO_RENDER_INIT_DONE","audio_render_init_done"),t(a,"PLAY","play"),t(a,"PAUSE","pause"),t(a,"SEEK","seek"),t(a,"PLAYBACK_RATE","playback_rate"),t(a,"PLAYBACK_QUALITY","playback_quality"),t(a,"GET_PLAYBACK_QUALITY","get_playback_quality"),t(a,"RESIZE","resize"),t(a,"FIRST_FRAME","first_frame"),t(a,"SEEKED","seeked"),t(a,"BUFFER_FLUSHED","buffer_flushed"),t(a,"PLAY_END","play_end"),t(a,"SET_AUDIO_TIME","set_audio_time"),t(a,"SET_DECODE_MODE","set_decode_mode"),t(a,"SET_APPEND_WINDOW","set_append_window"),t(a,"SET_PIP_MODE","set_pip_mode"),t(a,"END_OF_STREAM","end_of_stream"),t(a,"RESET_OUTOFSYNC_FRAME_COUNT","reset_outofsync_frame_count"),t(a,"REDRAW_LAST_FRAME","redraw_last_frame"),t(a,"OPENED","opened"),t(a,"TIMEUPDATE","timeupdate"),t(a,"FILL_BUFFER","fill_buffer"),t(a,"RENDER_AUDIO","render_audio"),t(a,"FALLBACK","fallback"),t(a,"LOG","log"),t(a,"ERROR","error"),t(a,"PERFORMANCE","performance");var n,i=a;function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}!function(e){e[e.SEEK_KEY=0]="SEEK_KEY",e[e.SEEK_POS=1]="SEEK_POS"}(n||(n={}));var u=function t(){e(this,t)};t(u,"BWP_SRC_TYPE_VIDEO",1),t(u,"BWP_SRC_TYPE_AUDIO",2),t(u,"BWP_SRC_TYPE_DASH",8),t(u,"BWP_DATA_FLAG_FORMAT",2),t(u,"BWP_MSG_OPEN_DONE",17),t(u,"BWP_MSG_PLAY_POS",49),t(u,"BWP_MSG_PLAY_COMPLETE",66),t(u,"BWP_MSG_PLAY_QULITY",67),t(u,"BWP_MSG_SEEK_DONE",33),t(u,"BWP_DATA_FLAG_NEWPOS",1),t(u,"BWP_LOG_LEVEL_DEBUG",4),t(u,"BWP_LOG_LEVEL_ERR",1);var c=u,l=r(757),f=r.n(l);function h(e,t,r,a,n,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(a,n)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){h(i,a,n,o,s,"next",e)}function s(e){h(i,a,n,o,s,"throw",e)}o(void 0)}))}}function b(e,t,r,a){return m.apply(this,arguments)}function m(){return(m=d(f().mark((function e(t,r,a,n){var i,o,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{credentials:"same-origin"});case 2:if((i=e.sent).ok){e.next=5;break}throw new Error("failed to load wasm file from network");case 5:return e.next=7,i.arrayBuffer();case 7:return o=e.sent,e.next=10,t.put(r,o);case 10:return e.next=12,WebAssembly.instantiate(o,a);case 12:return s=e.sent,e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=d(f().mark((function e(t,r,a,n){var i,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.get(r);case 3:if(o=e.sent){e.next=6;break}throw new Error("get wasm from indexedDB failed");case 6:return e.next=8,WebAssembly.instantiate(o,a);case 8:i=e.sent,e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(0),!n){e.next=19;break}return e.next=16,b(t,r,a,n);case 16:i=e.sent,e.next=20;break;case 19:throw e.t0;case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var y=function t(){e(this,t)};t(y,"WASM_PLAYER_ERROR",7e3),t(y,"CORE_PLAYER_LOAD_ERROR",7001),t(y,"CORE_PLAYER_MODULE_LOAD_TIMEOUT",7002),t(y,"CORE_PLAYER_EXCEPTION",7003),t(y,"WASM_MEMORY_MALLOC_ERROR",7004),t(y,"CORE_PLAYER_ADD_FUNCTION_ERROR",7005),t(y,"AUDIO_RENDER_ERROR",7007),t(y,"AUDIO_CHANNELS_NOT_SUPPORT",7008),t(y,"TRIGGER_CANPLAY_ERROR",7009),t(y,"OUT_OF_SYNC",7013);var _=y;function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function v(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w,E,A,T,R,D,k,O={alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1,powerPreference:"low-power"},x=function(){function r(a,n){var i=this;if(e(this,r),t(this,"width",void 0),t(this,"height",void 0),t(this,"canvas",void 0),t(this,"gl",void 0),t(this,"texCoordBuffer",void 0),t(this,"textureCoordAttribute",void 0),t(this,"yTexture",void 0),t(this,"uTexture",void 0),t(this,"vTexture",void 0),t(this,"lastFrameData",void 0),t(this,"isContextLost",void 0),t(this,"webglcontextlostHandler",(function(e){e.preventDefault(),console.warn("[VideoRenderer] webgl context lost"),i.isContextLost=!0})),t(this,"webglcontextrestoredHandler",(function(e){e.preventDefault(),console.warn("[VideoRenderer] webgl context restored"),i.clear(),i.initGL(),i.isContextLost=!1})),this.canvas=a,this.texCoordBuffer=null,this.gl=this.canvas.getContext("webgl",n||O),this.isContextLost=!1,!this.gl)throw new Error("[VideoRender] WebGL not supported.");this.initGL(),this.initEventListener()}return s(r,[{key:"initGL",value:function(){var e=this.gl;e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.pixelStorei(e.UNPACK_ALIGNMENT,1);var t=this.compileShader("\\n    attribute mediump vec4 aVertexPosition;\\n    attribute vec2 aTextureCoord;\\n    varying highp vec2 vTextureCoord;\\n    void main() {\\n        gl_Position = aVertexPosition;\\n        vTextureCoord = aTextureCoord;\\n    }\\n",e.VERTEX_SHADER),r=this.compileShader("\\n    precision mediump float;\\n    varying lowp vec2 vTextureCoord;\\n    uniform sampler2D YTexture;\\n    uniform sampler2D UTexture;\\n    uniform sampler2D VTexture;\\n\\n    const vec3 offset = vec3(-0.0627451017, -0.501960814, -0.501960814);\\n\\n    const mat3 YUV2RGB = mat3(\\n        1.1644,  1.1644,   1.1644,\\n        0,      -0.3918,   2.0172,\\n        1.596,  -0.813,    0\\n    );\\n\\n    void main()\\n    {\\n        mediump vec3 yuv;\\n        lowp vec3 rgb;\\n\\n        yuv.x = texture2D(YTexture, vTextureCoord).r;\\n        yuv.y = texture2D(UTexture, vTextureCoord).r;\\n        yuv.z = texture2D(VTexture, vTextureCoord).r;\\n\\n        yuv += offset;\\n        rgb = YUV2RGB * yuv;\\n\\n        gl_FragColor = vec4(rgb, 1);\\n    }\\n",e.FRAGMENT_SHADER),a=this.createProgram(t,r),n=e.getAttribLocation(a,"aVertexPosition");e.enableVertexAttribArray(n),this.textureCoordAttribute=e.getAttribLocation(a,"aTextureCoord"),e.enableVertexAttribArray(this.textureCoordAttribute);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),e.STATIC_DRAW),e.vertexAttribPointer(n,3,e.FLOAT,!1,0,0),this.texCoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW),e.vertexAttribPointer(this.textureCoordAttribute,2,e.FLOAT,!1,0,0),this.yTexture=this.createTexture(),this.uTexture=this.createTexture(),this.vTexture=this.createTexture(),this.bindTexture(this.yTexture,a,"YTexture",0),this.bindTexture(this.uTexture,a,"UTexture",1),this.bindTexture(this.vTexture,a,"VTexture",2)}},{key:"renderFrame",value:function(e,t,r,a,n,i,o){if(!this.gl)throw new Error("[VideoRender] Render frame failed due to WebGL not supported.");if(!this.isContextLost){var s=this.gl;this.width===i&&this.height===o||(this.width=i,this.height=o,this.uploadTexture(this.yTexture,t,o,null),this.uploadTexture(this.uTexture,n,o/2,null),this.uploadTexture(this.vTexture,n,o/2,null),this.updateVideoSize(i,o,t)),this.uploadTexture(this.yTexture,t,o,e,!0),this.uploadTexture(this.uTexture,n,o/2,r,!0),this.uploadTexture(this.vTexture,n,o/2,a,!0),s.drawArrays(s.TRIANGLE_STRIP,0,4),this.lastFrameData=null,this.lastFrameData=[e,t,r,a,n,i,o]}}},{key:"redrawLastFrame",value:function(){this.lastFrameData&&this.renderFrame.apply(this,v(this.lastFrameData))}},{key:"getLastFrameData",value:function(){return this.lastFrameData}},{key:"clear",value:function(){var e=this.gl;e.viewport(0,0,this.canvas.width,this.canvas.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.width=0,this.height=0}},{key:"destroy",value:function(){this.lastFrameData=null,this.uninitEventListener()}},{key:"compileShader",value:function(e,t){var r=this.gl,a=r.createShader(t);if(r.shaderSource(a,e),r.compileShader(a),!r.getShaderParameter(a,r.COMPILE_STATUS))throw r.deleteShader(a),console.error(r.getShaderInfoLog(a)),new Error("[VideoRender] could not compile shader");return a}},{key:"createProgram",value:function(e,t){var r=this.gl,a=r.createProgram();if(r.attachShader(a,e),r.attachShader(a,t),r.linkProgram(a),r.useProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw console.error(r.getProgramInfoLog(a)),new Error("[VideoRender] Shader link failed.");return a}},{key:"createTexture",value:function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}},{key:"bindTexture",value:function(e,t,r,a){var n=this.gl;n.activeTexture([n.TEXTURE0,n.TEXTURE1,n.TEXTURE2][a]),n.bindTexture(n.TEXTURE_2D,e),n.uniform1i(n.getUniformLocation(t,r),a)}},{key:"uploadTexture",value:function(e,t,r,a,n){var i=this.gl;i.bindTexture(i.TEXTURE_2D,e),n?i.texSubImage2D(i.TEXTURE_2D,0,0,0,t,r,i.LUMINANCE,i.UNSIGNED_BYTE,a):i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,t,r,0,i.LUMINANCE,i.UNSIGNED_BYTE,a)}},{key:"updateVideoSize",value:function(e,t,r){var a=this.gl;if(r>0){var n=new Float32Array([1,0,0,0,1,1,0,1]),i=1*e/r;n[0]=i,n[4]=i,a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffer),a.bufferData(a.ARRAY_BUFFER,n,a.STATIC_DRAW),a.vertexAttribPointer(this.textureCoordAttribute,2,a.FLOAT,!1,0,0)}a.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"initEventListener",value:function(){this.canvas.addEventListener("webglcontextlost",this.webglcontextlostHandler),this.canvas.addEventListener("webglcontextrestored",this.webglcontextrestoredHandler)}},{key:"uninitEventListener",value:function(){this.canvas.removeEventListener("webglcontextlost",this.webglcontextlostHandler),this.canvas.removeEventListener("webglcontextrestored",this.webglcontextrestoredHandler)}}]),r}();!function(e){e.CLOSED="closed",e.OPEN="open",e.ENDED="ended"}(w||(w={})),function(e){e.NETWORK="network",e.DECODE="decode"}(E||(E={})),function(e){e[e.NETWORK_EMPTY=0]="NETWORK_EMPTY",e[e.NETWORK_IDLE=1]="NETWORK_IDLE",e[e.NETWORK_LOADING=2]="NETWORK_LOADING",e[e.NETWORK_NO_SOURCE=3]="NETWORK_NO_SOURCE"}(A||(A={})),function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(T||(T={})),function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(R||(R={})),function(e){e.SEGMENTS="segments",e.SEQUENCE="sequence"}(D||(D={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.MIX="mix"}(k||(k={}));var M=function(){var e={};return"undefined"!=typeof window&&(e=window),"undefined"!=typeof self&&(e=self),e},S=function(){function r(a,n){e(this,r),t(this,"dbName",void 0),t(this,"storeName",void 0),t(this,"dbPromise",void 0),this.dbName=a,this.storeName=n,this.initDB()}var a,n,i,o,u;return s(r,[{key:"initDB",value:function(e){var t=this;if(!M().indexedDB)throw new Error("Not support indexedDB!");var r=indexedDB.open(this.dbName,e);this.dbPromise=new Promise((function(e,a){r.onsuccess=function(){e(r.result)},r.onupgradeneeded=function(){r.result.objectStoreNames.contains(t.storeName)||r.result.createObjectStore(t.storeName)},r.onerror=function(e){a(e)}}))}},{key:"getObjectStore",value:(u=d(f().mark((function e(t){var r,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbPromise;case 2:return r=e.sent,a=r.transaction(this.storeName,t),e.abrupt("return",a.objectStore(this.storeName));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"get",value:(o=d(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readonly");case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,a){var n=r.get(t);n.onsuccess=function(){e(n.result)},n.onerror=a})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"put",value:(i=d(f().mark((function e(t,r){var a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return a=e.sent,e.abrupt("return",new Promise((function(e,n){var i=a.put(r,t);i.onsuccess=function(){e(i.result)},i.onerror=n})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"delete",value:(n=d(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return r=e.sent,e.abrupt("return",r.delete(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"clear",value:(a=d(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return t=e.sent,e.abrupt("return",t.clear());case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}],[{key:"isSupported",value:function(){return!!M().indexedDB}}]),r}();var P,F,U="1"===(null===(P=M().localStorage)||void 0===P?void 0:P.getItem("_bwphevc_debug_"))||!1;!function(e){e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(F||(F={}));var L=function(){function t(){e(this,t)}return s(t,[{key:"proxyLog",value:function(e,r){var a;U&&(a=console)[e].apply(a,["[".concat(+new Date-t.startTime,"]")].concat(v(r)))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(F.INFO,t)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(F.TRACE,t)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(F.DEBUG,t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(F.WARN,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.proxyLog(F.ERROR,t)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t,t.startTime=+new Date),t.instance}}]),t}();t(L,"instance",void 0),t(L,"startTime",void 0);var I,C=r(501),N=r(157),B=function(){function r(a,n,o){var s=this,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e(this,r),t(this,"TAG","[BwpCorePlayer]"),t(this,"BASE_DELAY_TIME",80),t(this,"MAX_DELAY_TIME",800),t(this,"MAX_DELAY_FRAME_COUNT",170),t(this,"ctx",void 0),t(this,"renderCanvas",void 0),t(this,"logStartTime",void 0),t(this,"width",void 0),t(this,"height",void 0),t(this,"currentTime",void 0),t(this,"buffFlushFlag",void 0),t(this,"videoRenderer",void 0),t(this,"audioChannels",void 0),t(this,"indexedDBUtils",void 0),t(this,"glueJsUrl",void 0),t(this,"pthreadJsUrl",void 0),t(this,"wasmPlayerModule",void 0),t(this,"wasmMemory",void 0),t(this,"inputBuffer",void 0),t(this,"inputBufferSize",void 0),t(this,"fps",void 0),t(this,"totalVideoFrames",void 0),t(this,"droppedVideoFrames",void 0),t(this,"outOfSyncFrameCount",void 0),t(this,"syncTimer",void 0),t(this,"hasFirstFrame",void 0),t(this,"isSeeking",void 0),t(this,"isAfterSeekAudioFragment",void 0),t(this,"isAfterSeekVideoFragment",void 0),t(this,"isPipMode",void 0),t(this,"isDebug",void 0),t(this,"isDestroy",void 0),t(this,"isReadyToRelegation",void 0),t(this,"isCorePlayerOpened",void 0),t(this,"msgHandler",(function(e,t,r,a,n,o){switch(t){case c.BWP_MSG_OPEN_DONE:s.isCorePlayerOpened=!0,s.sendMsg(i.OPENED,{glueJsUrl:s.glueJsUrl,pthreadJsUrl:s.pthreadJsUrl});break;case c.BWP_MSG_PLAY_POS:if(!s.isCorePlayerOpened)return;var u=r,l=s.currentTime;s.currentTime=u,l!==u&&s.sendMsg(i.TIMEUPDATE,{time:u});break;case c.BWP_MSG_SEEK_DONE:s.isSeeking=!1,s.triggerSeekedEvent();break;case c.BWP_MSG_PLAY_COMPLETE:s.log(F.WARN,"[play] [complete] msg"),s.sendMsg(i.PLAY_END);break;case c.BWP_MSG_PLAY_QULITY:s.totalVideoFrames=r,s.droppedVideoFrames=a,s.fps=n/100}})),t(this,"videoRenderHandler",(function(e,t,r,a,n,o,u,c){if(t||r===s.width&&o===s.height||(0!=s.width&&0!=s.height&&s.sendMsg(i.RESIZE),s.width=r,s.height=o,s.renderCanvas.width=u,s.renderCanvas.height=c,s.log(F.WARN,"init video size, width: ".concat(r,", height: ").concat(s.height,",")+" displayWidth: ".concat(u,", displayHeight: ").concat(c))),t){s.isPipMode&&requestAnimationFrame((function(){}));var l=s.height*r,f=s.height*o/2,h=s.wasmMemory.buffer,d=new Uint8Array(h,t,l),b=new Uint8Array(h,a,f),m=new Uint8Array(h,n,f);s.videoRenderer.renderFrame(d,r,b,m,o,s.width,s.height),s.hasFirstFrame||(s.hasFirstFrame=!0,s.sendMsg(i.FIRST_FRAME));var p=s.currentTime-u;if(p>s.BASE_DELAY_TIME&&!s.isReadyToRelegation&&p>s.MAX_DELAY_TIME){if(s.outOfSyncFrameCount+=1,s.outOfSyncFrameCount<s.MAX_DELAY_FRAME_COUNT)return;s.isReadyToRelegation=!0;var y="Out of sync > 800ms, delay: ".concat(p,", currentTime: ").concat(s.currentTime,",")+" frameTime: ".concat(u,", outOfFrameCount: ").concat(s.outOfSyncFrameCount);s.log(F.WARN,y),s.sendMsg(i.FALLBACK,{details:y})}}})),t(this,"audioRenderHandler",(function(e,t,r,a,n){if(n===c.BWP_DATA_FLAG_FORMAT&&(s.log(F.WARN,"core player audio init channel is ".concat(a)),1===a||2===a?s.audioChannels=a:s.throwError(_.AUDIO_CHANNELS_NOT_SUPPORT,"Audio channels not support(>2)")),0===n){var o=new Uint8Array(s.wasmPlayerModule.HEAPU8.subarray(t,t+r));s.sendMsg(i.RENDER_AUDIO,{data:o.buffer,time:a,channels:s.audioChannels},[o.buffer])}})),t(this,"syncTimerHandler",(function(){s.wasmPlayerModule._bwpMainProc()})),t(this,"log",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s.isDebug&&s.sendMsg(i.LOG,{logLevel:e,msg:"[".concat(+new Date-s.logStartTime,"] ").concat(r?"":s.TAG+" ").concat(t)})})),t(this,"onAbortHandler",(function(e){s.throwError(_.CORE_PLAYER_EXCEPTION,e)})),t(this,"throwError",(function(e,t){s.isDestroy||(s.destroy(),s.sendMsg(i.ERROR,{errorCode:e,describe:t}))})),this.ctx=a,this.renderCanvas=n,this.logStartTime=o,this.isDebug=u,this.width=0,this.height=0,this.currentTime=0,this.videoRenderer=new x(this.renderCanvas),this.audioChannels=2,this.indexedDBUtils=new S("bwphevc","lib"),this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.outOfSyncFrameCount=0,this.hasFirstFrame=!1,this.isSeeking=!1,this.isAfterSeekAudioFragment=!1,this.isAfterSeekVideoFragment=!1,this.isPipMode=!1,this.isDestroy=!1,this.isReadyToRelegation=!1,this.isCorePlayerOpened=!1,this.init()}return s(r,[{key:"play",value:function(){this.log(F.INFO,"[play]"),this.wasmPlayerModule._bwpPlay()}},{key:"pause",value:function(){this.log(F.INFO,"[pause]"),this.wasmPlayerModule._bwpPause()}},{key:"seek",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.SEEK_POS;this.log(F.INFO,"[seek] buffFlushFlag: ".concat(e,", time: ").concat(t)),this.buffFlushFlag=e,this.currentTime=t,this.isSeeking=!0,this.isAfterSeekAudioFragment=!0,this.isAfterSeekVideoFragment=!0,this.wasmPlayerModule._bwpSeek(this.currentTime,r),this.sendMsg(i.BUFFER_FLUSHED,{flag:e})}},{key:"setPlaybackRate",value:function(e){this.log(F.INFO,"[setPlaybackRate] rate: ".concat(e)),this.wasmPlayerModule._bwpSpeed(100*e,100)}},{key:"getVideoPlaybackQuality",value:function(){this.wasmPlayerModule._bwpQuality(),this.sendMsg(i.PLAYBACK_QUALITY,{fps:this.fps,totalVideoFrames:this.totalVideoFrames,droppedVideoFrames:this.droppedVideoFrames})}},{key:"endOfStream",value:function(e){this.log(F.WARN,"[endOfStream] type: ".concat(e));var t=e===k.AUDIO?c.BWP_SRC_TYPE_AUDIO:c.BWP_SRC_TYPE_VIDEO;this.wasmPlayerModule._bwpFillBuff(t,-1,0,0,0,0)}},{key:"setAppendWindow",value:function(e,t){this.log(F.INFO,"[setAppendWindow] start: ".concat(e,", end: ").concat(t)),this.wasmPlayerModule._bwpRange(e,t)}},{key:"setDecodeMode",value:function(e){this.log(F.INFO,"[setDecodeMode] enable: ".concat(e)),this.wasmPlayerModule._bwpEnableVideo(e?1:0)}},{key:"setAudioTime",value:function(e,t,r){var a=+new Date-r;a>t&&(a=t),this.wasmPlayerModule._bwpSetAudio(e+a)}},{key:"setPipMode",value:function(e){this.isPipMode=e}},{key:"reset_outofsync_frame_count",value:function(){this.outOfSyncFrameCount<=0||(this.log(F.INFO,"reset outOfSyncFrameCount: ".concat(this.outOfSyncFrameCount," => 0")),this.outOfSyncFrameCount=0)}},{key:"redrawLastFrame",value:function(){this.videoRenderer.redrawLastFrame()}},{key:"appendBuffer",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=t.byteLength;if(this.reallocInputBuffer(n),this.inputBuffer){var i=new Uint8Array(this.wasmMemory.buffer,this.inputBuffer,n);i.set(new Uint8Array(t));var o=0,s=e===k.AUDIO;r?o=c.BWP_DATA_FLAG_FORMAT:this.isAfterSeekVideoFragment&&!s?(o=c.BWP_DATA_FLAG_NEWPOS,this.isAfterSeekVideoFragment=!1):this.isAfterSeekAudioFragment&&s&&(o=c.BWP_DATA_FLAG_NEWPOS,this.isAfterSeekAudioFragment=!1,this.isAfterSeekVideoFragment||this.isSeeking||this.triggerSeekedEvent());var u=s?c.BWP_SRC_TYPE_AUDIO:c.BWP_SRC_TYPE_VIDEO;this.wasmPlayerModule._bwpFillBuff(u,a,this.inputBuffer,n,0,o),this.log(F.INFO,"[appendBuffer] [".concat(e,"] done, pos: ").concat(a,", byte length: ").concat(n,", isInitSegment: ").concat(r))}else this.throwError(_.WASM_MEMORY_MALLOC_ERROR,"Malloc wasm shared memory error")}},{key:"reload",value:function(e){var t;(this.log(F.INFO,"[reload]"),this.buffFlushFlag=e,this.isCorePlayerOpened)&&(null===(t=this.wasmPlayerModule)||void 0===t||t._bwpFlush(c.BWP_SRC_TYPE_DASH));this.width=0,this.height=0,this.currentTime=0,this.audioChannels=2,this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.outOfSyncFrameCount=0,this.hasFirstFrame=!1,this.isSeeking=!1,this.isAfterSeekVideoFragment=!1,this.isAfterSeekAudioFragment=!1,this.isReadyToRelegation=!1,this.videoRenderer.clear(),this.sendMsg(i.BUFFER_FLUSHED,{flag:e})}},{key:"destroy",value:function(){var e,t,r;this.log(F.INFO,"[destroy]"),this.isDestroy||(this.isDestroy=!0,null===(e=this.syncTimer)||void 0===e||e.stop(),this.videoRenderer.destroy(),URL.revokeObjectURL(this.glueJsUrl||""),URL.revokeObjectURL(this.pthreadJsUrl||""),this.isCorePlayerOpened&&(this.isCorePlayerOpened=!1,this.log(F.WARN,"call bwpUninit()"),null===(t=this.wasmPlayerModule)||void 0===t||t._bwpUninit(),this.inputBuffer&&(this.wasmPlayerModule._free(this.inputBuffer),this.inputBuffer=null),null===(r=this.wasmPlayerModule)||void 0===r||r.terminateAllThreads(),this.wasmPlayerModule=null))}},{key:"init",value:function(){var e=this;this.glueJsUrl=URL.createObjectURL(new Blob([N],{type:"application/javascript"})),this.pthreadJsUrl=URL.createObjectURL(new Blob([C],{type:"application/javascript"})),importScripts(this.glueJsUrl);var t={mainScriptUrlOrBlob:this.glueJsUrl,locateFile:function(t,r){return t.endsWith("worker.js")?e.pthreadJsUrl:r+t},instantiateWasm:function(t,r){var a="libwpengn.wasm",n=function(e){r(e.instance,e.module)};(function(e,t,r,a){return p.apply(this,arguments)})(e.indexedDBUtils,a,t,"https://pre-s1.hdslb.com/bfs/static/bwphevc/libwpengn-4.1.7.wasm").then((function(e){return n(e)})).catch((function(){e.throwError(_.CORE_PLAYER_LOAD_ERROR,"load wasm from indexedDB and url error or caching error")}))},print:function(t){e.isDebug&&e.log(F.INFO,t,!0)}};this.ctx.WasmPlayerModuleFactory(t).then((function(t){e.isDestroy||(e.wasmPlayerModule=t,e.wasmPlayerModule.onAbort=e.onAbortHandler,e.wasmMemory=e.wasmPlayerModule.wasmMemory,e.initCorePlayer())})).catch((function(t){e.throwError(_.CORE_PLAYER_LOAD_ERROR,t&&t.toString&&t.toString())}))}},{key:"initCorePlayer",value:function(){var e=this.wasmPlayerModule.addFunction(this.msgHandler,"iiiiiii"),t=this.wasmPlayerModule.addFunction(this.videoRenderHandler,"iiiiiiiii"),r=this.wasmPlayerModule.addFunction(this.audioRenderHandler,"iiiiii");if(e&&t&&r){var a=this.isDebug?c.BWP_LOG_LEVEL_DEBUG:c.BWP_LOG_LEVEL_ERR;this.wasmPlayerModule._bwpInit(1,e,t,r,a),this.wasmPlayerModule._bwpOpen(c.BWP_SRC_TYPE_DASH,0,0,0),this.syncTimer=this.createTimer(this.syncTimerHandler,4),this.syncTimer.start()}else this.throwError(_.CORE_PLAYER_ADD_FUNCTION_ERROR,"Core player add function failed")}},{key:"reallocInputBuffer",value:function(e){this.inputBuffer&&this.inputBufferSize&&this.inputBufferSize>=e||(this.inputBuffer&&this.wasmPlayerModule._free(this.inputBuffer),this.log(F.INFO,"remalloc input memory, last memory size: ".concat(this.inputBufferSize,", new size: ").concat(e)),this.inputBufferSize=e,this.inputBuffer=this.wasmPlayerModule._malloc(this.inputBufferSize))}},{key:"triggerSeekedEvent",value:function(){this.isAfterSeekAudioFragment||this.isAfterSeekVideoFragment||this.isSeeking||(this.log(F.INFO,"seek done, buffFlushFlag: ".concat(this.buffFlushFlag)),this.sendMsg(i.SEEKED,{flag:this.buffFlushFlag}))}},{key:"sendMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.ctx&&this.ctx.postMessage({msg:e,data:t},r)}},{key:"createTimer",value:function(e,t){var r;return{start:function(){var a=this;r=setTimeout((function(){e(),a.start()}),t)},stop:function(){clearTimeout(r)}}}}]),r}(),W=self;W.onmessage=function(e){var t,r,a=null===(t=e.data)||void 0===t?void 0:t.msg,n=null===(r=e.data)||void 0===r?void 0:r.data;if(a!==i.INIT){var o;if(a===i.DESTROY)return null===(o=I)||void 0===o||o.destroy(),I=null,void close();if(!I||!I.isDestroy){if(!I)throw new Error("BwpCorePlayer not init!");switch(a){case i.PLAY:I.play();break;case i.PAUSE:I.pause();break;case i.SEEK:I.seek(n.flag,n.time);break;case i.PLAYBACK_RATE:I.setPlaybackRate(n.rate);break;case i.GET_PLAYBACK_QUALITY:I.getVideoPlaybackQuality();break;case i.END_OF_STREAM:I.endOfStream(n.mediaType);break;case i.SET_APPEND_WINDOW:I.setAppendWindow(n.start,n.end);break;case i.SET_DECODE_MODE:I.setDecodeMode(n.enable);break;case i.SET_AUDIO_TIME:I.setAudioTime(n.time,n.bufferLen,n.timeStamp);break;case i.SET_PIP_MODE:I.setPipMode(n.enable);break;case i.RESET_OUTOFSYNC_FRAME_COUNT:I.reset_outofsync_frame_count();break;case i.REDRAW_LAST_FRAME:I.redrawLastFrame();break;case i.FILL_BUFFER:I.appendBuffer(n.mediaType,n.buffer,n.isInitSegment);break;case i.RELOAD:I.reload(n.flag)}}}else{if(I)return;I=new B(W,n.renderCanvas,n.logStartTime,n.isDebug)}}}()}();',"Worker",void 0,void 0)}function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}!function(e){e[e.SOURCE=0]="SOURCE",e[e.MSE=1]="MSE",e[e.LIVE=2]="LIVE"}(tr||(tr={})),function(e){e.CORE_PLAYER_LOADED="coreplayerloaded",e.CORE_PLAYER_OPENED="coreplayeropened",e.ENDED="ended",e.SEEKED="seeked",e.TIMEUPDATE="timeupdate",e.CANPLAY="canplay"}(rr||(rr={}));var ur=function(e){A(r,e);var t=sr(r);function r(e,n,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tr.MSE;return y(this,r),T(E(a=t.call(this)),"logger",void 0),T(E(a),"TAG","[BwpMediaPlayer]"),T(E(a),"MIN_TIMEUPTE_INTERVAL",110),T(E(a),"renderCanvas",void 0),T(E(a),"bwpElement",void 0),T(E(a),"timeupdateCallback",void 0),T(E(a),"sourceMode",void 0),T(E(a),"bwpMediaSource",void 0),T(E(a),"appendWindowStart",void 0),T(E(a),"appendWindowEnd",void 0),T(E(a),"corePlayerWorker",void 0),T(E(a),"audioRenderer",void 0),T(E(a),"_volume",void 0),T(E(a),"audioSampleRate",void 0),T(E(a),"audioRenderBuffer",void 0),T(E(a),"currentTime",void 0),T(E(a),"_playbackRate",void 0),T(E(a),"glueJsUrl",void 0),T(E(a),"pthreadJsUrl",void 0),T(E(a),"bufferChekTimer",void 0),T(E(a),"buffFlushFlag",void 0),T(E(a),"isBuffFlushing",void 0),T(E(a),"wakeLock",void 0),T(E(a),"isWakeLockInit",void 0),T(E(a),"canplayTimer",void 0),T(E(a),"fps",void 0),T(E(a),"totalVideoFrames",void 0),T(E(a),"droppedVideoFrames",void 0),T(E(a),"moduleLoadedTime",void 0),T(E(a),"lastTimeUpdate",void 0),T(E(a),"hasFirstFrame",void 0),T(E(a),"isAudioInitDone",void 0),T(E(a),"isCorePlayerOpened",void 0),T(E(a),"isCorePlayerCanPlay",void 0),T(E(a),"isSeeking",void 0),T(E(a),"isWaiting",void 0),T(E(a),"isInternalSeek",void 0),T(E(a),"isVideoEnd",void 0),T(E(a),"isAudioEnd",void 0),T(E(a),"_isPictureInPicture",void 0),T(E(a),"setMediaSource",(function(e){a.bwpMediaSource=e})),T(E(a),"setSourceOpen",(function(){a.isCorePlayerCanPlay||(clearTimeout(a.canplayTimer),a.canplayTimer=setTimeout((function(){a.bwpElement&&a.bwpElement.buffered.length>0&&a.throwError(wt.TRIGGER_CANPLAY_ERROR,"trigger canplay timeout > 30s")}),3e4))})),T(E(a),"loadedMetadata",(function(){if(a.bwpMediaSource){for(var e=a.bwpMediaSource.activeSourceBuffers,t=0;t<e.length;t++){var r=e[t];if(r.mediaType===c.AUDIO){var n=r.__getNextCachedSegments__(0,!0).sampleRate;if(n<=0)break;n!==a.audioSampleRate?(a.logger.warn(a.TAG,"init audio renderer, old: ".concat(a.audioSampleRate,", new: ").concat(n)),a.audioSampleRate=n,a.audioRenderer.init(a.audioSampleRate).then((function(){a.isAudioInitDone=!0,a.triggerCorePlayerCanPlay()}))):(a.isAudioInitDone=!0,a.triggerCorePlayerCanPlay());break}}a.isCorePlayerOpened&&a.checkBuffer()}})),T(E(a),"corePlayerMsgHandler",(function(e){var t,r,n=null===(t=e.data)||void 0===t?void 0:t.msg,i=null===(r=e.data)||void 0===r?void 0:r.data;switch(n){case $t.OPENED:a.isCorePlayerOpened=!0,a.bufferChekTimer=a.createTimer(a.bufferCheckHandler,50),a.bufferChekTimer.start(),a.glueJsUrl=i.glueJsUrl,a.pthreadJsUrl=i.pthreadJsUrl,a.logger.warn(a.TAG,"[state] open done, spent: ".concat(+new Date-a.moduleLoadedTime," ms")),Promise.resolve().then((function(){a.applyCorePlayerOfflineState()}));break;case $t.RESIZE:Q(a.bwpElement,ce.RESIZE);break;case $t.FIRST_FRAME:a.logger.warn(a.TAG,"[state] render first frame, spent: ".concat(+new Date-a.moduleLoadedTime," ms")),a.hasFirstFrame=!0,a.triggerCorePlayerCanPlay();break;case $t.TIMEUPDATE:if(a.isSeeking||a.isBuffFlushing)return;i.time>=0&&a.currentTime!==i.time&&(a.currentTime=i.time,a.lastTimeUpdate=+new Date,a.timeupdateCallback(a.currentTime/1e3),Promise.resolve().then((function(){a.readyStateChecker()})));break;case $t.RENDER_AUDIO:if(a.isBuffFlushing||!a.isAudioInitDone)return void a.logger.warn(a.TAG,"discard invalid audio buffer,","currentTime: ".concat(a.currentTime,", audio buffer time: ").concat(i.time));a.isCorePlayerCanPlay||a.triggerCorePlayerCanPlay(),a.audioRenderer.fillBuffer({data:i.data,time:i.time,channels:i.channels});break;case $t.BUFFER_FLUSHED:i.flag===a.buffFlushFlag?(a.isBuffFlushing=!1,a.isSeeking||(a.buffFlushFlag=0)):a.logger.warn(a.TAG,"discard invalid buffer flushed");break;case $t.SEEKED:if(i.flag!==a.buffFlushFlag||!a.isSeeking)return void a.logger.warn(a.TAG,"discard invalid seek, isSeeking: ".concat(a.isSeeking));a.buffFlushFlag=0,a.isSeeking=!1,a.isInternalSeek?(a.logger.warn(a.TAG,"inner seek done"),a.isInternalSeek=!1):(a.logger.warn(a.TAG,"seek done"),a.dispatchEvent(new Event(rr.SEEKED)),Promise.resolve().then((function(){a.readyStateChecker(!1)}))),a.triggerCorePlayerCanPlay();break;case $t.PLAY_END:a.resetKeepScreenAlive(),Q(E(a),rr.ENDED);break;case $t.PLAYBACK_QUALITY:a.fps=i.fps,a.totalVideoFrames=i.totalVideoFrames,a.droppedVideoFrames=i.droppedVideoFrames;break;case $t.FALLBACK:setTimeout((function(){var e;null===(e=a.bwpElement)||void 0===e||e.dispatchEvent(new qt(wt.OUT_OF_SYNC,n))}));break;case $t.LOG:if(!ne)return;console[i.logLevel](i.msg);break;case $t.ERROR:a.throwError(i.errorCode,i.describe||"");break;default:a.logger.warn("".concat(a.TAG," Unsupport messsage ").concat(n))}})),T(E(a),"corePlayerOnErrorHandler",(function(e){a.logger.error(a.TAG,"core player onerror",e)})),T(E(a),"checkBuffer",(function(){if(a.isCorePlayerOpened&&a.isAudioInitDone){if(a.sourceMode!==tr.MSE)throw new Error("Not support source mode now");a.checkMseModeBuffer()}})),T(E(a),"checkMseModeBuffer",(function(){if(a.bwpMediaSource&&a.isCorePlayerOpened)for(var e=a.bwpMediaSource.activeSourceBuffers,t=0;t<e.length;t++){var r=e[t],n=r.mediaType,i=r.appendWindowStart,o=r.appendWindowEnd,s=[],u=!1;if(n===c.AUDIO||i===a.appendWindowStart&&o===a.appendWindowEnd||(a.appendWindowStart=i,a.appendWindowEnd=o,a.sendMsgToCorePlayer($t.SET_APPEND_WINDOW,{start:1e3*a.appendWindowStart,end:1e3*a.appendWindowEnd}),a.logger.log(a.TAG,"set append window to core player: ".concat(i,", ").concat(o))),!a.isVideoEnd&&!a.isAudioEnd){var l=r.__getNextCachedSegments__(a.currentTime/1e3);s=l.buffer,u=l.isEndOfStream}if(s.length>0){a.logger.log(a.TAG,"[".concat(n,"] ready to append buffer to core player,"),"currentTime: ".concat(a.currentTime));for(var f=0;f<s.length;f++){var h=s[f],d=performance.now();a.sendMsgToCorePlayer($t.FILL_BUFFER,{mediaType:n,buffer:h.data,isInitSegment:h.isInitSegment},[]);var p=performance.now();p-d>10&&a.logger.warn(a.TAG,"send buffer data spent > 10ms => ".concat(p-d,"ms"))}}u&&a.endOfStream(n)}})),T(E(a),"audioprocessingCallback",(function(e,t,r){var n;if(a.audioRenderBuffer=t,-1!==e&&(a.sendMsgToCorePlayer($t.SET_AUDIO_TIME,{time:e,bufferLen:t,timeStamp:r}),!(e<0||null!==(n=a.bwpElement)&&void 0!==n&&n.paused||a.isWaiting||a.isSeeking))){var i=+new Date;i-a.lastTimeUpdate>a.MIN_TIMEUPTE_INTERVAL&&(a.lastTimeUpdate=i,a.timeupdateCallback(e/1e3))}})),T(E(a),"applyCorePlayerOfflineState",(function(){0!==a.currentTime&&(a.logger.log(a.TAG,"[applyOfflineState] seek to ".concat(a.currentTime)),a.seek(a.currentTime)),1!==a._playbackRate&&(a.logger.log(a.TAG,"[applyOfflineState] set playbackrate: ".concat(a._playbackRate)),a.playbackRate=a._playbackRate)})),T(E(a),"audioCanplayHandler",(function(){var e,t,r,n;(a.triggerCorePlayerCanPlay(),1!==a._volume)&&(a.logger.log(a.TAG,"[applyOfflineState], set volume: ".concat(a._volume,", muted: ").concat(null===(r=a.bwpElement)||void 0===r?void 0:r.muted)),a.audioRenderer.volume=null!==(n=a.bwpElement)&&void 0!==n&&n.muted?0:a._volume);null!==(e=a.bwpElement)&&void 0!==e&&e.paused||null!==(t=a.audioRenderer)&&void 0!==t&&t.isPlaying()||!a.isCorePlayerCanPlay||(a.play(),a.logger.warn(a.TAG,"[applyOfflineState], audio render is not play, call play"))})),T(E(a),"triggerCorePlayerCanPlay",(function(){!a.isCorePlayerCanPlay&&a.hasFirstFrame&&!a.isSeeking&&a.isCorePlayerOpened&&a.isAudioInitDone&&(a.logger.warn(a.TAG,"trigger BwpMediaPlayer canplay"),clearTimeout(a.canplayTimer),Q(E(a),rr.CANPLAY),a.isCorePlayerCanPlay=!0,Promise.resolve().then((function(){a.readyStateChecker(!1)})))})),T(E(a),"bufferCheckHandler",(function(){a.checkBuffer()})),T(E(a),"visibilityChangeHandler",(function(){a.isCorePlayerOpened&&(a.getIsDocumentVisible()?(a.sendMsgToCorePlayer($t.SET_DECODE_MODE,{enable:!0}),a.setKeepScreenAlive()):a.isPictureInPicture||(a.sendMsgToCorePlayer($t.SET_DECODE_MODE,{enable:!1}),a.resetKeepScreenAlive()))})),T(E(a),"setKeepScreenAlive",I(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.bwpElement.paused&&window.navigator.wakeLock&&!a.wakeLock&&!a.isWakeLockInit){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a.isWakeLockInit=!0,e.next=6,window.navigator.wakeLock.request("screen");case 6:a.wakeLock=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),a.wakeLock=null,a.isWakeLockInit=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))),T(E(a),"resetKeepScreenAlive",I(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.wakeLock&&a.isWakeLockInit){e.next=2;break}return e.abrupt("return");case 2:return a.isWakeLockInit=!1,e.next=5,a.wakeLock.release();case 5:a.isWakeLockInit||(a.wakeLock=null);case 6:case"end":return e.stop()}}),e)})))),T(E(a),"globalErrorHandler",(function(e){var t=null==e?void 0:e.filename;t&&(a.pthreadJsUrl!==t&&a.glueJsUrl!==t||a.throwError(wt.CORE_PLAYER_EXCEPTION,e.message))})),T(E(a),"throwError",(function(e,t){var r;a.bwpElement&&(localStorage.setItem("bwphevc_error","code: ".concat(e,", message: ").concat(t,", timestamp: ").concat(new Date)),null===(r=a.bwpElement)||void 0===r||r.dispatchEvent(new nr(e,(null==t?void 0:t.replace(",","."))||"")),a.destroy())})),a.moduleLoadedTime=+new Date,a.logger=ae.getInstance(),a.renderCanvas=e,a.bwpElement=n,a.timeupdateCallback=i,a.sourceMode=o,a.bwpMediaSource=null,a.appendWindowStart=0,a.appendWindowEnd=0,a._volume=1,a.audioSampleRate=-1,a.audioRenderBuffer=0,a.currentTime=0,a._playbackRate=1,a.isBuffFlushing=!1,a.isWakeLockInit=!1,a.fps=0,a.totalVideoFrames=0,a.droppedVideoFrames=0,a.lastTimeUpdate=0,a.hasFirstFrame=!1,a.isAudioInitDone=!1,a.isCorePlayerOpened=!1,a.isCorePlayerCanPlay=!1,a.isSeeking=!1,a.isWaiting=!1,a.isInternalSeek=!1,a.isVideoEnd=!1,a.isAudioEnd=!1,a._isPictureInPicture=!1,a.audioRenderer=new Qt(a.audioprocessingCallback,a.throwError),a.audioRenderer.addEventListener(Vt.CANPLAY,a.audioCanplayHandler),setTimeout((function(){var e=performance.now();a.corePlayerWorker=new or,a.corePlayerWorker.onmessage=a.corePlayerMsgHandler,a.corePlayerWorker.onerror=a.corePlayerOnErrorHandler,a.logger.warn(a.TAG,"[state] load core player worker done, spent: ".concat(performance.now()-e," ms"));var t=a.renderCanvas.transferControlToOffscreen();a.sendMsgToCorePlayer($t.INIT,{renderCanvas:t,isDebug:ne,logStartTime:ae.startTime},[t])})),window.addEventListener("error",a.globalErrorHandler),document.addEventListener("visibilitychange",a.visibilityChangeHandler),a}return w(r,[{key:"play",value:function(){var e=this;return new Promise((function(t,r){e.isCorePlayerOpened&&e.isAudioInitDone&&e.canplay()?(e.getIsDocumentVisible()||e.isPictureInPicture||(e.sendMsgToCorePlayer($t.SET_DECODE_MODE,{enable:!1}),e.logger.log(e.TAG,"play in background tab, set not decoder & not render mode")),e.sendMsgToCorePlayer($t.PLAY),e.audioRenderer.play(),e.setKeepScreenAlive(),t()):r()}))}},{key:"pause",value:function(){this.isCorePlayerOpened&&(this.sendMsgToCorePlayer($t.PAUSE),this.audioRenderer.pause(),this.resetKeepScreenAlive())}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.buffFlushFlag=+new Date;var r=Number.parseInt("".concat(e),10);if(this.currentTime=r,this.isSeeking=!0,this.isInternalSeek=t,this.isVideoEnd=!1,this.isAudioEnd=!1,this.audioRenderer.seek(),this.audioRenderBuffer=0,this.isCorePlayerOpened?(this.isBuffFlushing=!0,this.sendMsgToCorePlayer($t.SEEK,{flag:this.buffFlushFlag,time:r})):this.logger.warn(this.TAG,"corePlayer not opened, delay seek"),this.bwpMediaSource)for(var n=this.bwpMediaSource.activeSourceBuffers,i=0;i<n.length;i++)n[i].__seek__(r/1e3);t||this.checkBuffer()}},{key:"getVideoPlaybackQuality",value:function(){this.isCorePlayerOpened&&this.sendMsgToCorePlayer($t.GET_PLAYBACK_QUALITY);var e=new Yt;return e.fps=this.fps,e.totalVideoFrames=this.totalVideoFrames,e.droppedVideoFrames=this.droppedVideoFrames,e}},{key:"isAllReady",value:function(){return this.isCorePlayerCanPlay}},{key:"canplay",value:function(){var e;return null===(e=this.audioRenderer)||void 0===e?void 0:e.canPlay()}},{key:"redrawLastFrame",value:function(){this.sendMsgToCorePlayer($t.REDRAW_LAST_FRAME)}},{key:"endOfStream",value:function(e){this.sendMsgToCorePlayer($t.END_OF_STREAM,{mediaType:e})}},{key:"setWaitingState",value:function(){this.isWaiting=!0}},{key:"getWaitingState",value:function(){return this.isWaiting}},{key:"toDataURL",value:function(e,t){return this.renderCanvas.toDataURL(e,t)}},{key:"reload",value:function(){var e,t,r,n;if(this.logger.warn(this.TAG,"reload, ready to flush core player"),clearTimeout(this.canplayTimer),null===(e=this.bufferChekTimer)||void 0===e||e.stop(),this.resetKeepScreenAlive(),null!==(t=this.audioRenderer)&&void 0!==t&&t.isPlaying()&&this.pause(),this.isCorePlayerOpened&&(this.isBuffFlushing=!0,this.buffFlushFlag=+new Date,this.sendMsgToCorePlayer($t.RELOAD,{flag:this.buffFlushFlag})),this.currentTime=0,this.appendWindowStart=0,this.appendWindowEnd=0,this.audioRenderBuffer=0,this.moduleLoadedTime=+new Date,this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.lastTimeUpdate=0,this.hasFirstFrame=!1,this.isAudioInitDone=!1,this.isCorePlayerCanPlay=!1,this.isSeeking=!1,this.isWaiting=!1,this.isInternalSeek=!1,this.isVideoEnd=!1,this.isAudioEnd=!1,this._isPictureInPicture=!1,null===(r=this.audioRenderer)||void 0===r||r.seek(),this.bwpMediaSource)for(var i=this.bwpMediaSource.activeSourceBuffers,a=0;a<i.length;a++)i[a].__seek__(0);null===(n=this.bufferChekTimer)||void 0===n||n.start()}},{key:"destroy",value:function(){var e,t,r;this.corePlayerWorker&&(clearTimeout(this.canplayTimer),this.resetKeepScreenAlive(),window.removeEventListener("error",this.globalErrorHandler),document.removeEventListener("visibilitychange",this.visibilityChangeHandler),null===(e=this.bufferChekTimer)||void 0===e||e.stop(),this.resetKeepScreenAlive(),this.bwpElement=null,this.bwpMediaSource=null,this.isCorePlayerCanPlay=!1,null===(t=this.audioRenderer)||void 0===t||t.removeEventListener(Vt.CANPLAY,this.audioCanplayHandler),null===(r=this.audioRenderer)||void 0===r||r.destroy(),this.corePlayerWorker.terminate(),this.corePlayerWorker.onmessage=null,this.corePlayerWorker.onerror=null,this.corePlayerWorker=null)}},{key:"sendMsgToCorePlayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.corePlayerWorker&&(this.isCorePlayerOpened||e===$t.INIT)&&this.corePlayerWorker.postMessage({msg:e,data:t},r)}},{key:"readyStateChecker",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.bwpElement;if(!(null!=t&&t.paused||this.isAudioEnd&&this.isVideoEnd)&&t&&t.readyState>=o.HAVE_METADATA){var r=t.buffered,n=r.length>0?r.end(0):0,i=this.currentTime/1e3;if(r.container(i)){if(n-i>.1){if(!this.isWaiting)return;!this.audioRenderer.isPlaying()&&this.canplay()&&(this.play(),this.logger.warn(this.TAG,"[waiting] recovery play")),this.isWaiting=!1,this.logger.warn(this.TAG,"[waiting] end"),!this.isSeeking&&e&&Q(this.bwpElement,ce.PLAYING)}}else{if(this.isWaiting||this.isSeeking)return;this.audioRenderBuffer<=0&&(Q(this.bwpElement,ce.WAITING),this.isWaiting=!0,this.seek(this.currentTime,!0),this.logger.warn(this.TAG,"[waiting] trigger internal seek, currentTime:",this.currentTime,n,t.duration)),this.sendMsgToCorePlayer($t.RESET_OUTOFSYNC_FRAME_COUNT)}}}},{key:"createTimer",value:function(e,t){var r;return{start:function(){var n=this;r=setTimeout((function(){e(),n.start()}),t)},stop:function(){clearTimeout(r)}}}},{key:"getIsDocumentVisible",value:function(){return"visible"===document.visibilityState}},{key:"muted",set:function(e){this.audioRenderer.volume=e?0:this._volume}},{key:"volume",get:function(){return this._volume},set:function(e){var t;this._volume=e,null!==(t=this.bwpElement)&&void 0!==t&&t.muted||(this.audioRenderer.volume=e)}},{key:"playbackRate",set:function(e){this.logger.warn(this.TAG,"set playbackRate: ".concat(e,", currentTime: ").concat(this.currentTime));var t=parseFloat(e.toFixed(2));this._playbackRate=t,this.sendMsgToCorePlayer($t.PLAYBACK_RATE,{rate:t})}},{key:"isPictureInPicture",get:function(){return this._isPictureInPicture},set:function(e){this._isPictureInPicture=e,e&&this.isCorePlayerOpened&&!this.getIsDocumentVisible()&&this.sendMsgToCorePlayer($t.SET_DECODE_MODE,{enable:!0}),this.sendMsgToCorePlayer($t.SET_PIP_MODE,{enable:e})}}]),r}(x),cr=HTMLElement;"function"!=typeof HTMLElement&&(cr=function e(){y(this,e)});var lr=cr,fr=r(601),hr={};function dr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k(this,r)}}var pr=new WeakMap,_r=new WeakMap,mr=new WeakMap,vr=new WeakMap,br=new WeakMap,yr=new WeakMap,gr=new WeakMap,wr=new WeakMap,Er=new WeakMap,Ar=new WeakMap,kr=new WeakMap,Tr=new WeakMap,Sr=new WeakMap,Rr=new WeakMap,xr=new WeakMap,Pr=new WeakMap,Dr=new WeakMap,Fr=new WeakMap,Mr=new WeakMap,Or=new WeakMap,Ir=new WeakMap,Nr=new WeakMap,Cr=new WeakMap,Ur=new WeakMap,Lr=new WeakMap,Br=new WeakMap,Wr=new WeakMap,Gr=new WeakMap,Vr=new WeakMap,Hr=new WeakMap,Yr=new WeakMap,jr=new WeakMap,zr=new WeakMap,Kr=new WeakMap,qr=new WeakMap,Jr=new WeakMap,Xr=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,$r=new WeakMap,en=new WeakMap,tn=new WeakMap,rn=new WeakMap,nn=new WeakMap,an=new WeakMap,on=new WeakMap,sn=new WeakMap,un=new WeakMap,cn=new WeakMap,ln=new WeakMap,fn=new WeakMap,hn=new WeakMap,dn=new WeakMap,pn=new WeakMap,_n=new WeakMap,mn=new WeakMap,vn=new WeakMap,bn=function(e){A(i,e);var t,r=dr(i);function i(){var e,t,s;y(this,i),e=r.call(this),pr.set(E(e),{writable:!0,value:void 0}),_r.set(E(e),{writable:!0,value:"[BwpElement]"}),mr.set(E(e),{writable:!0,value:void 0}),vr.set(E(e),{writable:!0,value:void 0}),T(E(e),"srcObject",void 0),br.set(E(e),{writable:!0,value:void 0}),T(E(e),"crossOrigin",void 0),T(E(e),"NETWORK_EMPTY",a.NETWORK_EMPTY),T(E(e),"NETWORK_IDLE",a.NETWORK_IDLE),T(E(e),"NETWORK_LOADING",a.NETWORK_LOADING),T(E(e),"NETWORK_NO_SOURCE",a.NETWORK_NO_SOURCE),yr.set(E(e),{writable:!0,value:void 0}),T(E(e),"preload",void 0),gr.set(E(e),{writable:!0,value:void 0}),T(E(e),"HAVE_NOTHING",o.HAVE_NOTHING),T(E(e),"HAVE_METADATA",o.HAVE_METADATA),T(E(e),"HAVE_CURRENT_DATA",o.HAVE_CURRENT_DATA),T(E(e),"HAVE_FUTURE_DATA",o.HAVE_FUTURE_DATA),T(E(e),"HAVE_ENOUGH_DATA",o.HAVE_ENOUGH_DATA),wr.set(E(e),{writable:!0,value:void 0}),Er.set(E(e),{writable:!0,value:void 0}),Ar.set(E(e),{writable:!0,value:void 0}),kr.set(E(e),{writable:!0,value:void 0}),Tr.set(E(e),{writable:!0,value:void 0}),T(E(e),"defaultPlaybackRate",void 0),Sr.set(E(e),{writable:!0,value:void 0}),Rr.set(E(e),{writable:!0,value:void 0}),xr.set(E(e),{writable:!0,value:void 0}),Pr.set(E(e),{writable:!0,value:void 0}),T(E(e),"autoplay",void 0),T(E(e),"loop",void 0),Dr.set(E(e),{writable:!0,value:void 0}),Fr.set(E(e),{writable:!0,value:void 0}),T(E(e),"defaultMuted",void 0),Mr.set(E(e),{writable:!0,value:void 0}),Or.set(E(e),{writable:!0,value:void 0}),Ir.set(E(e),{writable:!0,value:void 0}),T(E(e),"poster",void 0),T(E(e),"playsInline",void 0),Nr.set(E(e),{writable:!0,value:void 0}),Cr.set(E(e),{writable:!0,value:void 0}),Ur.set(E(e),{writable:!0,value:void 0}),Lr.set(E(e),{writable:!0,value:void 0}),Br.set(E(e),{writable:!0,value:void 0}),Wr.set(E(e),{writable:!0,value:void 0}),Gr.set(E(e),{writable:!0,value:void 0}),Vr.set(E(e),{writable:!0,value:void 0}),Hr.set(E(e),{writable:!0,value:void 0}),Yr.set(E(e),{writable:!0,value:void 0}),jr.set(E(e),{writable:!0,value:void 0}),zr.set(E(e),{writable:!0,value:void 0}),Kr.set(E(e),{writable:!0,value:void 0}),qr.set(E(e),{writable:!0,value:void 0}),Jr.set(E(e),{writable:!0,value:void 0}),Xr.set(E(e),{writable:!0,value:function(){var t="bwp-base-style",r=document.querySelector("#".concat(t));r||((r=document.createElement("style")).setAttribute("id",t),r.innerHTML="bwp-video { object-fit: contain; }",document.head.appendChild(r)),R(E(e),Br,e.attachShadow({mode:"closed"}));var n=document.createElement("style");n.innerHTML=fr.Z.toString(),S(E(e),Br).appendChild(n),R(E(e),Wr,document.createElement("div")),S(E(e),Wr).setAttribute("class","-bwp-internal-container"),S(E(e),Br).appendChild(S(E(e),Wr)),S(E(e),Gr).setAttribute("class","-bwp-internal-render-canvas"),S(E(e),Wr).appendChild(S(E(e),Gr)),S(E(e),jr).setAttribute("class","-bwp-internal-proxy-video-element"),S(E(e),Wr).appendChild(S(E(e),jr)),e.getAttribute("controls")&&S(E(e),Qr).call(E(e))}}),Qr.set(E(e),{writable:!0,value:function(){S(E(e),Yr)||"function"!=typeof hr||(R(E(e),Yr,new hr(E(e),S(E(e),Wr),S(E(e),Gr))),S(E(e),Yr).setupControls())}}),Zr.set(E(e),{writable:!0,value:(t=I(M().mark((function t(){var r;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:S(E(e),yr)===e.NETWORK_EMPTY&&S(E(e),pr).log(S(E(e),_r),"[internalPlay] network empty"),S(E(e),Pr)&&S(E(e),Sr)>0&&S(E(e),rn).call(E(e),0),S(E(e),Tr)?(R(E(e),Tr,!1),Q(E(e),ce.PLAY),S(E(e),wr)<=e.HAVE_CURRENT_DATA?(S(E(e),pr).warn(S(E(e),_r),"[waiting] not enough data to play"),null===(r=S(E(e),Hr))||void 0===r||r.setWaitingState(),Q(E(e),ce.WAITING)):S(E(e),wr)>=e.HAVE_FUTURE_DATA&&S(E(e),Hr).play().then((function(){Q(E(e),ce.PLAYING)})).catch((function(t){R(E(e),Tr,!0);var r=new Error("Not ready");throw r.name="NotReady",r}))):(S(E(e),wr),e.HAVE_ENOUGH_DATA),R(E(e),Lr,!1);case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),$r.set(E(e),{writable:!0,value:function(){var t;(S(E(e),yr)!==e.NETWORK_LOADING&&S(E(e),yr)!==e.NETWORK_IDLE||Q(E(e),ce.ABORT),S(E(e),yr)!==e.NETWORK_EMPTY)&&(Q(E(e),ce.EMPTIED),S(E(e),Vr)&&(S(E(e),Vr).removeEventListener("sourceopen",S(E(e),on)),S(E(e),Vr).__deatch__()),S(E(e),gr).clear(),null===(t=S(E(e),Hr))||void 0===t||t.reload(),S(E(e),wr)!==e.HAVE_NOTHING&&(e.readyState=e.HAVE_NOTHING),S(E(e),Tr)||R(E(e),Tr,!0),S(E(e),Er)&&R(E(e),Er,!1),R(E(e),Ar,0),0!==S(E(e),Nr)&&(R(E(e),Nr,0),Q(E(e),ce.TIME_UPDATE)),R(E(e),kr,NaN),S(E(e),Pr)&&R(E(e),Pr,!1));e.playbackRate=e.defaultPlaybackRate,R(E(e),mr,null),R(E(e),Lr,!0),S(E(e),en).call(E(e))}}),en.set(E(e),{writable:!0,value:(s=I(M().mark((function t(){var r;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(R(E(e),yr,e.NETWORK_NO_SOURCE),R(E(e),Ur,window.__bwp__&&window.__bwp__[S(E(e),vr)||""]),!(S(E(e),Ur)instanceof MediaStream||S(E(e),Ur)instanceof MediaSource||S(E(e),Ur)instanceof yt||S(E(e),Ur)instanceof Blob||S(E(e),Ur)instanceof File)){t.next=6;break}r="object",t.next=16;break;case 6:if(!S(E(e),vr)&&""!==S(E(e),vr)){t.next=10;break}r="attribute",t.next=16;break;case 10:if(!e.children[0]||"SOURCE"!==e.children[0].tagName){t.next=14;break}r="children",t.next=16;break;case 14:return R(E(e),yr,e.NETWORK_EMPTY),t.abrupt("return");case 16:if(S(E(e),pr).log(S(E(e),_r),"src: ".concat(S(E(e),vr),", mode: ").concat(r)),"object"!==r){t.next=24;break}R(E(e),yr,e.NETWORK_LOADING),Q(E(e),ce.LOAD_START),R(E(e),br,""),S(E(e),tn).call(E(e)),t.next=29;break;case 24:if("attribute"!==r){t.next=28;break}throw new Error("[BwpElement] resourceSelectionAlgorithm not implemented mode attribute");case 28:throw new Error("[BwpElement] resourceSelectionAlgorithm not implemented mode other");case 29:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})}),tn.set(E(e),{writable:!0,value:function(){var t;if(t=S(E(e),Ur)?"local":"remote",R(E(e),br,S(E(e),vr)),"remote"===t)throw new Error("[BwpElement] resourceFetchArlgorithm not implemented mode remote");if(S(E(e),Ur)&&S(E(e),Ur)instanceof File)throw new Error("[BwpElement] resourceFetchArlgorithm not implemented local file");S(E(e),Ur)&&S(E(e),Ur)instanceof yt&&S(E(e),vr)&&(R(E(e),Vr,S(E(e),Ur)),S(E(e),Vr).readyState!==n.CLOSED||S(E(e),an).call(E(e)))}}),rn.set(E(e),{writable:!0,value:function(t){if(S(E(e),wr)!==e.HAVE_NOTHING){S(E(e),Pr)&&R(E(e),Pr,!1),S(E(e),Er),R(E(e),Er,!0);var r=t;r>S(E(e),kr)&&(r=S(E(e),kr)),S(E(e),pr).warn(S(E(e),_r),"currentTime is ".concat(S(E(e),Nr),", seek to ").concat(r)),R(E(e),Nr,r),0!==e.seekable.length&&(Q(E(e),ce.SEEKING),R(E(e),Ar,r),S(E(e),Vr)&&e.readyState>e.HAVE_METADATA&&!S(E(e),gr).container(r)&&(e.readyState=e.HAVE_METADATA),S(E(e),Hr).seek(1e3*r))}}}),nn.set(E(e),{writable:!0,value:function(){if(S(E(e),wr)>=o.HAVE_METADATA){if(S(E(e),Nr)>=S(E(e),kr)&&S(E(e),Sr)>=0&&!e.loop)return!0;if(0===S(E(e),Nr)&&S(E(e),Sr)<0)return!0}return!1}}),an.set(E(e),{writable:!0,value:function(){S(E(e),Vr)&&(S(E(e),pr).log(S(E(e),_r),"attach BwpMediaSource"),S(E(e),Vr).addEventListener("sourceopen",S(E(e),on)),S(E(e),Vr).__attach__(E(e)),delete window.__bwp__[S(E(e),vr)],S(E(e),Hr).setMediaSource(S(E(e),Vr)))}}),on.set(E(e),{writable:!0,value:function(){S(E(e),Vr)&&S(E(e),Hr).setSourceOpen()}}),sn.set(E(e),{writable:!0,value:function(t){if(!(S(E(e),yr)<e.NETWORK_LOADING||S(E(e),Nr)===t||S(E(e),Pr))){R(E(e),Nr,t);var r=+new Date;r-S(E(e),Kr)>=200&&(R(E(e),Kr,r),Q(E(e),ce.TIME_UPDATE))}}}),un.set(E(e),{writable:!0,value:function(){R(E(e),Er,!1),0!==S(E(e),Cr)&&R(E(e),Cr,0),Q(E(e),ce.TIME_UPDATE),Q(E(e),ce.SEEKED),!S(E(e),Tr)&&S(E(e),Hr).isAllReady()&&Q(E(e),ce.PLAYING)}}),cn.set(E(e),{writable:!0,value:function(){S(E(e),pr).warn(S(E(e),_r),"play ended"),R(E(e),Nr,S(E(e),kr)),e.pause(),R(E(e),Pr,!0),Q(E(e),ce.ENDED)}}),ln.set(E(e),{writable:!0,value:function(){var t;S(E(e),Hr).isAllReady()?(S(E(e),qr)&&R(E(e),qr,!1),Q(E(e),ce.CANPLAY),S(E(e),pr).log(S(E(e),_r),"readyState change CANPLAY"),S(E(e),Tr)||(R(E(e),Lr,!1),e.seeking||null!==(t=S(E(e),Hr))&&void 0!==t&&t.getWaitingState()||!S(E(e),Hr).canplay()||Q(E(e),ce.PLAYING))):R(E(e),qr,!0)}}),fn.set(E(e),{writable:!0,value:function(){S(E(e),Hr).isAllReady()?(S(E(e),Jr)&&R(E(e),Jr,!1),Q(E(e),ce.CANPLAY_THROUGH)):R(E(e),Jr,!0)}}),hn.set(E(e),{writable:!0,value:function(){S(E(e),Hr).isAllReady()&&(S(E(e),Hr).canplay()?S(E(e),Hr).play().then((function(){S(E(e),pr).log(S(E(e),_r),"[triggerAutoPlay], call play done"),Q(E(e),ce.PLAY),Q(E(e),ce.PLAYING)})).catch((function(){R(E(e),Tr,!0),S(E(e),pr).log(S(E(e),_r),"[triggerAutoPlay], failed, not ready")})):(R(E(e),Tr,!0),S(E(e),pr).warn(S(E(e),_r),"[triggerAutoPlay], cannot auto play")),R(E(e),Lr,!1))}}),dn.set(E(e),{writable:!0,value:function(){S(E(e),qr)&&S(E(e),ln).call(E(e)),S(E(e),Jr)&&S(E(e),fn).call(E(e)),e.autoplay&&S(E(e),Lr)&&!S(E(e),Tr)&&e.readyState===e.HAVE_ENOUGH_DATA&&S(E(e),hn).call(E(e)),S(E(e),Tr)||S(E(e),Hr).canplay()||(S(E(e),pr).warn(S(E(e),_r),"[corePlayerCanplay] can not play, set paused true"),R(E(e),Tr,!0))}}),pn.set(E(e),{writable:!0,value:function(){Q(E(e),ce.ENTER_PICTURE_IN_PICTURE)}}),_n.set(E(e),{writable:!0,value:function(){S(E(e),Hr).isPictureInPicture=!1,S(E(e),Gr).style.visibility="visible",S(E(e),jr).style.display="none",S(E(e),jr).srcObject=null,R(E(e),zr,null),S(E(e),jr).removeEventListener(ce.ENTER_PICTURE_IN_PICTURE,S(E(e),pn)),S(E(e),jr).removeEventListener(ce.LEAVE_PICTURE_IN_PICTURE,S(E(e),pn)),Q(E(e),ce.LEAVE_PICTURE_IN_PICTURE)}}),mn.set(E(e),{writable:!0,value:function(){window.removeEventListener("beforeunload",S(E(e),mn)),e.destroy()}}),vn.set(E(e),{writable:!0,value:function(e){return!!"".concat(e).match(/^[0-9]+.?[0-9]*$/)}});var u=performance.now();if(!Ht())throw new Error("WasmPlayer not supported!");if(!window.AudioWorklet||!window.AudioWorkletNode)throw new Error("WasmPlayer not supported, HTTP page can not use AudioWorklet!");return R(E(e),pr,ae.getInstance()),R(E(e),mr,null),R(E(e),vr,""),e.srcObject=null,R(E(e),br,""),e.crossOrigin=null,R(E(e),yr,e.NETWORK_EMPTY),e.preload="metadata",R(E(e),gr,new H),R(E(e),wr,e.HAVE_NOTHING),R(E(e),Er,!1),R(E(e),kr,NaN),R(E(e),Tr,!0),e.defaultPlaybackRate=1,R(E(e),Sr,1),R(E(e),Rr,new H),R(E(e),xr,new H),R(E(e),Pr,!1),e.autoplay=!1,e.loop=!1,R(E(e),Dr,!1),R(E(e),Fr,!1),e.defaultMuted=!1,R(E(e),Mr,new X),R(E(e),Or,0),R(E(e),Ir,0),e.poster="",e.playsInline=!1,R(E(e),Ar,0),R(E(e),Nr,0),R(E(e),Cr,0),R(E(e),Lr,!0),R(E(e),qr,!1),R(E(e),Jr,!1),R(E(e),Gr,document.createElement("canvas")),R(E(e),Hr,new ur(S(E(e),Gr),E(e),S(E(e),sn))),S(E(e),Hr).addEventListener(rr.ENDED,S(E(e),cn)),S(E(e),Hr).addEventListener(rr.SEEKED,S(E(e),un)),S(E(e),Hr).addEventListener(rr.CANPLAY,S(E(e),dn)),R(E(e),jr,document.createElement("video")),S(E(e),Xr).call(E(e)),window.addEventListener("beforeunload",S(E(e),mn)),R(E(e),Kr,0),S(E(e),pr).warn(S(E(e),_r),"init bwp done, spent: ".concat(performance.now()-u," ms")),e}return w(i,[{key:"load",value:function(){S(this,$r).call(this)}},{key:"canPlayType",value:function(e){return"probably"}},{key:"play",value:(t=I(M().mark((function e(){var t;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S(this,pr).log(S(this,_r),"call play"),!S(this,Hr)||null!==(t=S(this,Hr))&&void 0!==t&&t.canplay()||S(this,yr)===this.NETWORK_EMPTY){e.next=3;break}throw new DOMException("play() failed because the user didn't interact with the document first.","NotAllowedError");case 3:if(!S(this,mr)||S(this,mr).code!==s.MEDIA_ERR_SRC_NOT_SUPPORTED){e.next=5;break}throw new U;case 5:return e.abrupt("return",S(this,Zr).call(this));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pause",value:function(){var e;S(this,pr).warn(S(this,_r),"call pause"),S(this,yr)!==this.NETWORK_EMPTY&&(R(this,Lr,!1),S(this,Tr)||(R(this,Tr,!0),null!=S(this,Hr)&&(S(this,pr).log(S(this,_r),"send pause event"),Q(this,ce.TIME_UPDATE),Q(this,ce.PAUSE),null===(e=S(this,Hr))||void 0===e||e.pause())))}},{key:"addTextTrack",value:function(e,t,r){throw new Error("Method not implemented.")}},{key:"getVideoPlaybackQuality",value:function(){return S(this,Hr)?S(this,Hr).getVideoPlaybackQuality():new Yt}},{key:"requestPictureInPicture",value:function(){var e=this;if(S(this,pr).log(S(this,_r),"requestPictureInPicture"),!document.pictureInPictureEnabled)throw new U;if(S(this,wr)===this.HAVE_NOTHING)throw new L;return document.pictureInPictureElement instanceof i?S(this,jr).requestPictureInPicture():new Promise((function(t,r){S(e,Hr).isPictureInPicture=!0,R(e,zr,S(e,Gr).captureStream(30));var n=S(e,jr);n.addEventListener(ce.LOADED_METADATA,(function i(){S(e,pr).log(S(e,_r),"browser video element loaded metadata"),n.removeEventListener(ce.LOADED_METADATA,i),n.addEventListener(ce.ENTER_PICTURE_IN_PICTURE,S(e,pn)),n.addEventListener(ce.LEAVE_PICTURE_IN_PICTURE,S(e,_n)),n.requestPictureInPicture().then((function(r){S(e,jr).style.display="block",S(e,Gr).style.visibility="hidden",t(r)})).catch((function(t){S(e,Hr).isPictureInPicture=!1,R(e,zr,null),console.error(t),r(t)}))})),n.srcObject=S(e,zr),n.play(),S(e,Tr)&&S(e,Hr).redrawLastFrame()}))}},{key:"destroy",value:function(){S(this,pr).warn(S(this,_r),"call destroy"),S(this,Hr)&&(S(this,Hr).removeEventListener(rr.SEEKED,S(this,un)),S(this,Hr).removeEventListener(rr.ENDED,S(this,cn)),S(this,Hr).removeEventListener(rr.CANPLAY,S(this,dn)),window.removeEventListener("beforeunload",S(this,mn)),S(this,Hr).destroy()),S(this,Vr)&&(S(this,Vr).removeEventListener("sourceopen",S(this,on)),S(this,Vr).__deatch__()),R(this,Hr,null),R(this,Vr,null)}},{key:"toDataURL",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.92;return null===(e=S(this,Hr))||void 0===e?void 0:e.toDataURL(t,r)}},{key:"__endOfStream__",value:function(){if(S(this,Vr)&&S(this,Vr).readyState===n.ENDED)for(var e=S(this,Vr).activeSourceBuffers,t=0;t<e.length;t++){var r=e[t];r.__isEndOfStream__()&&S(this,Hr).endOfStream(r.mediaType)}}},{key:"connectedCallback",value:function(){S(this,pr).log(S(this,_r),"connectedCallback")}},{key:"disconnectedCallback",value:function(){S(this,pr).warn(S(this,_r),"disconnectedCallback")}},{key:"adoptedCallback",value:function(){S(this,pr).warn(S(this,_r),"adoptedCallback")}},{key:"attributeChangedCallback",value:function(e,t,r){S(this,pr).log(S(this,_r),"attribute change, name: ".concat(e,", oldValue: ").concat(t,", newValue: ").concat(r));var n=Number.parseInt(r,10);switch(e){case"controls":var i;if(null===t)S(this,Qr).call(this),R(this,Dr,!0);else null===(i=S(this,Yr))||void 0===i||i.destroyControls(),R(this,Yr,null),R(this,Dr,!1);break;case"autoplay":this.autoplay=null===t;break;case"src":S(this,vr)!==r&&R(this,vr,r);break;case"style":break;case"loop":this.loop=null===t;break;case"width":if(null===r||""===r){S(this,Wr).style.width="";break}if(S(this,Or)===n&&S(this,Wr).style.width===r)break;if(Number.isNaN(n)||n<0){R(this,Or,0);break}R(this,Or,n),-1!==r.indexOf("%")?S(this,Wr).style.width="".concat(n,"%"):S(this,Wr).style.width="".concat(n,"px");break;case"height":if(null===r||""===r){S(this,Wr).style.height="";break}if(S(this,Ir)===n&&S(this,Wr).style.height===r)break;if(Number.isNaN(n)||n<0){R(this,Ir,0);break}R(this,Ir,n),-1!==r.indexOf("%")?S(this,Wr).style.height="".concat(n,"%"):S(this,Wr).style.height="".concat(n,"px")}}},{key:"error",get:function(){return S(this,mr)}},{key:"src",get:function(){return S(this,vr)},set:function(e){R(this,vr,e),this.setAttribute("src",e),S(this,$r).call(this)}},{key:"currentSrc",get:function(){return S(this,br)}},{key:"networkState",get:function(){return S(this,yr)},set:function(e){S(this,pr).log(S(this,_r),"Network State Change to ".concat(e)),R(this,yr,e)}},{key:"buffered",get:function(){if(S(this,Vr)){var e=S(this,Vr).activeSourceBuffers,t=e.length;if(0==t)return S(this,gr);for(var r=NaN,n=0;n<t;n++)for(var i=e[n].buffered,a=0;a<i.length;a++)(!r||r<i.end(a))&&(r=i.end(a));var o=new H;o.add(0,r);for(var s=0;s<t;s++){if(0===(o=j(o,e[s].buffered)).length)break}R(this,gr,o)}else S(this,gr)||R(this,gr,new H);return S(this,gr)}},{key:"readyState",get:function(){return S(this,wr)},set:function(e){var t=this;if(e!==S(this,wr)&&this.networkState!==this.NETWORK_EMPTY){S(this,pr).log(S(this,_r),"set readyState, new state is ".concat(e));var r=S(this,wr);if(R(this,wr,e),r===this.HAVE_NOTHING&&e===this.HAVE_METADATA)S(this,pr).log(S(this,_r),"readyState change LOADED_METADATA"),Q(this,ce.LOADED_METADATA),setTimeout((function(){S(t,Hr).loadedMetadata(),0!==S(t,Cr)&&S(t,rn).call(t,S(t,Cr))}),1);else if(r===this.HAVE_METADATA&&e>=this.HAVE_CURRENT_DATA&&(Q(this,ce.LOADED_DATA),e<this.HAVE_FUTURE_DATA))return;r>=this.HAVE_FUTURE_DATA&&e<=this.HAVE_CURRENT_DATA?S(this,nn).call(this)||S(this,Tr)||(Q(this,ce.TIME_UPDATE),Q(this,ce.WAITING),S(this,pr).log(S(this,_r),"fire waiting")):r<=this.HAVE_CURRENT_DATA&&e===this.HAVE_FUTURE_DATA?S(this,ln).call(this):e===this.HAVE_ENOUGH_DATA&&(r<=this.HAVE_CURRENT_DATA&&S(this,ln).call(this),S(this,fn).call(this),this.autoplay&&S(this,Lr)&&S(this,Tr)&&(S(this,pr).log(S(this,_r),"[autoplay] HAVE_ENOUGH_DATA, set paused false"),R(this,Tr,!1),S(this,hn).call(this)))}}},{key:"seeking",get:function(){return S(this,Er)}},{key:"currentTime",get:function(){return S(this,Nr)},set:function(e){0!==S(this,Cr)&&R(this,Cr,0),S(this,wr)===this.HAVE_NOTHING?0!==e&&R(this,Cr,e):S(this,rn).call(this,e)}},{key:"duration",get:function(){return S(this,kr)},set:function(e){R(this,kr,e)}},{key:"paused",get:function(){return S(this,Tr)}},{key:"playbackRate",get:function(){return S(this,Sr)},set:function(e){e!=S(this,Sr)&&(R(this,Sr,e),S(this,Hr)&&(S(this,Hr).playbackRate=e),Q(this,ce.RATE_CHANGE))}},{key:"played",get:function(){return S(this,Rr)}},{key:"seekable",get:function(){if(S(this,Vr)){if(Number.isNaN(S(this,kr)))return new H;if(S(this,kr)===Number.POSITIVE_INFINITY)throw new Error("Method not implemented.");var e=new H;return e.add(0,S(this,kr)),e}return S(this,xr)}},{key:"ended",get:function(){return S(this,nn).call(this)}},{key:"controls",get:function(){return S(this,Dr)},set:function(e){e!==S(this,Dr)&&(e?this.setAttribute("controls",""):this.removeAttribute("controls"))}},{key:"muted",get:function(){return S(this,Fr)},set:function(e){e!=S(this,Fr)&&(R(this,Fr,e),S(this,Hr)&&(S(this,Hr).muted=e,Q(this,ce.VOLUME_CHANGE)))}},{key:"volume",get:function(){var e;return(null===(e=S(this,Hr))||void 0===e?void 0:e.volume)||0},set:function(e){if(e<0||e>1)throw new DOMException("IndexSizeError");if(S(this,Hr)){if(e==S(this,Hr).volume)return;S(this,Hr).volume=e,Q(this,ce.VOLUME_CHANGE)}}},{key:"textTracks",get:function(){return S(this,Mr)}},{key:"width",get:function(){return S(this,Or)},set:function(e){this.setAttribute("width",S(this,vn).call(this,e)?e.toString():"0")}},{key:"height",get:function(){return S(this,Ir)},set:function(e){this.setAttribute("height",S(this,vn).call(this,e)?e.toString():"0")}},{key:"videoWidth",get:function(){return S(this,Gr).width||0}},{key:"videoHeight",get:function(){return S(this,Gr).height||0}}],[{key:"observedAttributes",get:function(){return["controls","autoplay","src","style","loop","width","height"]}}]),i}(lr);ne&&console.log("%c[WasmPlayer] version: ".concat(f,", build date: ").concat("Wed Nov 03 2021 11:58:11 GMT+0800 (GMT+08:00)"),"color: #fb7299;");var yn=document.createElement("meta");yn.setAttribute("id","bwp-meta"),yn.setAttribute("http-equiv","origin-trial"),yn.setAttribute("content","AplmY9HvPiszH9Dng3RsWuQXE+4A2ijSOgl6TsRlpoKPFb6YDi43hgwEs3CiHsAgkJbIWdhO9PhoNI1JRfusmQYAAAB2eyJvcmlnaW4iOiJodHRwczovL2JpbGliaWxpLmNvbTo0NDMiLCJmZWF0dXJlIjoiVW5yZXN0cmljdGVkU2hhcmVkQXJyYXlCdWZmZXIiLCJleHBpcnkiOjE2Mzk1MjYzOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="),document.head.appendChild(yn),window.customElements&&window.customElements.define&&(window.customElements.define("bwp-video",bn),window.BwpElement=bn,window.BwpMediaSource=yt);var gn={BwpElement:bn,BwpMediaSource:yt,BwpErrorCodes:wt,isBwpSupported:Ht}},715:function(e,t){var r={parseBuffer:function(e){return new n(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(i.prototype._boxProcessors[e]=t)},createFile:function(){return new n},createBox:function(e,t,r){var n=i.create(e);return t&&t.append(n,r),n},createFullBox:function(e,t,n){var i=r.createBox(e,t,n);return i.version=0,i.flags=0,i},Utils:{}};
/*! codem-isoboxer v0.3.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */r.Utils.dataViewToString=function(e,t){var r=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(r).decode(e);var n=[],i=0;if("utf-8"===r)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),n.push(String.fromCharCode(a))}else for(;i<e.byteLength;)n.push(String.fromCharCode(e.getUint8(i++)));return n.join("")},r.Utils.utf8ToByteArray=function(e){var t,r;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):n<65536?(t.push(224|n>>12),t.push(128|63&n>>6),t.push(128|63&n)):(t.push(240|n>>18),t.push(128|63&n>>12),t.push(128|63&n>>6),t.push(128|63&n))}return t},r.Utils.appendBox=function(e,t,r){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==r)if(null!=r){var n,i=-1;if("number"==typeof r)i=r;else{if("string"==typeof r)n=r;else{if("object"!=typeof r||!r.type)return void e.boxes.push(t);n=r.type}for(var a=0;a<e.boxes.length;a++)if(n===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.yY=r.parseBuffer,r.addBoxProcessor,r.createFile,r.createBox,r.createFullBox,r.Utils,r.Cursor=function(e){this.offset=void 0===e?0:e};var n=function(e){this._cursor=new r.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};n.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},n.prototype.fetchAll=function(e,t){var r=[];return n._sweep.call(this,e,r,t),r},n.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},n._sweep=function(e,t,r){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&r)return;n._sweep.call(this.boxes[i],e,t,r)}},n.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var r=new Uint8Array(t);for(this._rawo=new DataView(r.buffer),this.bytes=r,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return r.buffer},n.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)};var i=function(){this._cursor=new r.Cursor};i.parse=function(e){var t=new i;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},i.create=function(e){var t=new i;return t.type=e,t.boxes=[],t},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,r){this._parsing?this[e]=this._readField(t,r):this._writeField(t,r,this[e])},i.prototype._procFieldArray=function(e,t,r,n){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(r,n);else for(i=0;i<this[e].length;i++)this._writeField(r,n,this[e][i])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(e,t,r){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push({}),r.call(this,this[e][n]);else for(n=0;n<t;n++)r.call(this,this[e][n])},i.prototype._procSubEntries=function(e,t,r,n){var i;if(this._parsing)for(e[t]=[],i=0;i<r;i++)e[t].push({}),n.call(this,e[t][i]);else for(i=0;i<r;i++)n.call(this,e[t][i])},i.prototype._procEntryField=function(e,t,r,n){this._parsing?e[t]=this._readField(r,n):this._writeField(r,n,e[t])},i.prototype._procSubBoxes=function(e,t){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push(i.parse(this));else for(r=0;r<t;r++)this._rawo?this[e][r].write():this.size+=this[e][r].getLength()},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(e){var t=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(r);break;case 16:t=this._raw.getInt16(r);break;case 32:t=this._raw.getInt32(r);break;case 64:var n=this._raw.getInt32(r),i=this._raw.getInt32(r+4);t=n*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},i.prototype._readUint=function(e){var t,r,n=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:n=this._raw.getUint8(i);break;case 16:n=this._raw.getUint16(i);break;case 24:n=((t=this._raw.getUint16(i))<<8)+(r=this._raw.getUint8(i+2));break;case 32:n=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),r=this._raw.getUint32(i+4),n=t*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,n},i.prototype._readString=function(e){for(var t="",r=0;r<e;r++){var n=this._readUint(8);t+=String.fromCharCode(n)}return t},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var r=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,r}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?r.Utils.dataViewToString(t):t},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(e,t){if(this._rawo){var r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(r,t);break;case 16:this._rawo.setInt16(r,t);break;case 32:this._rawo.setInt32(r,t);break;case 64:var n=Math.floor(t/Math.pow(2,32)),i=t-n*Math.pow(2,32);this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeUint=function(e,t){if(this._rawo){var r,n,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:r=(16776960&t)>>8,n=255&t,this._rawo.setUint16(i,r),this._rawo.setUint8(i+2,n);break;case 32:this._rawo.setUint32(i,t);break;case 64:n=t-(r=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,r),this._rawo.setUint32(i+4,n)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeString=function(e,t){for(var r=0;r<e;r++)this._writeUint(8,t.charCodeAt(r))},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},i.prototype._writeTemplate=function(e,t){var r=Math.floor(t),n=(t-r)*Math.pow(2,e/2);this._writeUint(e/2,r),this._writeUint(e/2,n)},i.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,r=0;r<e.length;r++)this._rawo.setInt8(t+r,e[r]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},i.prototype._writeUTF8String=function(e){var t=r.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)n.setUint8(i,t[i]);else this.size+=t.length},i.prototype._writeField=function(e,t,r){switch(e){case"uint":this._writeUint(t,r);break;case"int":this._writeInt(t,r);break;case"template":this._writeTemplate(t,r);break;case"string":-1==t?this._writeTerminatedString(r):this._writeString(t,r);break;case"data":this._writeData(r);break;case"utf8":this._writeUTF8String(r)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}},601:function(e,t,r){"use strict";var n=r(645),i=r.n(n)()((function(e){return e[1]}));i.push([e.id,".-bwp-internal-container {\n    display: block;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    min-width: inherit;\n    min-height: inherit;\n    max-width: inherit;\n    max-height: inherit;\n    object-fit: inherit;\n}\n\n.-bwp-internal-render-canvas {\n    display: block;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    object-fit: inherit;\n}\n\n.-bwp-internal-proxy-video-element {\n    position: absolute;\n    display: none;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    padding: inherit;\n    margin: inherit;\n    object-fit: inherit;\n}\n",""]),t.Z=i},645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=e(t);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);n&&i[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),t.push(u))}},t}},666:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),o=new x(n||[]);return a._invoke=function(e,t,r){var n=f;return function(i,a){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw a;return D()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=T(o,r);if(s){if(s===_)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=l(e,t,r);if("normal"===u.type){if(n=r.done?p:h,u.arg===_)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,o),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",_={};function m(){}function v(){}function b(){}var y={};y[a]=function(){return this};var g=Object.getPrototypeOf,w=g&&g(g(P([])));w&&w!==r&&n.call(w,a)&&(y=w);var E=b.prototype=m.prototype=Object.create(y);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(i,a,o,s){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(f).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}}function T(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method))return _;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=l(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function P(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:D}}function D(){return{value:t,done:!0}}return v.prototype=E.constructor=b,b.constructor=v,v.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},A(k.prototype),k.prototype[o]=function(){return this},e.AsyncIterator=k,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new k(c(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(E),u(E,s,"Generator"),E[a]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=P,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},477:function(e){"use strict";e.exports=function(e,t,r,n){try{try{var i;try{i=new window.Blob([e])}catch(t){(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),i=i.getBlob()}var a=window.URL||window.webkitURL,o=a.createObjectURL(i),s=new window[t](o,r);return a.revokeObjectURL(o),s}catch(n){return new window[t]("data:application/javascript,".concat(encodeURIComponent(e)),r)}}catch(e){if(!n)throw Error("Inline worker is not supported");return new window[t](n,r)}}},286:function(e){"use strict";e.exports='!function(){class s extends AudioWorkletProcessor{constructor(s){super(s),this.playState=!1,this.offset=0,this.audioBuffer=[],this.port.onmessage=this.onmessage.bind(this)}flush(){this.audioBuffer.length=0,this.offset=0}seek(s){this.flush(),this.postMessage("SEEKED",{seekFlag:s})}postMessage(s,e){this.port.postMessage({message:s,options:e})}onmessage(s){const{data:e}=s;if(!e)return;const t=e?.message,i=e?.buffer;if("APPEND_BUFFER"===t)if(i){if(this.audioBuffer.push(i),!this.playState){const s=this.audioBuffer[0].time,e=this.audioBuffer[this.audioBuffer.length-1].time;this.postMessage("TIME_UPDATE",{currentTime:-1,bufferTime:e-s})}}else this.postMessage("ERROR",{detail:"[BwpProcessor] must valid buffer"});else"PLAY"===t?this.playState=!0:"PAUSE"===t?this.playState=!1:"FLUSH"===t?this.flush():"SEEK"===t&&this.seek(e?.seekFlag)}process(s,e,t){const i=this.audioBuffer[0],f=e[0][0],o=e[0][1];if(!f||f&&!f.length)return this.postMessage("ERROR",{detail:"[BwpProcessor] must have left channel"}),!1;if(!o||o&&!o.length)return this.postMessage("ERROR",{detail:"[BwpProcessor] must have right channel"}),!1;if(!i||!this.playState){for(let s=0;s<f.length;s++)f[s]=0,o[s]=0;return!0}const h=i.channels,r=new Float32Array(i.data);for(let s=0;s<f.length;s++)2===h?(f[s]=r[2*s+this.offset],o[s]=r[2*s+1+this.offset]):(f[s]=r[s+this.offset],o[s]=r[s+this.offset]);if(0===this.offset){const s=this.audioBuffer[this.audioBuffer.length-1].time-i.time;this.postMessage("TIME_UPDATE",{currentTime:i.time,bufferTime:s,timeStamp:+new Date})}return this.offset+=f.length*h,this.offset>=r.length&&(this.offset=0,this.audioBuffer.shift()),!0}}registerProcessor("bwp-processor",s)}();'}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={id:n,exports:{}};return e[n](i,i.exports,r),i.exports}return r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r(999)}().default}));